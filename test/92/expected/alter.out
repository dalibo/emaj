-- alter.sql : test emaj_alter_group() and emaj_alter_groups() functions
--
-- set sequence restart value
alter sequence emaj.emaj_hist_hist_id_seq restart 6000;
alter sequence emaj.emaj_time_stamp_time_id_seq restart 6000;
alter sequence emaj.emaj_mark_mark_id_seq restart 6000;
alter sequence emaj.emaj_rlbk_rlbk_id_seq restart 6000;
-----------------------------
-- stop, reset and drop groups
-----------------------------
select emaj.emaj_stop_group('myGroup1');
 emaj_stop_group 
-----------------
               7
(1 row)

select emaj.emaj_reset_group('myGroup1');
 emaj_reset_group 
------------------
                7
(1 row)

select emaj.emaj_drop_group('myGroup1');
 emaj_drop_group 
-----------------
               7
(1 row)

select emaj.emaj_force_drop_group('myGroup2');
 emaj_force_drop_group 
-----------------------
                     8
(1 row)

select emaj.emaj_stop_group('phil''s group#3",','Simple stop mark');
 emaj_stop_group 
-----------------
               4
(1 row)

select emaj.emaj_drop_group('phil''s group#3",');
 emaj_drop_group 
-----------------
               4
(1 row)

select emaj.emaj_force_stop_group('myGroup4');
 emaj_force_stop_group 
-----------------------
                     5
(1 row)

select emaj.emaj_drop_group('myGroup4');
 emaj_drop_group 
-----------------
               5
(1 row)

select emaj.emaj_force_stop_group('emptyGroup');
 emaj_force_stop_group 
-----------------------
                     0
(1 row)

select emaj.emaj_drop_group('emptyGroup');
 emaj_drop_group 
-----------------
               0
(1 row)

-----------------------------
-- emaj_alter_group() tests on IDLE groups
-----------------------------
select emaj.emaj_create_group('myGroup1');
NOTICE:  table "myschema1_myTbl3_log" does not exist, skipping
CONTEXT:  SQL statement "DROP TABLE IF EXISTS "emajC"."myschema1_myTbl3_log""
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 66 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
NOTICE:  trigger "emaj_log_trg" for table "myschema1.myTbl3" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_log_trg ON myschema1."myTbl3""
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 120 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
NOTICE:  trigger "emaj_trunc_trg" for table "myschema1.myTbl3" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_trunc_trg ON myschema1."myTbl3""
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 127 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
NOTICE:  table "myschema1_mytbl1_log" does not exist, skipping
CONTEXT:  SQL statement "DROP TABLE IF EXISTS emaj.myschema1_mytbl1_log"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 66 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
NOTICE:  trigger "emaj_log_trg" for table "myschema1.mytbl1" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_log_trg ON myschema1.mytbl1"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 120 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
NOTICE:  trigger "emaj_trunc_trg" for table "myschema1.mytbl1" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_trunc_trg ON myschema1.mytbl1"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 127 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
NOTICE:  table "myschema1_mytbl4_log" does not exist, skipping
CONTEXT:  SQL statement "DROP TABLE IF EXISTS emaj.myschema1_mytbl4_log"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 66 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
NOTICE:  trigger "emaj_log_trg" for table "myschema1.mytbl4" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_log_trg ON myschema1.mytbl4"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 120 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
NOTICE:  trigger "emaj_trunc_trg" for table "myschema1.mytbl4" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_trunc_trg ON myschema1.mytbl4"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 127 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
NOTICE:  table "myschema1_mytbl2_log" does not exist, skipping
CONTEXT:  SQL statement "DROP TABLE IF EXISTS emaj.myschema1_mytbl2_log"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 66 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
NOTICE:  trigger "emaj_log_trg" for table "myschema1.mytbl2" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_log_trg ON myschema1.mytbl2"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 120 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
NOTICE:  trigger "emaj_trunc_trg" for table "myschema1.mytbl2" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_trunc_trg ON myschema1.mytbl2"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 127 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
WARNING:  _create_tbl: The table "myschema1.mytbl2" has triggers (mytbl2trg). Verify the compatibility with emaj rollback operations (in particular if triggers update one or several other tables). Triggers may have to be manualy disabled before rollback.
CONTEXT:  SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
NOTICE:  table "myschema1_mytbl2b_log" does not exist, skipping
CONTEXT:  SQL statement "DROP TABLE IF EXISTS emajb.myschema1_mytbl2b_log"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 66 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
NOTICE:  trigger "emaj_log_trg" for table "myschema1.mytbl2b" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_log_trg ON myschema1.mytbl2b"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 120 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
NOTICE:  trigger "emaj_trunc_trg" for table "myschema1.mytbl2b" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_trunc_trg ON myschema1.mytbl2b"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 127 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
 emaj_create_group 
-------------------
                 7
(1 row)

select emaj.emaj_create_group('myGroup2');
NOTICE:  table "myschema2_myTbl3_log" does not exist, skipping
CONTEXT:  SQL statement "DROP TABLE IF EXISTS "emajC"."myschema2_myTbl3_log""
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 66 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
NOTICE:  trigger "emaj_log_trg" for table "myschema2.myTbl3" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_log_trg ON myschema2."myTbl3""
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 120 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
NOTICE:  trigger "emaj_trunc_trg" for table "myschema2.myTbl3" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_trunc_trg ON myschema2."myTbl3""
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 127 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
NOTICE:  table "myschema2_mytbl1_log" does not exist, skipping
CONTEXT:  SQL statement "DROP TABLE IF EXISTS emaj.myschema2_mytbl1_log"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 66 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
NOTICE:  trigger "emaj_log_trg" for table "myschema2.mytbl1" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_log_trg ON myschema2.mytbl1"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 120 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
NOTICE:  trigger "emaj_trunc_trg" for table "myschema2.mytbl1" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_trunc_trg ON myschema2.mytbl1"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 127 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
NOTICE:  table "myschema2_mytbl2_log" does not exist, skipping
CONTEXT:  SQL statement "DROP TABLE IF EXISTS emaj.myschema2_mytbl2_log"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 66 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
NOTICE:  trigger "emaj_log_trg" for table "myschema2.mytbl2" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_log_trg ON myschema2.mytbl2"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 120 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
NOTICE:  trigger "emaj_trunc_trg" for table "myschema2.mytbl2" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_trunc_trg ON myschema2.mytbl2"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 127 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
NOTICE:  table "myschema2_mytbl4_log" does not exist, skipping
CONTEXT:  SQL statement "DROP TABLE IF EXISTS emaj.myschema2_mytbl4_log"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 66 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
NOTICE:  trigger "emaj_log_trg" for table "myschema2.mytbl4" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_log_trg ON myschema2.mytbl4"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 120 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
NOTICE:  trigger "emaj_trunc_trg" for table "myschema2.mytbl4" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_trunc_trg ON myschema2.mytbl4"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 127 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
NOTICE:  table "otherPrefix4mytbl5_log" does not exist, skipping
CONTEXT:  SQL statement "DROP TABLE IF EXISTS emaj."otherPrefix4mytbl5_log""
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 66 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
NOTICE:  trigger "emaj_log_trg" for table "myschema2.mytbl5" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_log_trg ON myschema2.mytbl5"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 120 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
NOTICE:  trigger "emaj_trunc_trg" for table "myschema2.mytbl5" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_trunc_trg ON myschema2.mytbl5"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 127 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
NOTICE:  table "myschema2_mytbl6_log" does not exist, skipping
CONTEXT:  SQL statement "DROP TABLE IF EXISTS emaj.myschema2_mytbl6_log"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 66 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
NOTICE:  trigger "emaj_log_trg" for table "myschema2.mytbl6" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_log_trg ON myschema2.mytbl6"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 120 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
NOTICE:  trigger "emaj_trunc_trg" for table "myschema2.mytbl6" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_trunc_trg ON myschema2.mytbl6"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 127 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
WARNING:  _check_fk_groups: The foreign key "mytbl6_col61_fkey" on the table "myschema2.mytbl6" references the table "myschema2.mytbl7" that is outside the groups (myGroup2).
CONTEXT:  SQL statement "SELECT emaj._check_fk_groups(array[v_groupName])"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 75 at PERFORM
WARNING:  _check_fk_groups: The table "myschema2.mytbl6" is referenced by the foreign key "mytbl8_col81_fkey" on the table "myschema2.mytbl8" that is outside the groups (myGroup2).
CONTEXT:  SQL statement "SELECT emaj._check_fk_groups(array[v_groupName])"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 75 at PERFORM
 emaj_create_group 
-------------------
                 8
(1 row)

select emaj.emaj_create_group('emptyGroup',true,true);
 emaj_create_group 
-------------------
                 0
(1 row)

select emaj.emaj_create_group('myGroup4');
NOTICE:  table "myschema4_mypartp1_log" does not exist, skipping
CONTEXT:  SQL statement "DROP TABLE IF EXISTS emaj.myschema4_mypartp1_log"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 66 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
NOTICE:  trigger "emaj_log_trg" for table "myschema4.mypartp1" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_log_trg ON myschema4.mypartp1"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 120 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
NOTICE:  trigger "emaj_trunc_trg" for table "myschema4.mypartp1" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_trunc_trg ON myschema4.mypartp1"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 127 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
NOTICE:  table "myschema4_mypartp2_log" does not exist, skipping
CONTEXT:  SQL statement "DROP TABLE IF EXISTS emaj.myschema4_mypartp2_log"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 66 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
NOTICE:  trigger "emaj_log_trg" for table "myschema4.mypartp2" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_log_trg ON myschema4.mypartp2"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 120 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
NOTICE:  trigger "emaj_trunc_trg" for table "myschema4.mypartp2" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_trunc_trg ON myschema4.mypartp2"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 127 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
NOTICE:  table "myschema4_mytblc1_log" does not exist, skipping
CONTEXT:  SQL statement "DROP TABLE IF EXISTS emaj.myschema4_mytblc1_log"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 66 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
NOTICE:  trigger "emaj_log_trg" for table "myschema4.mytblc1" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_log_trg ON myschema4.mytblc1"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 120 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
NOTICE:  trigger "emaj_trunc_trg" for table "myschema4.mytblc1" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_trunc_trg ON myschema4.mytblc1"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 127 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
NOTICE:  table "myschema4_mytblc2_log" does not exist, skipping
CONTEXT:  SQL statement "DROP TABLE IF EXISTS emaj.myschema4_mytblc2_log"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 66 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
NOTICE:  trigger "emaj_log_trg" for table "myschema4.mytblc2" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_log_trg ON myschema4.mytblc2"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 120 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
NOTICE:  trigger "emaj_trunc_trg" for table "myschema4.mytblc2" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_trunc_trg ON myschema4.mytblc2"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 127 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
NOTICE:  table "myschema4_mytblm_log" does not exist, skipping
CONTEXT:  SQL statement "DROP TABLE IF EXISTS emaj.myschema4_mytblm_log"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 66 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
NOTICE:  trigger "emaj_log_trg" for table "myschema4.mytblm" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_log_trg ON myschema4.mytblm"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 120 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
NOTICE:  trigger "emaj_trunc_trg" for table "myschema4.mytblm" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_trunc_trg ON myschema4.mytblm"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 127 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
WARNING:  _create_tbl: The table "myschema4.mytblm" has triggers (mytblm_insert_trigger). Verify the compatibility with emaj rollback operations (in particular if triggers update one or several other tables). Triggers may have to be manualy disabled before rollback.
CONTEXT:  SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj.emaj_create_group(text,boolean,boolean) line 55 at PERFORM
 emaj_create_group 
-------------------
                 5
(1 row)

-- unknown group
select emaj.emaj_alter_group(NULL);
ERROR:  _check_group_names: No group to process.
CONTEXT:  SQL statement "SELECT emaj._check_group_names(v_groupNames := v_groupNames, v_mayBeNull := v_multiGroup, v_lockGroups := TRUE, v_checkList := '')"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 16 at SQL statement
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
select emaj.emaj_alter_group('unknownGroup');
ERROR:  _check_group_names: The group "unknownGroup" does not exist.
CONTEXT:  SQL statement "SELECT emaj._check_group_names(v_groupNames := v_groupNames, v_mayBeNull := v_multiGroup, v_lockGroups := TRUE, v_checkList := '')"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 16 at SQL statement
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
-- group in logging state (2 tables need to be repaired)
begin;
  select emaj.emaj_start_group('myGroup1','');
 emaj_start_group 
------------------
                7
(1 row)

  select emaj.emaj_disable_protection_by_event_triggers();
 emaj_disable_protection_by_event_triggers 
-------------------------------------------
                                         0
(1 row)

  drop table emaj.myschema1_mytbl1_log;
  drop table emaj.myschema1_mytbl4_log;
  select emaj.emaj_enable_protection_by_event_triggers();
 emaj_enable_protection_by_event_triggers 
------------------------------------------
                                        0
(1 row)

  select emaj.emaj_alter_group('myGroup1');
ERROR:  alter_exec: Cannot repair the table myschema1.mytbl1. Its group myGroup1 is in LOGGING state.
CONTEXT:  SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
rollback;
-- alter a group with a table now already belonging to another group
begin;
  insert into emaj.emaj_group_def values ('myGroup1','myschema2','mytbl1');
  select emaj.emaj_alter_group('myGroup1');
WARNING:  _check_groups_content: Error, the table or sequence myschema2.mytbl1 belongs to another group (myGroup2).
CONTEXT:  SQL statement "SELECT emaj._check_groups_content(v_groupNames, NULL)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 19 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
WARNING:  _check_groups_content: Error, the emaj prefix "myschema2_mytbl1" is already used.
CONTEXT:  SQL statement "SELECT emaj._check_groups_content(v_groupNames, NULL)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 19 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
ERROR:  _check_groups_content: One or several errors have been detected in the emaj_group_def table content.
CONTEXT:  SQL statement "SELECT emaj._check_groups_content(v_groupNames, NULL)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 19 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
rollback;
-- schema suffix cannot be changed for sequence
begin;
  update emaj.emaj_group_def set grpdef_log_schema_suffix = 'dummy' where grpdef_schema = 'myschema1' and grpdef_tblseq = 'myTbl3_col31_seq';
  select emaj.emaj_alter_group('myGroup1');
WARNING:  _check_groups_content: Error, for the sequence myschema1."myTbl3_col31_seq", the secondary log schema suffix is not NULL.
CONTEXT:  SQL statement "SELECT emaj._check_groups_content(v_groupNames, NULL)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 19 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
ERROR:  _check_groups_content: One or several errors have been detected in the emaj_group_def table content.
CONTEXT:  SQL statement "SELECT emaj._check_groups_content(v_groupNames, NULL)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 19 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
rollback;
-- object names prefix cannot be changed for sequence
begin;
  update emaj.emaj_group_def set grpdef_emaj_names_prefix = 'dummy' where grpdef_schema = 'myschema1' and grpdef_tblseq = 'myTbl3_col31_seq';
  select emaj.emaj_alter_group('myGroup1');
WARNING:  _check_groups_content: Error, for the sequence myschema1."myTbl3_col31_seq", the emaj names prefix is not NULL.
CONTEXT:  SQL statement "SELECT emaj._check_groups_content(v_groupNames, NULL)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 19 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
ERROR:  _check_groups_content: One or several errors have been detected in the emaj_group_def table content.
CONTEXT:  SQL statement "SELECT emaj._check_groups_content(v_groupNames, NULL)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 19 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
rollback;
-- log tablespace cannot be changed for sequence
begin;
  update emaj.emaj_group_def set grpdef_log_dat_tsp = 'b' where grpdef_schema = 'myschema1' and grpdef_tblseq = 'myTbl3_col31_seq';
  select emaj.emaj_alter_group('myGroup1');
WARNING:  _check_groups_content: Error, for the sequence myschema1."myTbl3_col31_seq", the data log tablespace is not NULL.
CONTEXT:  SQL statement "SELECT emaj._check_groups_content(v_groupNames, NULL)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 19 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
ERROR:  _check_groups_content: One or several errors have been detected in the emaj_group_def table content.
CONTEXT:  SQL statement "SELECT emaj._check_groups_content(v_groupNames, NULL)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 19 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
rollback;
begin;
  update emaj.emaj_group_def set grpdef_log_idx_tsp = 'b' where grpdef_schema = 'myschema1' and grpdef_tblseq = 'myTbl3_col31_seq';
  select emaj.emaj_alter_group('myGroup1');
WARNING:  _check_groups_content: Error, for the sequence myschema1."myTbl3_col31_seq", the index log tablespace is not NULL.
CONTEXT:  SQL statement "SELECT emaj._check_groups_content(v_groupNames, NULL)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 19 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
ERROR:  _check_groups_content: One or several errors have been detected in the emaj_group_def table content.
CONTEXT:  SQL statement "SELECT emaj._check_groups_content(v_groupNames, NULL)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 19 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
rollback;
-- dropped application table
begin;
  select emaj.emaj_disable_protection_by_event_triggers();
 emaj_disable_protection_by_event_triggers 
-------------------------------------------
                                         0
(1 row)

  drop table myschema1.mytbl2b;
  select emaj.emaj_enable_protection_by_event_triggers();
 emaj_enable_protection_by_event_triggers 
------------------------------------------
                                        0
(1 row)

  select emaj.emaj_alter_group('myGroup1');
WARNING:  _check_groups_content: Error, the table or sequence myschema1.mytbl2b does not exist.
CONTEXT:  SQL statement "SELECT emaj._check_groups_content(v_groupNames, NULL)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 19 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
WARNING:  _check_groups_content: Error, the table or sequence myschema1.mytbl2b_col20_seq does not exist.
CONTEXT:  SQL statement "SELECT emaj._check_groups_content(v_groupNames, NULL)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 19 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
ERROR:  _check_groups_content: One or several errors have been detected in the emaj_group_def table content.
CONTEXT:  SQL statement "SELECT emaj._check_groups_content(v_groupNames, NULL)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 19 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
rollback;
-- should be OK
-- nothing to change
select emaj.emaj_alter_group('emptyGroup');
 emaj_alter_group 
------------------
                0
(1 row)

select group_name, group_is_logging, group_is_rlbk_protected, group_nb_table, group_nb_sequence, group_is_rollbackable,
       group_creation_time_id, group_last_alter_time_id, group_comment
 from emaj.emaj_group where group_name = 'myGroup1';
 group_name | group_is_logging | group_is_rlbk_protected | group_nb_table | group_nb_sequence | group_is_rollbackable | group_creation_time_id | group_last_alter_time_id | group_comment 
------------+------------------+-------------------------+----------------+-------------------+-----------------------+------------------------+--------------------------+---------------
 myGroup1   | f                | f                       |              5 |                 2 | t                     |                   6002 |                          | 
(1 row)

select emaj.emaj_alter_group('myGroup1');
 emaj_alter_group 
------------------
                7
(1 row)

select group_name, group_is_logging, group_is_rlbk_protected, group_nb_table, group_nb_sequence, group_is_rollbackable,
       group_creation_time_id, group_last_alter_time_id, group_comment
 from emaj.emaj_group where group_name = 'myGroup1';
 group_name | group_is_logging | group_is_rlbk_protected | group_nb_table | group_nb_sequence | group_is_rollbackable | group_creation_time_id | group_last_alter_time_id | group_comment 
------------+------------------+-------------------------+----------------+-------------------+-----------------------+------------------------+--------------------------+---------------
 myGroup1   | f                | f                       |              5 |                 2 | t                     |                   6002 |                     6009 | 
(1 row)

select nspname from pg_namespace where nspname like 'emaj%' order by nspname;
 nspname 
---------
 emaj
 emajC
 emajb
(3 rows)

-- only 3 tables to remove (+ log schemas emajb)
delete from emaj.emaj_group_def where grpdef_schema = 'myschema1' and grpdef_tblseq = 'mytbl2b';
delete from emaj.emaj_group_def where grpdef_schema = 'myschema1' and grpdef_tblseq = 'myTbl3';
delete from emaj.emaj_group_def where grpdef_schema = 'myschema1' and grpdef_tblseq = 'mytbl4';
select emaj.emaj_alter_group('myGroup1');
WARNING:  _check_fk_groups: The table "myschema1.mytbl2" is referenced by the foreign key "mytbl4_col43_fkey" on the table "myschema1.mytbl4" that is outside the groups (myGroup1).
CONTEXT:  SQL statement "SELECT emaj._check_fk_groups(v_groupNames)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 56 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
WARNING:  _check_fk_groups: The table "myschema1.mytbl1" is referenced by the foreign key "mytbl4_col44_fkey" on the table "myschema1.mytbl4" that is outside the groups (myGroup1).
CONTEXT:  SQL statement "SELECT emaj._check_fk_groups(v_groupNames)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 56 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
 emaj_alter_group 
------------------
                4
(1 row)

select group_nb_table, group_nb_sequence from emaj.emaj_group where group_name = 'myGroup1';
 group_nb_table | group_nb_sequence 
----------------+-------------------
              2 |                 2
(1 row)

select nspname from pg_namespace where nspname like 'emaj%' order by nspname;
 nspname 
---------
 emaj
 emajC
(2 rows)

-- only 1 sequence to remove
delete from emaj.emaj_group_def where grpdef_schema = 'myschema1' and grpdef_tblseq = 'myTbl3_col31_seq';
select emaj.emaj_alter_group('myGroup1');
WARNING:  _check_fk_groups: The table "myschema1.mytbl2" is referenced by the foreign key "mytbl4_col43_fkey" on the table "myschema1.mytbl4" that is outside the groups (myGroup1).
CONTEXT:  SQL statement "SELECT emaj._check_fk_groups(v_groupNames)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 56 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
WARNING:  _check_fk_groups: The table "myschema1.mytbl1" is referenced by the foreign key "mytbl4_col44_fkey" on the table "myschema1.mytbl4" that is outside the groups (myGroup1).
CONTEXT:  SQL statement "SELECT emaj._check_fk_groups(v_groupNames)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 56 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
 emaj_alter_group 
------------------
                3
(1 row)

select group_nb_table, group_nb_sequence from emaj.emaj_group where group_name = 'myGroup1';
 group_nb_table | group_nb_sequence 
----------------+-------------------
              2 |                 1
(1 row)

-- 3 tables to add (+ log schemas emajb)
insert into emaj.emaj_group_def values ('myGroup1','myschema1','mytbl2b',NULL,'b',NULL,'tsp log''2','tsp log''2');
insert into emaj.emaj_group_def values ('myGroup1','myschema1','myTbl3',10,'C',NULL,'tsplog1');
insert into emaj.emaj_group_def values ('myGroup1','myschema1','mytbl4',20,NULL,NULL,'tsplog1','tsp log''2');
select emaj.emaj_alter_group('myGroup1');
NOTICE:  table "myschema1_myTbl3_log" does not exist, skipping
CONTEXT:  SQL statement "DROP TABLE IF EXISTS "emajC"."myschema1_myTbl3_log""
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 66 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj._add_tbl(emaj.emaj_alter_plan,bigint) line 24 at PERFORM
SQL statement "SELECT emaj._add_tbl(r_plan, v_timeId)"
PL/pgSQL function emaj._alter_exec(bigint) line 129 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
NOTICE:  trigger "emaj_log_trg" for table "myschema1.myTbl3" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_log_trg ON myschema1."myTbl3""
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 120 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj._add_tbl(emaj.emaj_alter_plan,bigint) line 24 at PERFORM
SQL statement "SELECT emaj._add_tbl(r_plan, v_timeId)"
PL/pgSQL function emaj._alter_exec(bigint) line 129 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
NOTICE:  trigger "emaj_trunc_trg" for table "myschema1.myTbl3" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_trunc_trg ON myschema1."myTbl3""
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 127 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj._add_tbl(emaj.emaj_alter_plan,bigint) line 24 at PERFORM
SQL statement "SELECT emaj._add_tbl(r_plan, v_timeId)"
PL/pgSQL function emaj._alter_exec(bigint) line 129 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
NOTICE:  table "myschema1_mytbl4_log" does not exist, skipping
CONTEXT:  SQL statement "DROP TABLE IF EXISTS emaj.myschema1_mytbl4_log"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 66 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj._add_tbl(emaj.emaj_alter_plan,bigint) line 24 at PERFORM
SQL statement "SELECT emaj._add_tbl(r_plan, v_timeId)"
PL/pgSQL function emaj._alter_exec(bigint) line 129 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
NOTICE:  trigger "emaj_log_trg" for table "myschema1.mytbl4" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_log_trg ON myschema1.mytbl4"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 120 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj._add_tbl(emaj.emaj_alter_plan,bigint) line 24 at PERFORM
SQL statement "SELECT emaj._add_tbl(r_plan, v_timeId)"
PL/pgSQL function emaj._alter_exec(bigint) line 129 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
NOTICE:  trigger "emaj_trunc_trg" for table "myschema1.mytbl4" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_trunc_trg ON myschema1.mytbl4"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 127 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj._add_tbl(emaj.emaj_alter_plan,bigint) line 24 at PERFORM
SQL statement "SELECT emaj._add_tbl(r_plan, v_timeId)"
PL/pgSQL function emaj._alter_exec(bigint) line 129 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
NOTICE:  table "myschema1_mytbl2b_log" does not exist, skipping
CONTEXT:  SQL statement "DROP TABLE IF EXISTS emajb.myschema1_mytbl2b_log"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 66 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj._add_tbl(emaj.emaj_alter_plan,bigint) line 24 at PERFORM
SQL statement "SELECT emaj._add_tbl(r_plan, v_timeId)"
PL/pgSQL function emaj._alter_exec(bigint) line 129 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
NOTICE:  trigger "emaj_log_trg" for table "myschema1.mytbl2b" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_log_trg ON myschema1.mytbl2b"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 120 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj._add_tbl(emaj.emaj_alter_plan,bigint) line 24 at PERFORM
SQL statement "SELECT emaj._add_tbl(r_plan, v_timeId)"
PL/pgSQL function emaj._alter_exec(bigint) line 129 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
NOTICE:  trigger "emaj_trunc_trg" for table "myschema1.mytbl2b" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_trunc_trg ON myschema1.mytbl2b"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 127 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj._add_tbl(emaj.emaj_alter_plan,bigint) line 24 at PERFORM
SQL statement "SELECT emaj._add_tbl(r_plan, v_timeId)"
PL/pgSQL function emaj._alter_exec(bigint) line 129 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
 emaj_alter_group 
------------------
                6
(1 row)

select group_nb_table, group_nb_sequence from emaj.emaj_group where group_name = 'myGroup1';
 group_nb_table | group_nb_sequence 
----------------+-------------------
              5 |                 1
(1 row)

select nspname from pg_namespace where nspname like 'emaj%' order by nspname;
 nspname 
---------
 emaj
 emajC
 emajb
(3 rows)

-- only 1 sequence to add
insert into emaj.emaj_group_def values ('myGroup1','myschema1','myTbl3_col31_seq',1);
select emaj.emaj_alter_group('myGroup1');
 emaj_alter_group 
------------------
                7
(1 row)

select group_nb_table, group_nb_sequence from emaj.emaj_group where group_name = 'myGroup1';
 group_nb_table | group_nb_sequence 
----------------+-------------------
              5 |                 2
(1 row)

-- only change the log schema
update emaj.emaj_group_def set grpdef_log_schema_suffix = NULL where grpdef_schema = 'myschema1' and grpdef_tblseq = 'myTbl3';
select emaj.emaj_alter_group('myGroup1');
 emaj_alter_group 
------------------
                7
(1 row)

select nspname from pg_namespace, pg_class where relnamespace = pg_namespace.oid and relname = 'myschema1_myTbl3_log';
 nspname 
---------
 emaj
(1 row)

update emaj.emaj_group_def set grpdef_log_schema_suffix = 'C' where grpdef_schema = 'myschema1' and grpdef_tblseq = 'myTbl3';
select emaj.emaj_alter_group('myGroup1');
 emaj_alter_group 
------------------
                7
(1 row)

select nspname from pg_namespace, pg_class where relnamespace = pg_namespace.oid and relname = 'myschema1_myTbl3_log';
 nspname 
---------
 emajC
(1 row)

-- only change the emaj_names_prefix for 1 table
update emaj.emaj_group_def set grpdef_emaj_names_prefix = 's1t3' where grpdef_schema = 'myschema1' and grpdef_tblseq = 'myTbl3';
select emaj.emaj_alter_group('myGroup1');
 emaj_alter_group 
------------------
                7
(1 row)

select count(*) from "emajC".s1t3_log;
 count 
-------
     0
(1 row)

update emaj.emaj_group_def set grpdef_emaj_names_prefix = NULL where grpdef_schema = 'myschema1' and grpdef_tblseq = 'myTbl3';
select emaj.emaj_alter_group('myGroup1');
 emaj_alter_group 
------------------
                7
(1 row)

select count(*) from "emajC"."myschema1_myTbl3_log";
 count 
-------
     0
(1 row)

-- only change the log data tablespace for 1 table
update emaj.emaj_group_def set grpdef_log_dat_tsp = NULL where grpdef_schema = 'myschema1' and grpdef_tblseq = 'mytbl2b';
select emaj.emaj_alter_group('myGroup1');
 emaj_alter_group 
------------------
                7
(1 row)

select spcname from pg_tablespace, pg_class where reltablespace = pg_tablespace.oid and relname = 'myschema1_mytbl2b_log';
 spcname 
---------
(0 rows)

update emaj.emaj_group_def set grpdef_log_dat_tsp = 'tsp log''2' where grpdef_schema = 'myschema1' and grpdef_tblseq = 'mytbl2b';
select emaj.emaj_alter_group('myGroup1');
 emaj_alter_group 
------------------
                7
(1 row)

select spcname from pg_tablespace, pg_class where reltablespace = pg_tablespace.oid and relname = 'myschema1_mytbl2b_log';
  spcname  
-----------
 tsp log'2
(1 row)

-- change the log data tablespace for all tables of a group
update emaj.emaj_group_def set grpdef_log_dat_tsp = case when grpdef_log_dat_tsp is NULL then 'tsplog1' when grpdef_log_dat_tsp = 'tsplog1' then 'tsp log''2' else NULL end where grpdef_schema = 'myschema1' and grpdef_tblseq not like '%seq';
select emaj.emaj_alter_group('myGroup1');
 emaj_alter_group 
------------------
                7
(1 row)

update emaj.emaj_group_def set grpdef_log_dat_tsp = case when grpdef_log_dat_tsp = 'tsplog1' then NULL when grpdef_log_dat_tsp = 'tsp log''2' then 'tsplog1' else 'tsp log''2' end where grpdef_schema = 'myschema1' and grpdef_tblseq not like '%seq';
select emaj.emaj_alter_group('myGroup1');
 emaj_alter_group 
------------------
                7
(1 row)

-- only change the log index tablespace, using a session default tablespace
update emaj.emaj_group_def set grpdef_log_idx_tsp = NULL where grpdef_schema = 'myschema1' and grpdef_tblseq = 'mytbl2b';
set default_tablespace = tspemaj_renamed;
select emaj.emaj_alter_group('myGroup1');
 emaj_alter_group 
------------------
                7
(1 row)

reset default_tablespace;
select spcname from pg_tablespace, pg_class where reltablespace = pg_tablespace.oid and relname = 'myschema1_mytbl2b_log_idx';
     spcname     
-----------------
 tspemaj_renamed
(1 row)

update emaj.emaj_group_def set grpdef_log_idx_tsp = 'tsp log''2' where grpdef_schema = 'myschema1' and grpdef_tblseq = 'mytbl2b';
select emaj.emaj_alter_group('myGroup1');
 emaj_alter_group 
------------------
                7
(1 row)

select spcname from pg_tablespace, pg_class where reltablespace = pg_tablespace.oid and relname = 'myschema1_mytbl2b_log_idx';
  spcname  
-----------
 tsp log'2
(1 row)

-- only change the priority
update emaj.emaj_group_def set grpdef_priority = 30 where grpdef_schema = 'myschema1' and grpdef_tblseq = 'mytbl1';
select emaj.emaj_alter_group('myGroup1');
 emaj_alter_group 
------------------
                7
(1 row)

select rel_priority from emaj.emaj_relation where rel_schema = 'myschema1' and rel_tblseq = 'mytbl1' and upper_inf(rel_time_range);
 rel_priority 
--------------
           30
(1 row)

update emaj.emaj_group_def set grpdef_priority = NULL where grpdef_schema = 'myschema1' and grpdef_tblseq = 'mytbl1';
select emaj.emaj_alter_group('myGroup1');
 emaj_alter_group 
------------------
                7
(1 row)

select rel_priority from emaj.emaj_relation where rel_schema = 'myschema1' and rel_tblseq = 'mytbl1' and upper_inf(rel_time_range);
 rel_priority 
--------------
             
(1 row)

update emaj.emaj_group_def set grpdef_priority = 20 where grpdef_schema = 'myschema1' and grpdef_tblseq = 'mytbl1';
select emaj.emaj_alter_group('myGroup1');
 emaj_alter_group 
------------------
                7
(1 row)

select rel_priority from emaj.emaj_relation where rel_schema = 'myschema1' and rel_tblseq = 'mytbl1' and upper_inf(rel_time_range);
 rel_priority 
--------------
           20
(1 row)

-- change the table structure
alter table myschema1.mytbl1 add column newcol int;
select emaj.emaj_alter_group('myGroup1');
NOTICE:  table "myschema1_mytbl1_log" does not exist, skipping
CONTEXT:  SQL statement "DROP TABLE IF EXISTS emaj.myschema1_mytbl1_log"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 66 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj._alter_exec(bigint) line 51 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
NOTICE:  trigger "emaj_log_trg" for table "myschema1.mytbl1" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_log_trg ON myschema1.mytbl1"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 120 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj._alter_exec(bigint) line 51 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
NOTICE:  trigger "emaj_trunc_trg" for table "myschema1.mytbl1" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_trunc_trg ON myschema1.mytbl1"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 127 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj._alter_exec(bigint) line 51 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
 emaj_alter_group 
------------------
                7
(1 row)

alter table myschema1.mytbl1 rename newcol to newcol2;
select emaj.emaj_alter_group('myGroup1');
NOTICE:  table "myschema1_mytbl1_log" does not exist, skipping
CONTEXT:  SQL statement "DROP TABLE IF EXISTS emaj.myschema1_mytbl1_log"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 66 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj._alter_exec(bigint) line 51 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
NOTICE:  trigger "emaj_log_trg" for table "myschema1.mytbl1" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_log_trg ON myschema1.mytbl1"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 120 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj._alter_exec(bigint) line 51 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
NOTICE:  trigger "emaj_trunc_trg" for table "myschema1.mytbl1" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_trunc_trg ON myschema1.mytbl1"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 127 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj._alter_exec(bigint) line 51 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
 emaj_alter_group 
------------------
                7
(1 row)

alter table myschema1.mytbl1 alter column newcol2 type bigint;
select emaj.emaj_alter_group('myGroup1');
NOTICE:  table "myschema1_mytbl1_log" does not exist, skipping
CONTEXT:  SQL statement "DROP TABLE IF EXISTS emaj.myschema1_mytbl1_log"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 66 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj._alter_exec(bigint) line 51 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
NOTICE:  trigger "emaj_log_trg" for table "myschema1.mytbl1" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_log_trg ON myschema1.mytbl1"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 120 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj._alter_exec(bigint) line 51 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
NOTICE:  trigger "emaj_trunc_trg" for table "myschema1.mytbl1" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_trunc_trg ON myschema1.mytbl1"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 127 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj._alter_exec(bigint) line 51 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
 emaj_alter_group 
------------------
                7
(1 row)

alter table myschema1.mytbl1 alter column newcol2 set default 0;
-- NB: changing default has no impact on emaj component 
select emaj.emaj_alter_group('myGroup1');
 emaj_alter_group 
------------------
                7
(1 row)

alter table myschema1.mytbl1 drop column newcol2;
select emaj.emaj_alter_group('myGroup1');
NOTICE:  table "myschema1_mytbl1_log" does not exist, skipping
CONTEXT:  SQL statement "DROP TABLE IF EXISTS emaj.myschema1_mytbl1_log"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 66 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj._alter_exec(bigint) line 51 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
NOTICE:  trigger "emaj_log_trg" for table "myschema1.mytbl1" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_log_trg ON myschema1.mytbl1"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 120 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj._alter_exec(bigint) line 51 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
NOTICE:  trigger "emaj_trunc_trg" for table "myschema1.mytbl1" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_trunc_trg ON myschema1.mytbl1"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 127 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj._alter_exec(bigint) line 51 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
 emaj_alter_group 
------------------
                7
(1 row)

-- rename a table and/or change its schema
alter table myschema1.mytbl1 rename to mytbl1_new_name;
update emaj.emaj_group_def set grpdef_tblseq = 'mytbl1_new_name' 
  where grpdef_schema = 'myschema1' and grpdef_tblseq = 'mytbl1';
select emaj.emaj_alter_group('myGroup1');
NOTICE:  drop cascades to trigger emaj_log_trg on table myschema1.mytbl1_new_name
CONTEXT:  SQL statement "DROP FUNCTION IF EXISTS emaj.myschema1_mytbl1_log_fnct() CASCADE"
PL/pgSQL function emaj._drop_tbl(emaj.emaj_relation) line 22 at EXECUTE statement
SQL statement "SELECT emaj._drop_tbl(emaj.emaj_relation.*) FROM emaj.emaj_relation
        WHERE rel_schema = r_plan.altr_schema AND rel_tblseq = r_plan.altr_tblseq AND upper_inf(rel_time_range)"
PL/pgSQL function emaj._remove_tbl(emaj.emaj_alter_plan,bigint) line 19 at PERFORM
SQL statement "SELECT emaj._remove_tbl(r_plan, v_timeId)"
PL/pgSQL function emaj._alter_exec(bigint) line 25 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
NOTICE:  table "myschema1_mytbl1_new_name_log" does not exist, skipping
CONTEXT:  SQL statement "DROP TABLE IF EXISTS emaj.myschema1_mytbl1_new_name_log"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 66 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj._add_tbl(emaj.emaj_alter_plan,bigint) line 24 at PERFORM
SQL statement "SELECT emaj._add_tbl(r_plan, v_timeId)"
PL/pgSQL function emaj._alter_exec(bigint) line 129 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
NOTICE:  trigger "emaj_log_trg" for table "myschema1.mytbl1_new_name" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_log_trg ON myschema1.mytbl1_new_name"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 120 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj._add_tbl(emaj.emaj_alter_plan,bigint) line 24 at PERFORM
SQL statement "SELECT emaj._add_tbl(r_plan, v_timeId)"
PL/pgSQL function emaj._alter_exec(bigint) line 129 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
 emaj_alter_group 
------------------
                7
(1 row)

alter table myschema1.mytbl1_new_name set schema public;
update emaj.emaj_group_def set grpdef_schema = 'public'
  where grpdef_schema = 'myschema1' and grpdef_tblseq = 'mytbl1_new_name';
select emaj.emaj_alter_group('myGroup1');
NOTICE:  drop cascades to trigger emaj_log_trg on table mytbl1_new_name
CONTEXT:  SQL statement "DROP FUNCTION IF EXISTS emaj.myschema1_mytbl1_new_name_log_fnct() CASCADE"
PL/pgSQL function emaj._drop_tbl(emaj.emaj_relation) line 22 at EXECUTE statement
SQL statement "SELECT emaj._drop_tbl(emaj.emaj_relation.*) FROM emaj.emaj_relation
        WHERE rel_schema = r_plan.altr_schema AND rel_tblseq = r_plan.altr_tblseq AND upper_inf(rel_time_range)"
PL/pgSQL function emaj._remove_tbl(emaj.emaj_alter_plan,bigint) line 19 at PERFORM
SQL statement "SELECT emaj._remove_tbl(r_plan, v_timeId)"
PL/pgSQL function emaj._alter_exec(bigint) line 25 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
NOTICE:  table "public_mytbl1_new_name_log" does not exist, skipping
CONTEXT:  SQL statement "DROP TABLE IF EXISTS emaj.public_mytbl1_new_name_log"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 66 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj._add_tbl(emaj.emaj_alter_plan,bigint) line 24 at PERFORM
SQL statement "SELECT emaj._add_tbl(r_plan, v_timeId)"
PL/pgSQL function emaj._alter_exec(bigint) line 129 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
NOTICE:  trigger "emaj_log_trg" for table "public.mytbl1_new_name" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_log_trg ON public.mytbl1_new_name"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 120 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj._add_tbl(emaj.emaj_alter_plan,bigint) line 24 at PERFORM
SQL statement "SELECT emaj._add_tbl(r_plan, v_timeId)"
PL/pgSQL function emaj._alter_exec(bigint) line 129 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
 emaj_alter_group 
------------------
                7
(1 row)

alter table public.mytbl1_new_name rename to mytbl1;
alter table public.mytbl1 set schema myschema1;
update emaj.emaj_group_def set grpdef_schema = 'myschema1', grpdef_tblseq = 'mytbl1'
  where grpdef_schema = 'public' and grpdef_tblseq = 'mytbl1_new_name';
-- the next call gives a useless mark name parameter (the group is in idle state)
select emaj.emaj_alter_group('myGroup1','useless_mark_name');
NOTICE:  drop cascades to trigger emaj_log_trg on table myschema1.mytbl1
CONTEXT:  SQL statement "DROP FUNCTION IF EXISTS emaj.public_mytbl1_new_name_log_fnct() CASCADE"
PL/pgSQL function emaj._drop_tbl(emaj.emaj_relation) line 22 at EXECUTE statement
SQL statement "SELECT emaj._drop_tbl(emaj.emaj_relation.*) FROM emaj.emaj_relation
        WHERE rel_schema = r_plan.altr_schema AND rel_tblseq = r_plan.altr_tblseq AND upper_inf(rel_time_range)"
PL/pgSQL function emaj._remove_tbl(emaj.emaj_alter_plan,bigint) line 19 at PERFORM
SQL statement "SELECT emaj._remove_tbl(r_plan, v_timeId)"
PL/pgSQL function emaj._alter_exec(bigint) line 25 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
NOTICE:  table "myschema1_mytbl1_log" does not exist, skipping
CONTEXT:  SQL statement "DROP TABLE IF EXISTS emaj.myschema1_mytbl1_log"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 66 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj._add_tbl(emaj.emaj_alter_plan,bigint) line 24 at PERFORM
SQL statement "SELECT emaj._add_tbl(r_plan, v_timeId)"
PL/pgSQL function emaj._alter_exec(bigint) line 129 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
NOTICE:  trigger "emaj_log_trg" for table "myschema1.mytbl1" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_log_trg ON myschema1.mytbl1"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 120 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj._add_tbl(emaj.emaj_alter_plan,bigint) line 24 at PERFORM
SQL statement "SELECT emaj._add_tbl(r_plan, v_timeId)"
PL/pgSQL function emaj._alter_exec(bigint) line 129 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
 emaj_alter_group 
------------------
                7
(1 row)

-- missing emaj components
select emaj.emaj_disable_protection_by_event_triggers();
 emaj_disable_protection_by_event_triggers 
-------------------------------------------
                                         0
(1 row)

drop trigger emaj_log_trg on myschema1.mytbl1;
select emaj.emaj_alter_group('myGroup1');
NOTICE:  trigger "emaj_log_trg" for table "myschema1.mytbl1" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_log_trg ON myschema1.mytbl1"
PL/pgSQL function emaj._drop_tbl(emaj.emaj_relation) line 17 at EXECUTE statement
SQL statement "SELECT emaj._drop_tbl(emaj.emaj_relation.*) FROM emaj.emaj_relation
              WHERE rel_schema = r_plan.altr_schema AND rel_tblseq = r_plan.altr_tblseq AND upper_inf(rel_time_range)"
PL/pgSQL function emaj._alter_exec(bigint) line 48 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
NOTICE:  table "myschema1_mytbl1_log" does not exist, skipping
CONTEXT:  SQL statement "DROP TABLE IF EXISTS emaj.myschema1_mytbl1_log"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 66 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj._alter_exec(bigint) line 51 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
NOTICE:  trigger "emaj_log_trg" for table "myschema1.mytbl1" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_log_trg ON myschema1.mytbl1"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 120 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj._alter_exec(bigint) line 51 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
NOTICE:  trigger "emaj_trunc_trg" for table "myschema1.mytbl1" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_trunc_trg ON myschema1.mytbl1"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 127 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj._alter_exec(bigint) line 51 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
 emaj_alter_group 
------------------
                7
(1 row)

drop function emaj.myschema1_mytbl1_log_fnct() cascade;
NOTICE:  drop cascades to trigger emaj_log_trg on table myschema1.mytbl1
select emaj.emaj_alter_group('myGroup1');
NOTICE:  trigger "emaj_log_trg" for table "myschema1.mytbl1" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_log_trg ON myschema1.mytbl1"
PL/pgSQL function emaj._drop_tbl(emaj.emaj_relation) line 17 at EXECUTE statement
SQL statement "SELECT emaj._drop_tbl(emaj.emaj_relation.*) FROM emaj.emaj_relation
              WHERE rel_schema = r_plan.altr_schema AND rel_tblseq = r_plan.altr_tblseq AND upper_inf(rel_time_range)"
PL/pgSQL function emaj._alter_exec(bigint) line 48 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
NOTICE:  function emaj.myschema1_mytbl1_log_fnct() does not exist, skipping
CONTEXT:  SQL statement "DROP FUNCTION IF EXISTS emaj.myschema1_mytbl1_log_fnct() CASCADE"
PL/pgSQL function emaj._drop_tbl(emaj.emaj_relation) line 22 at EXECUTE statement
SQL statement "SELECT emaj._drop_tbl(emaj.emaj_relation.*) FROM emaj.emaj_relation
              WHERE rel_schema = r_plan.altr_schema AND rel_tblseq = r_plan.altr_tblseq AND upper_inf(rel_time_range)"
PL/pgSQL function emaj._alter_exec(bigint) line 48 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
NOTICE:  table "myschema1_mytbl1_log" does not exist, skipping
CONTEXT:  SQL statement "DROP TABLE IF EXISTS emaj.myschema1_mytbl1_log"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 66 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj._alter_exec(bigint) line 51 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
NOTICE:  trigger "emaj_log_trg" for table "myschema1.mytbl1" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_log_trg ON myschema1.mytbl1"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 120 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj._alter_exec(bigint) line 51 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
NOTICE:  trigger "emaj_trunc_trg" for table "myschema1.mytbl1" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_trunc_trg ON myschema1.mytbl1"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 127 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj._alter_exec(bigint) line 51 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
 emaj_alter_group 
------------------
                7
(1 row)

drop table emaj.myschema1_mytbl1_log;
select emaj.emaj_alter_group('myGroup1');
NOTICE:  table "myschema1_mytbl1_log" does not exist, skipping
CONTEXT:  SQL statement "DROP TABLE IF EXISTS emaj.myschema1_mytbl1_log CASCADE"
PL/pgSQL function emaj._drop_tbl(emaj.emaj_relation) line 28 at EXECUTE statement
SQL statement "SELECT emaj._drop_tbl(emaj.emaj_relation.*) FROM emaj.emaj_relation
              WHERE rel_schema = r_plan.altr_schema AND rel_tblseq = r_plan.altr_tblseq AND upper_inf(rel_time_range)"
PL/pgSQL function emaj._alter_exec(bigint) line 48 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
NOTICE:  table "myschema1_mytbl1_log" does not exist, skipping
CONTEXT:  SQL statement "DROP TABLE IF EXISTS emaj.myschema1_mytbl1_log"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 66 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj._alter_exec(bigint) line 51 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
NOTICE:  trigger "emaj_log_trg" for table "myschema1.mytbl1" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_log_trg ON myschema1.mytbl1"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 120 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj._alter_exec(bigint) line 51 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
NOTICE:  trigger "emaj_trunc_trg" for table "myschema1.mytbl1" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_trunc_trg ON myschema1.mytbl1"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 127 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj._alter_exec(bigint) line 51 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_group(text,text) line 6 at RETURN
 emaj_alter_group 
------------------
                7
(1 row)

select emaj.emaj_enable_protection_by_event_triggers();
 emaj_enable_protection_by_event_triggers 
------------------------------------------
                                        0
(1 row)

-- multiple emaj_alter_group() on a logging group => fails
-- this test is commented because the generated error message differs from one run to another
--begin;
--  select emaj.emaj_start_group('myGroup4');
--  select emaj.emaj_alter_group('myGroup4');
--  select emaj.emaj_alter_group('myGroup4');
--rollback;
-----------------------------
-- emaj_alter_groups() tests on IDLE groups
-----------------------------
-- unknown groups
select emaj.emaj_alter_groups('{"myGroup1","unknownGroup"}');
ERROR:  _check_group_names: The group "unknownGroup" does not exist.
CONTEXT:  SQL statement "SELECT emaj._check_group_names(v_groupNames := v_groupNames, v_mayBeNull := v_multiGroup, v_lockGroups := TRUE, v_checkList := '')"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 16 at SQL statement
PL/pgSQL function emaj.emaj_alter_groups(text[],text) line 6 at RETURN
-- no group at all
select emaj.emaj_alter_groups('{NULL,""}');
WARNING:  _check_group_names: No group to process.
CONTEXT:  SQL statement "SELECT emaj._check_group_names(v_groupNames := v_groupNames, v_mayBeNull := v_multiGroup, v_lockGroups := TRUE, v_checkList := '')"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 16 at SQL statement
PL/pgSQL function emaj.emaj_alter_groups(text[],text) line 6 at RETURN
 emaj_alter_groups 
-------------------
                  
(1 row)

-- groups in logging state
begin;
  select emaj.emaj_start_groups('{"myGroup1","myGroup2"}','');
WARNING:  _check_fk_groups: The foreign key "mytbl6_col61_fkey" on the table "myschema2.mytbl6" references the table "myschema2.mytbl7" that is outside the groups (myGroup1,myGroup2).
CONTEXT:  SQL statement "SELECT emaj._check_fk_groups(v_groupNames)"
PL/pgSQL function emaj._start_groups(text[],text,boolean,boolean) line 25 at PERFORM
PL/pgSQL function emaj.emaj_start_groups(text[],text,boolean) line 11 at RETURN
WARNING:  _check_fk_groups: The table "myschema2.mytbl6" is referenced by the foreign key "mytbl8_col81_fkey" on the table "myschema2.mytbl8" that is outside the groups (myGroup1,myGroup2).
CONTEXT:  SQL statement "SELECT emaj._check_fk_groups(v_groupNames)"
PL/pgSQL function emaj._start_groups(text[],text,boolean,boolean) line 25 at PERFORM
PL/pgSQL function emaj.emaj_start_groups(text[],text,boolean) line 11 at RETURN
 emaj_start_groups 
-------------------
                15
(1 row)

  select emaj.emaj_disable_protection_by_event_triggers();
 emaj_disable_protection_by_event_triggers 
-------------------------------------------
                                         0
(1 row)

  drop table emaj.myschema1_mytbl1_log;
  drop table emaj.myschema2_mytbl1_log;
  select emaj.emaj_enable_protection_by_event_triggers();
 emaj_enable_protection_by_event_triggers 
------------------------------------------
                                        0
(1 row)

  select emaj.emaj_alter_groups('{"myGroup2","myGroup1","myGroup4"}');
ERROR:  alter_exec: Cannot repair the table myschema1.mytbl1. Its group myGroup1 is in LOGGING state.
CONTEXT:  SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_groups(text[],text) line 6 at RETURN
rollback;
-- alter groups with a table now already belonging to another group
begin;
  insert into emaj.emaj_group_def values ('myGroup1','myschema2','mytbl1');
  select emaj.emaj_alter_groups('{"myGroup1","myGroup2"}');
WARNING:  _check_groups_content: Error, the emaj prefix "myschema2_mytbl1" is configured for several tables in the groups.
CONTEXT:  SQL statement "SELECT emaj._check_groups_content(v_groupNames, NULL)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 19 at PERFORM
PL/pgSQL function emaj.emaj_alter_groups(text[],text) line 6 at RETURN
ERROR:  _check_groups_content: One or several errors have been detected in the emaj_group_def table content.
CONTEXT:  SQL statement "SELECT emaj._check_groups_content(v_groupNames, NULL)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 19 at PERFORM
PL/pgSQL function emaj.emaj_alter_groups(text[],text) line 6 at RETURN
rollback;
-- schema suffix cannot be changed for sequence (this covers other cases of forbidden changes for sequences)
begin;
  update emaj.emaj_group_def set grpdef_log_schema_suffix = 'dummy' where grpdef_schema = 'myschema1' and grpdef_tblseq = 'myTbl3_col31_seq';
  select emaj.emaj_alter_groups('{"myGroup1","myGroup2"}');
WARNING:  _check_groups_content: Error, for the sequence myschema1."myTbl3_col31_seq", the secondary log schema suffix is not NULL.
CONTEXT:  SQL statement "SELECT emaj._check_groups_content(v_groupNames, NULL)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 19 at PERFORM
PL/pgSQL function emaj.emaj_alter_groups(text[],text) line 6 at RETURN
ERROR:  _check_groups_content: One or several errors have been detected in the emaj_group_def table content.
CONTEXT:  SQL statement "SELECT emaj._check_groups_content(v_groupNames, NULL)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 19 at PERFORM
PL/pgSQL function emaj.emaj_alter_groups(text[],text) line 6 at RETURN
rollback;
-- a PRIMARY KEY is missing
begin;
  alter table myschema1.mytbl4 drop constraint mytbl4_pkey;
  select emaj.emaj_alter_groups('{"myGroup1","myGroup2"}');
WARNING:  _check_groups_content: Error, the table myschema1.mytbl4 has no PRIMARY KEY.
CONTEXT:  SQL statement "SELECT emaj._check_groups_content(v_groupNames, NULL)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 19 at PERFORM
PL/pgSQL function emaj.emaj_alter_groups(text[],text) line 6 at RETURN
ERROR:  _check_groups_content: One or several errors have been detected in the emaj_group_def table content.
CONTEXT:  SQL statement "SELECT emaj._check_groups_content(v_groupNames, NULL)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 19 at PERFORM
PL/pgSQL function emaj.emaj_alter_groups(text[],text) line 6 at RETURN
rollback;
-- should be OK
-- 3 tables and 1 sequence to remove (+ log schemas emajb)
select group_name, group_nb_table, group_nb_sequence from emaj.emaj_group where group_name = 'myGroup1' or group_name = 'myGroup2' order by 1;
 group_name | group_nb_table | group_nb_sequence 
------------+----------------+-------------------
 myGroup1   |              5 |                 2
 myGroup2   |              6 |                 2
(2 rows)

delete from emaj.emaj_group_def where grpdef_schema = 'myschema1' and grpdef_tblseq = 'mytbl2b';
delete from emaj.emaj_group_def where grpdef_schema = 'myschema1' and grpdef_tblseq = 'myTbl3';
delete from emaj.emaj_group_def where grpdef_schema = 'myschema2' and grpdef_tblseq = 'mytbl4';
delete from emaj.emaj_group_def where grpdef_schema = 'myschema1' and grpdef_tblseq = 'myTbl3_col31_seq';
select emaj.emaj_alter_groups('{"myGroup1","myGroup2"}');
WARNING:  _check_fk_groups: The foreign key "mytbl6_col61_fkey" on the table "myschema2.mytbl6" references the table "myschema2.mytbl7" that is outside the groups (myGroup1,myGroup2).
CONTEXT:  SQL statement "SELECT emaj._check_fk_groups(v_groupNames)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 56 at PERFORM
PL/pgSQL function emaj.emaj_alter_groups(text[],text) line 6 at RETURN
WARNING:  _check_fk_groups: The table "myschema2.mytbl2" is referenced by the foreign key "mytbl4_col43_fkey" on the table "myschema2.mytbl4" that is outside the groups (myGroup1,myGroup2).
CONTEXT:  SQL statement "SELECT emaj._check_fk_groups(v_groupNames)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 56 at PERFORM
PL/pgSQL function emaj.emaj_alter_groups(text[],text) line 6 at RETURN
WARNING:  _check_fk_groups: The table "myschema2.mytbl1" is referenced by the foreign key "mytbl4_col44_fkey" on the table "myschema2.mytbl4" that is outside the groups (myGroup1,myGroup2).
CONTEXT:  SQL statement "SELECT emaj._check_fk_groups(v_groupNames)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 56 at PERFORM
PL/pgSQL function emaj.emaj_alter_groups(text[],text) line 6 at RETURN
WARNING:  _check_fk_groups: The table "myschema2.mytbl6" is referenced by the foreign key "mytbl8_col81_fkey" on the table "myschema2.mytbl8" that is outside the groups (myGroup1,myGroup2).
CONTEXT:  SQL statement "SELECT emaj._check_fk_groups(v_groupNames)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 56 at PERFORM
PL/pgSQL function emaj.emaj_alter_groups(text[],text) line 6 at RETURN
 emaj_alter_groups 
-------------------
                11
(1 row)

select group_name, group_nb_table, group_nb_sequence from emaj.emaj_group where group_name = 'myGroup1' or group_name = 'myGroup2' order by 1;
 group_name | group_nb_table | group_nb_sequence 
------------+----------------+-------------------
 myGroup1   |              3 |                 1
 myGroup2   |              5 |                 2
(2 rows)

select nspname from pg_namespace where nspname like 'emaj%' order by nspname;
 nspname 
---------
 emaj
 emajC
(2 rows)

-- 3 tables and 1 sequence to add (+ log schemas emajb)
insert into emaj.emaj_group_def values ('myGroup1','myschema1','mytbl2b',NULL,'b',NULL,'tsp log''2','tsp log''2');
insert into emaj.emaj_group_def values ('myGroup1','myschema1','myTbl3',10,'C',NULL,'tsplog1');
insert into emaj.emaj_group_def values ('myGroup2','myschema2','mytbl4',NULL,NULL,'myschema2_mytbl4');
insert into emaj.emaj_group_def values ('myGroup1','myschema1','myTbl3_col31_seq',1);
select emaj.emaj_alter_groups('{"myGroup1","myGroup2"}');
NOTICE:  table "myschema1_myTbl3_log" does not exist, skipping
CONTEXT:  SQL statement "DROP TABLE IF EXISTS "emajC"."myschema1_myTbl3_log""
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 66 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj._add_tbl(emaj.emaj_alter_plan,bigint) line 24 at PERFORM
SQL statement "SELECT emaj._add_tbl(r_plan, v_timeId)"
PL/pgSQL function emaj._alter_exec(bigint) line 129 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_groups(text[],text) line 6 at RETURN
NOTICE:  trigger "emaj_log_trg" for table "myschema1.myTbl3" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_log_trg ON myschema1."myTbl3""
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 120 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj._add_tbl(emaj.emaj_alter_plan,bigint) line 24 at PERFORM
SQL statement "SELECT emaj._add_tbl(r_plan, v_timeId)"
PL/pgSQL function emaj._alter_exec(bigint) line 129 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_groups(text[],text) line 6 at RETURN
NOTICE:  trigger "emaj_trunc_trg" for table "myschema1.myTbl3" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_trunc_trg ON myschema1."myTbl3""
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 127 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj._add_tbl(emaj.emaj_alter_plan,bigint) line 24 at PERFORM
SQL statement "SELECT emaj._add_tbl(r_plan, v_timeId)"
PL/pgSQL function emaj._alter_exec(bigint) line 129 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_groups(text[],text) line 6 at RETURN
NOTICE:  table "myschema1_mytbl2b_log" does not exist, skipping
CONTEXT:  SQL statement "DROP TABLE IF EXISTS emajb.myschema1_mytbl2b_log"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 66 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj._add_tbl(emaj.emaj_alter_plan,bigint) line 24 at PERFORM
SQL statement "SELECT emaj._add_tbl(r_plan, v_timeId)"
PL/pgSQL function emaj._alter_exec(bigint) line 129 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_groups(text[],text) line 6 at RETURN
NOTICE:  trigger "emaj_log_trg" for table "myschema1.mytbl2b" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_log_trg ON myschema1.mytbl2b"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 120 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj._add_tbl(emaj.emaj_alter_plan,bigint) line 24 at PERFORM
SQL statement "SELECT emaj._add_tbl(r_plan, v_timeId)"
PL/pgSQL function emaj._alter_exec(bigint) line 129 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_groups(text[],text) line 6 at RETURN
NOTICE:  trigger "emaj_trunc_trg" for table "myschema1.mytbl2b" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_trunc_trg ON myschema1.mytbl2b"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 127 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj._add_tbl(emaj.emaj_alter_plan,bigint) line 24 at PERFORM
SQL statement "SELECT emaj._add_tbl(r_plan, v_timeId)"
PL/pgSQL function emaj._alter_exec(bigint) line 129 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_groups(text[],text) line 6 at RETURN
NOTICE:  table "myschema2_mytbl4_log" does not exist, skipping
CONTEXT:  SQL statement "DROP TABLE IF EXISTS emaj.myschema2_mytbl4_log"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 66 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj._add_tbl(emaj.emaj_alter_plan,bigint) line 24 at PERFORM
SQL statement "SELECT emaj._add_tbl(r_plan, v_timeId)"
PL/pgSQL function emaj._alter_exec(bigint) line 129 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_groups(text[],text) line 6 at RETURN
NOTICE:  trigger "emaj_log_trg" for table "myschema2.mytbl4" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_log_trg ON myschema2.mytbl4"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 120 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj._add_tbl(emaj.emaj_alter_plan,bigint) line 24 at PERFORM
SQL statement "SELECT emaj._add_tbl(r_plan, v_timeId)"
PL/pgSQL function emaj._alter_exec(bigint) line 129 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_groups(text[],text) line 6 at RETURN
NOTICE:  trigger "emaj_trunc_trg" for table "myschema2.mytbl4" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_trunc_trg ON myschema2.mytbl4"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 127 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj._add_tbl(emaj.emaj_alter_plan,bigint) line 24 at PERFORM
SQL statement "SELECT emaj._add_tbl(r_plan, v_timeId)"
PL/pgSQL function emaj._alter_exec(bigint) line 129 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_groups(text[],text) line 6 at RETURN
WARNING:  _check_fk_groups: The foreign key "mytbl6_col61_fkey" on the table "myschema2.mytbl6" references the table "myschema2.mytbl7" that is outside the groups (myGroup1,myGroup2).
CONTEXT:  SQL statement "SELECT emaj._check_fk_groups(v_groupNames)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 56 at PERFORM
PL/pgSQL function emaj.emaj_alter_groups(text[],text) line 6 at RETURN
WARNING:  _check_fk_groups: The table "myschema2.mytbl6" is referenced by the foreign key "mytbl8_col81_fkey" on the table "myschema2.mytbl8" that is outside the groups (myGroup1,myGroup2).
CONTEXT:  SQL statement "SELECT emaj._check_fk_groups(v_groupNames)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 56 at PERFORM
PL/pgSQL function emaj.emaj_alter_groups(text[],text) line 6 at RETURN
 emaj_alter_groups 
-------------------
                15
(1 row)

select group_name, group_nb_table, group_nb_sequence from emaj.emaj_group where group_name = 'myGroup1' or group_name = 'myGroup2' order by 1;
 group_name | group_nb_table | group_nb_sequence 
------------+----------------+-------------------
 myGroup1   |              5 |                 2
 myGroup2   |              6 |                 2
(2 rows)

select nspname from pg_namespace where nspname like 'emaj%' order by nspname;
 nspname 
---------
 emaj
 emajC
 emajb
(3 rows)

-- change a log schema and the emaj_names_prefix for 2 tables
update emaj.emaj_group_def set grpdef_log_schema_suffix = 'tmp' where grpdef_schema = 'myschema2' and grpdef_tblseq = 'myTbl3';
update emaj.emaj_group_def set grpdef_emaj_names_prefix = 's1t3' where grpdef_schema = 'myschema1' and grpdef_tblseq = 'myTbl3';
select emaj.emaj_alter_groups('{"myGroup1","myGroup2"}');
WARNING:  _check_fk_groups: The foreign key "mytbl6_col61_fkey" on the table "myschema2.mytbl6" references the table "myschema2.mytbl7" that is outside the groups (myGroup1,myGroup2).
CONTEXT:  SQL statement "SELECT emaj._check_fk_groups(v_groupNames)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 56 at PERFORM
PL/pgSQL function emaj.emaj_alter_groups(text[],text) line 6 at RETURN
WARNING:  _check_fk_groups: The table "myschema2.mytbl6" is referenced by the foreign key "mytbl8_col81_fkey" on the table "myschema2.mytbl8" that is outside the groups (myGroup1,myGroup2).
CONTEXT:  SQL statement "SELECT emaj._check_fk_groups(v_groupNames)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 56 at PERFORM
PL/pgSQL function emaj.emaj_alter_groups(text[],text) line 6 at RETURN
 emaj_alter_groups 
-------------------
                15
(1 row)

select nspname from pg_namespace, pg_class where relnamespace = pg_namespace.oid and relname = 'myschema2_myTbl3_log';
 nspname 
---------
 emajtmp
(1 row)

select count(*) from "emajC".s1t3_log;
 count 
-------
     0
(1 row)

--
update emaj.emaj_group_def set grpdef_log_schema_suffix = 'C' where grpdef_schema = 'myschema2' and grpdef_tblseq = 'myTbl3';
update emaj.emaj_group_def set grpdef_emaj_names_prefix = NULL where grpdef_schema = 'myschema1' and grpdef_tblseq = 'myTbl3';
select emaj.emaj_alter_groups('{"myGroup1","myGroup2"}');
WARNING:  _check_fk_groups: The foreign key "mytbl6_col61_fkey" on the table "myschema2.mytbl6" references the table "myschema2.mytbl7" that is outside the groups (myGroup1,myGroup2).
CONTEXT:  SQL statement "SELECT emaj._check_fk_groups(v_groupNames)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 56 at PERFORM
PL/pgSQL function emaj.emaj_alter_groups(text[],text) line 6 at RETURN
WARNING:  _check_fk_groups: The table "myschema2.mytbl6" is referenced by the foreign key "mytbl8_col81_fkey" on the table "myschema2.mytbl8" that is outside the groups (myGroup1,myGroup2).
CONTEXT:  SQL statement "SELECT emaj._check_fk_groups(v_groupNames)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 56 at PERFORM
PL/pgSQL function emaj.emaj_alter_groups(text[],text) line 6 at RETURN
 emaj_alter_groups 
-------------------
                15
(1 row)

select nspname from pg_namespace, pg_class where relnamespace = pg_namespace.oid and relname = 'myschema2_myTbl3_log';
 nspname 
---------
 emajC
(1 row)

select count(*) from "emajC"."myschema1_myTbl3_log";
 count 
-------
     0
(1 row)

-- only change the log data tablespace for 1 table, the log index tablespace for another table and the priority for a third one
update emaj.emaj_group_def set grpdef_log_dat_tsp = NULL where grpdef_schema = 'myschema1' and grpdef_tblseq = 'mytbl2b';
update emaj.emaj_group_def set grpdef_log_idx_tsp = 'tsplog1' where grpdef_schema = 'myschema2' and grpdef_tblseq = 'mytbl6';
update emaj.emaj_group_def set grpdef_priority = 30 where grpdef_schema = 'myschema1' and grpdef_tblseq = 'mytbl1';
set default_tablespace = tspemaj_renamed;
select emaj.emaj_alter_groups('{"myGroup1","myGroup2"}');
WARNING:  _check_fk_groups: The foreign key "mytbl6_col61_fkey" on the table "myschema2.mytbl6" references the table "myschema2.mytbl7" that is outside the groups (myGroup1,myGroup2).
CONTEXT:  SQL statement "SELECT emaj._check_fk_groups(v_groupNames)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 56 at PERFORM
PL/pgSQL function emaj.emaj_alter_groups(text[],text) line 6 at RETURN
WARNING:  _check_fk_groups: The table "myschema2.mytbl6" is referenced by the foreign key "mytbl8_col81_fkey" on the table "myschema2.mytbl8" that is outside the groups (myGroup1,myGroup2).
CONTEXT:  SQL statement "SELECT emaj._check_fk_groups(v_groupNames)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 56 at PERFORM
PL/pgSQL function emaj.emaj_alter_groups(text[],text) line 6 at RETURN
 emaj_alter_groups 
-------------------
                15
(1 row)

reset default_tablespace;
select spcname from pg_tablespace, pg_class where reltablespace = pg_tablespace.oid and relname = 'myschema1_mytbl2b_log';
     spcname     
-----------------
 tspemaj_renamed
(1 row)

select spcname from pg_tablespace, pg_class where reltablespace = pg_tablespace.oid and relname = 'myschema2_mytbl6_log_idx';
 spcname 
---------
 tsplog1
(1 row)

select rel_priority from emaj.emaj_relation where rel_schema = 'myschema1' and rel_tblseq = 'mytbl1' and upper_inf(rel_time_range);
 rel_priority 
--------------
           30
(1 row)

--
update emaj.emaj_group_def set grpdef_log_dat_tsp = 'tsp log''2' where grpdef_schema = 'myschema1' and grpdef_tblseq = 'mytbl2b';
update emaj.emaj_group_def set grpdef_log_idx_tsp = NULL where grpdef_schema = 'myschema2' and grpdef_tblseq = 'mytbl6';
update emaj.emaj_group_def set grpdef_priority = 20 where grpdef_schema = 'myschema1' and grpdef_tblseq = 'mytbl1';
select emaj.emaj_alter_groups('{"myGroup1","myGroup2"}');
WARNING:  _check_fk_groups: The foreign key "mytbl6_col61_fkey" on the table "myschema2.mytbl6" references the table "myschema2.mytbl7" that is outside the groups (myGroup1,myGroup2).
CONTEXT:  SQL statement "SELECT emaj._check_fk_groups(v_groupNames)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 56 at PERFORM
PL/pgSQL function emaj.emaj_alter_groups(text[],text) line 6 at RETURN
WARNING:  _check_fk_groups: The table "myschema2.mytbl6" is referenced by the foreign key "mytbl8_col81_fkey" on the table "myschema2.mytbl8" that is outside the groups (myGroup1,myGroup2).
CONTEXT:  SQL statement "SELECT emaj._check_fk_groups(v_groupNames)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 56 at PERFORM
PL/pgSQL function emaj.emaj_alter_groups(text[],text) line 6 at RETURN
 emaj_alter_groups 
-------------------
                15
(1 row)

select spcname from pg_tablespace, pg_class where reltablespace = pg_tablespace.oid and relname = 'myschema1_mytbl2b_log';
  spcname  
-----------
 tsp log'2
(1 row)

select spcname from pg_tablespace, pg_class where reltablespace = pg_tablespace.oid and relname = 'myschema2_mytbl6_log_idx';
 spcname 
---------
(0 rows)

select rel_priority from emaj.emaj_relation where rel_schema = 'myschema1' and rel_tblseq = 'mytbl1' and upper_inf(rel_time_range);
 rel_priority 
--------------
           20
(1 row)

-- move 1 table and 1 sequence from a group to another
update emaj.emaj_group_def set grpdef_group = 'myGroup1' where grpdef_schema = 'myschema2' and grpdef_tblseq = 'myTbl3';
update emaj.emaj_group_def set grpdef_group = 'myGroup1' where grpdef_schema = 'myschema2' and grpdef_tblseq = 'myTbl3_col31_seq';
select rel_group, count(*) from emaj.emaj_relation where rel_group like 'myGroup%' and upper_inf(rel_time_range) group by 1 order by 1;
 rel_group | count 
-----------+-------
 myGroup1  |     7
 myGroup2  |     8
 myGroup4  |     5
(3 rows)

select emaj.emaj_alter_groups('{"myGroup1","myGroup2"}');
WARNING:  _check_fk_groups: The foreign key "mytbl6_col61_fkey" on the table "myschema2.mytbl6" references the table "myschema2.mytbl7" that is outside the groups (myGroup1,myGroup2).
CONTEXT:  SQL statement "SELECT emaj._check_fk_groups(v_groupNames)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 56 at PERFORM
PL/pgSQL function emaj.emaj_alter_groups(text[],text) line 6 at RETURN
WARNING:  _check_fk_groups: The table "myschema2.mytbl6" is referenced by the foreign key "mytbl8_col81_fkey" on the table "myschema2.mytbl8" that is outside the groups (myGroup1,myGroup2).
CONTEXT:  SQL statement "SELECT emaj._check_fk_groups(v_groupNames)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 56 at PERFORM
PL/pgSQL function emaj.emaj_alter_groups(text[],text) line 6 at RETURN
 emaj_alter_groups 
-------------------
                15
(1 row)

select rel_group, count(*) from emaj.emaj_relation where rel_group like 'myGroup%' and upper_inf(rel_time_range) group by 1 order by 1;
 rel_group | count 
-----------+-------
 myGroup1  |     9
 myGroup2  |     6
 myGroup4  |     5
(3 rows)

update emaj.emaj_group_def set grpdef_group = 'myGroup2' where grpdef_schema = 'myschema2' and grpdef_tblseq = 'myTbl3';
update emaj.emaj_group_def set grpdef_group = 'myGroup2' where grpdef_schema = 'myschema2' and grpdef_tblseq = 'myTbl3_col31_seq';
-- the next call gives a useless mark name parameter (the group is in idle state)
select emaj.emaj_alter_groups('{"myGroup1","myGroup2"}','useless_mark_name_%');
WARNING:  _check_fk_groups: The foreign key "mytbl6_col61_fkey" on the table "myschema2.mytbl6" references the table "myschema2.mytbl7" that is outside the groups (myGroup1,myGroup2).
CONTEXT:  SQL statement "SELECT emaj._check_fk_groups(v_groupNames)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 56 at PERFORM
PL/pgSQL function emaj.emaj_alter_groups(text[],text) line 6 at RETURN
WARNING:  _check_fk_groups: The table "myschema2.mytbl6" is referenced by the foreign key "mytbl8_col81_fkey" on the table "myschema2.mytbl8" that is outside the groups (myGroup1,myGroup2).
CONTEXT:  SQL statement "SELECT emaj._check_fk_groups(v_groupNames)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 56 at PERFORM
PL/pgSQL function emaj.emaj_alter_groups(text[],text) line 6 at RETURN
 emaj_alter_groups 
-------------------
                15
(1 row)

select rel_group, count(*) from emaj.emaj_relation where rel_group like 'myGroup%' and upper_inf(rel_time_range) group by 1 order by 1;
 rel_group | count 
-----------+-------
 myGroup1  |     7
 myGroup2  |     8
 myGroup4  |     5
(3 rows)

-- empty idle groups
begin;
  delete from emaj.emaj_group_def where grpdef_group IN ('myGroup1','myGroup2');
  select emaj.emaj_alter_groups('{"myGroup1","myGroup2"}');
 emaj_alter_groups 
-------------------
                 0
(1 row)

-- add one table or sequence to the empty groups
  insert into emaj.emaj_group_def values ('myGroup1','myschema1','mytbl1',20);
  insert into emaj.emaj_group_def values ('myGroup2','myschema2','myseq1');
  select emaj.emaj_alter_groups('{"myGroup1","myGroup2"}');
NOTICE:  table "myschema1_mytbl1_log" does not exist, skipping
CONTEXT:  SQL statement "DROP TABLE IF EXISTS emaj.myschema1_mytbl1_log"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 66 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj._add_tbl(emaj.emaj_alter_plan,bigint) line 24 at PERFORM
SQL statement "SELECT emaj._add_tbl(r_plan, v_timeId)"
PL/pgSQL function emaj._alter_exec(bigint) line 129 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_groups(text[],text) line 6 at RETURN
NOTICE:  trigger "emaj_log_trg" for table "myschema1.mytbl1" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_log_trg ON myschema1.mytbl1"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 120 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj._add_tbl(emaj.emaj_alter_plan,bigint) line 24 at PERFORM
SQL statement "SELECT emaj._add_tbl(r_plan, v_timeId)"
PL/pgSQL function emaj._alter_exec(bigint) line 129 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_groups(text[],text) line 6 at RETURN
NOTICE:  trigger "emaj_trunc_trg" for table "myschema1.mytbl1" does not exist, skipping
CONTEXT:  SQL statement "DROP TRIGGER IF EXISTS emaj_trunc_trg ON myschema1.mytbl1"
PL/pgSQL function emaj._create_tbl(emaj.emaj_group_def,bigint,boolean) line 127 at EXECUTE statement
SQL statement "SELECT emaj._create_tbl(r_grpdef, v_timeId, v_isRollbackable)"
PL/pgSQL function emaj._add_tbl(emaj.emaj_alter_plan,bigint) line 24 at PERFORM
SQL statement "SELECT emaj._add_tbl(r_plan, v_timeId)"
PL/pgSQL function emaj._alter_exec(bigint) line 129 at PERFORM
SQL statement "SELECT emaj._alter_exec(v_timeId)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 44 at PERFORM
PL/pgSQL function emaj.emaj_alter_groups(text[],text) line 6 at RETURN
WARNING:  _check_fk_groups: The table "myschema1.mytbl1" is referenced by the foreign key "mytbl4_col44_fkey" on the table "myschema1.mytbl4" that is outside the groups (myGroup1,myGroup2).
CONTEXT:  SQL statement "SELECT emaj._check_fk_groups(v_groupNames)"
PL/pgSQL function emaj._alter_groups(text[],boolean,text) line 56 at PERFORM
PL/pgSQL function emaj.emaj_alter_groups(text[],text) line 6 at RETURN
 emaj_alter_groups 
-------------------
                 2
(1 row)

rollback;
-- checks are performed by the alterLogging.sql script
