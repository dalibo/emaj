-- alter.sql : tests groups structure changes with groups in IDLE state
-- test emaj_remove_table(), emaj_remove_tables(), emaj_remove_sequence(), emaj_remove_sequences(),
--      emaj_move_table(), emaj_move_tables(), emaj_move_sequence(), emaj_move_sequences(),
--      emaj_modify_table() and emaj_modify_tables() functions
--
-- define the temp file directory to be used by the script
\setenv EMAJTESTTMPDIR '/tmp/emaj_'`echo $PGVER`'/alter'
\set EMAJTESTTMPDIR `echo $EMAJTESTTMPDIR`
\! mkdir -p $EMAJTESTTMPDIR
-- set sequence restart value
select public.handle_emaj_sequences(8000);
 handle_emaj_sequences 
-----------------------
 
(1 row)

-----------------------------
-- stop, reset and drop and recreate groups
-----------------------------
select emaj.emaj_stop_group('myGroup1');
 emaj_stop_group 
-----------------
               7
(1 row)

select emaj.emaj_reset_group('myGroup1');
 emaj_reset_group 
------------------
                7
(1 row)

select emaj.emaj_drop_group('myGroup1');
 emaj_drop_group 
-----------------
               7
(1 row)

select emaj.emaj_force_drop_group('myGroup2');
 emaj_force_drop_group 
-----------------------
                    10
(1 row)

select emaj.emaj_stop_group('phil''s group#3",','Simple stop mark');
 emaj_stop_group 
-----------------
               4
(1 row)

select emaj.emaj_drop_group('phil''s group#3",');
 emaj_drop_group 
-----------------
               4
(1 row)

select emaj.emaj_force_stop_group('myGroup4');
 emaj_force_stop_group 
-----------------------
                     5
(1 row)

select emaj.emaj_drop_group('myGroup4');
 emaj_drop_group 
-----------------
               5
(1 row)

select emaj.emaj_force_stop_group('emptyGroup');
 emaj_force_stop_group 
-----------------------
                     0
(1 row)

select emaj.emaj_drop_group('emptyGroup');
 emaj_drop_group 
-----------------
               0
(1 row)

select emaj.emaj_create_group('myGroup1');
 emaj_create_group 
-------------------
                 1
(1 row)

-- rebuild all original groups
SET client_min_messages TO WARNING;
select emaj.emaj_import_groups_configuration(:'EMAJTESTTMPDIR' || '/../all_groups_config.json', array['myGroup1','myGroup2','emptyGroup','myGroup4'], true);
WARNING:  _create_tbl: The table "myschema1.mytbl2" has triggers (mytbl2trg1, mytbl2trg2). They will be automatically disabled during E-Maj rollback operations, unless they have been recorded into the list of triggers that may be kept enabled, with the emaj_ignore_app_trigger() function.
WARNING:  _create_tbl: The table "myschema4.mytblm" has triggers (mytblm_insert_trigger). They will be automatically disabled during E-Maj rollback operations, unless they have been recorded into the list of triggers that may be kept enabled, with the emaj_ignore_app_trigger() function.
 emaj_import_groups_configuration 
----------------------------------
                                4
(1 row)

RESET client_min_messages;
-----------------------------------
-- emaj_remove_table
-----------------------------------
-- error cases
-- table not in a group
select emaj.emaj_remove_table('dummySchema','mytbl1');
ERROR:  _remove_tables: some tables ("dummySchema".mytbl1) do not currently belong to any tables group.
CONTEXT:  PL/pgSQL function emaj._remove_tables(text,text[],text,boolean,boolean) line 49 at RAISE
PL/pgSQL function emaj.emaj_remove_table(text,text,text) line 6 at RETURN
select emaj.emaj_remove_table('myschema1','dummyTable');
ERROR:  _remove_tables: some tables (myschema1."dummyTable") do not currently belong to any tables group.
CONTEXT:  PL/pgSQL function emaj._remove_tables(text,text[],text,boolean,boolean) line 49 at RAISE
PL/pgSQL function emaj.emaj_remove_table(text,text,text) line 6 at RETURN
-- bad mark
select emaj.emaj_remove_table('myschema1','mytbl1','EMAJ_LAST_MARK');
ERROR:  _check_new_mark: "EMAJ_LAST_MARK" is not an allowed name for a new mark.
CONTEXT:  PL/pgSQL function emaj._check_new_mark(text[],text) line 14 at RAISE
SQL statement "SELECT emaj._check_new_mark(v_loggingGroups, v_mark)"
PL/pgSQL function emaj._remove_tables(text,text[],text,boolean,boolean) line 70 at SQL statement
PL/pgSQL function emaj.emaj_remove_table(text,text,text) line 6 at RETURN
-- ok
select emaj.emaj_remove_table('myschema1','mytbl1');
 emaj_remove_table 
-------------------
                 1
(1 row)

-----------------------------------
-- emaj_remove_tables with array
-----------------------------------
-- error cases
-- empty tables array
select emaj.emaj_remove_tables('myschema1',array[]::text[]);
WARNING:  _remove_tables: No table to process.
 emaj_remove_tables 
--------------------
                  0
(1 row)

select emaj.emaj_remove_tables('myschema1',null);
WARNING:  _remove_tables: No table to process.
 emaj_remove_tables 
--------------------
                  0
(1 row)

select emaj.emaj_remove_tables('myschema1',array['']);
WARNING:  _remove_tables: No table to process.
 emaj_remove_tables 
--------------------
                  0
(1 row)

-- table not in a group
select emaj.emaj_remove_tables('myschema1',array['dummyTable','mytbl1','mytbl2']);
ERROR:  _remove_tables: some tables (myschema1.mytbl1, myschema1."dummyTable") do not currently belong to any tables group.
CONTEXT:  PL/pgSQL function emaj._remove_tables(text,text[],text,boolean,boolean) line 49 at RAISE
PL/pgSQL function emaj.emaj_remove_tables(text,text[],text) line 6 at RETURN
-- ok (with a duplicate table name)
select emaj.emaj_remove_tables('myschema1',array['mytbl2','mytbl2b','mytbl2']);
 emaj_remove_tables 
--------------------
                  2
(1 row)

-----------------------------------
-- emaj_remove_tables with filters
-----------------------------------
-- empty tables array
select emaj.emaj_remove_tables('myschema1',null,null);
WARNING:  _remove_tables: No table to process.
 emaj_remove_tables 
--------------------
                  0
(1 row)

select emaj.emaj_remove_tables('myschema1','','');
WARNING:  _remove_tables: No table to process.
 emaj_remove_tables 
--------------------
                  0
(1 row)

select emaj.emaj_remove_tables('myschema1','mytbl1','mytbl1');
WARNING:  _remove_tables: No table to process.
 emaj_remove_tables 
--------------------
                  0
(1 row)

-- ok
select emaj.emaj_remove_tables('myschema1','my(t|T)bl\d$','mytbl2');
 emaj_remove_tables 
--------------------
                  2
(1 row)

select group_last_alter_time_id, group_nb_table, group_nb_sequence from emaj.emaj_group where group_name = 'myGroup1';
 group_last_alter_time_id | group_nb_table | group_nb_sequence 
--------------------------+----------------+-------------------
                     8011 |              0 |                 2
(1 row)

-----------------------------------
-- emaj_remove_sequence
-----------------------------------
-- error cases
-- sequence not in a group
select emaj.emaj_remove_sequence('dummySchema','myseq1');
ERROR:  _remove_sequences: some sequences ("dummySchema".myseq1) do not currently belong to any tables group.
CONTEXT:  PL/pgSQL function emaj._remove_sequences(text,text[],text,boolean,boolean) line 50 at RAISE
PL/pgSQL function emaj.emaj_remove_sequence(text,text,text) line 6 at RETURN
select emaj.emaj_remove_sequence('myschema2','dummySequence');
ERROR:  _remove_sequences: some sequences (myschema2."dummySequence") do not currently belong to any tables group.
CONTEXT:  PL/pgSQL function emaj._remove_sequences(text,text[],text,boolean,boolean) line 50 at RAISE
PL/pgSQL function emaj.emaj_remove_sequence(text,text,text) line 6 at RETURN
-- bad mark
select emaj.emaj_remove_sequence('myschema2','myseq1','EMAJ_LAST_MARK');
ERROR:  _check_new_mark: "EMAJ_LAST_MARK" is not an allowed name for a new mark.
CONTEXT:  PL/pgSQL function emaj._check_new_mark(text[],text) line 14 at RAISE
SQL statement "SELECT emaj._check_new_mark(v_loggingGroups, v_mark)"
PL/pgSQL function emaj._remove_sequences(text,text[],text,boolean,boolean) line 73 at SQL statement
PL/pgSQL function emaj.emaj_remove_sequence(text,text,text) line 6 at RETURN
-- ok
select emaj.emaj_remove_sequence('myschema2','myseq1');
 emaj_remove_sequence 
----------------------
                    1
(1 row)

-----------------------------------
-- emaj_remove_sequences with array
-----------------------------------
-- error cases
-- empty sequences array
select emaj.emaj_remove_sequences('myschema2',array[]::text[]);
WARNING:  _remove_sequences: No sequence to process.
 emaj_remove_sequences 
-----------------------
                     0
(1 row)

select emaj.emaj_remove_sequences('myschema2',null);
WARNING:  _remove_sequences: No sequence to process.
 emaj_remove_sequences 
-----------------------
                     0
(1 row)

select emaj.emaj_remove_sequences('myschema2',array['']);
WARNING:  _remove_sequences: No sequence to process.
 emaj_remove_sequences 
-----------------------
                     0
(1 row)

-- sequence not in a group
select emaj.emaj_remove_sequences('myschema2',array['dummyTable','myseq2']);
ERROR:  _remove_sequences: some sequences (myschema2.myseq2, myschema2."dummyTable") do not currently belong to any tables group.
CONTEXT:  PL/pgSQL function emaj._remove_sequences(text,text[],text,boolean,boolean) line 50 at RAISE
PL/pgSQL function emaj.emaj_remove_sequences(text,text[],text) line 6 at RETURN
-- ok (with a duplicate sequence name)
select emaj.emaj_assign_sequence('myschema2','myseq2','myGroup2');
 emaj_assign_sequence 
----------------------
                    1
(1 row)

select emaj.emaj_remove_sequences('myschema2',array['myseq2','myseq2']);
 emaj_remove_sequences 
-----------------------
                     1
(1 row)

-----------------------------------
-- emaj_remove_sequences with filters
-----------------------------------
-- empty tables array
select emaj.emaj_remove_sequences('myschema2',null,null);
WARNING:  _remove_sequences: No sequence to process.
 emaj_remove_sequences 
-----------------------
                     0
(1 row)

select emaj.emaj_remove_sequences('myschema2','','');
WARNING:  _remove_sequences: No sequence to process.
 emaj_remove_sequences 
-----------------------
                     0
(1 row)

select emaj.emaj_remove_sequences('myschema2','myseq1','myseq1');
WARNING:  _remove_sequences: No sequence to process.
 emaj_remove_sequences 
-----------------------
                     0
(1 row)

-- ok
select emaj.emaj_remove_sequences('myschema2','.*','');
 emaj_remove_sequences 
-----------------------
                     1
(1 row)

select group_last_alter_time_id, group_nb_table, group_nb_sequence from emaj.emaj_group where group_name = 'myGroup2';
 group_last_alter_time_id | group_nb_table | group_nb_sequence 
--------------------------+----------------+-------------------
                     8015 |              8 |                 0
(1 row)

-- rebuild all original groups
SET client_min_messages TO WARNING;
select emaj.emaj_import_groups_configuration(:'EMAJTESTTMPDIR' || '/../all_groups_config.json', array['myGroup1','myGroup2','emptyGroup','myGroup4'], true);
WARNING:  _create_tbl: The table "myschema1.mytbl2" has triggers (mytbl2trg1, mytbl2trg2). They will be automatically disabled during E-Maj rollback operations, unless they have been recorded into the list of triggers that may be kept enabled, with the emaj_ignore_app_trigger() function.
 emaj_import_groups_configuration 
----------------------------------
                                4
(1 row)

RESET client_min_messages;
-- check for emaj_remove_table() and emaj_remove_sequence() functions family
select * from emaj.emaj_alter_plan where altr_time_id > 8000 order by 1,2,3,4,5;
 altr_time_id |  altr_step  | altr_schema |    altr_tblseq    | altr_group | altr_priority | altr_group_is_logging | altr_new_group | altr_new_group_is_logging | altr_rlbk_id 
--------------+-------------+-------------+-------------------+------------+---------------+-----------------------+----------------+---------------------------+--------------
         8008 | RESET_GROUP |             |                   | emptyGroup |               | f                     |                |                           |             
         8008 | RESET_GROUP |             |                   | myGroup1   |               | f                     |                |                           |             
         8008 | RESET_GROUP |             |                   | myGroup2   |               | f                     |                |                           |             
         8008 | RESET_GROUP |             |                   | myGroup4   |               | f                     |                |                           |             
         8008 | ADD_TBL     | myschema1   | myTbl3            | myGroup1   |            10 | f                     |                |                           |             
         8008 | ADD_TBL     | myschema1   | mytbl1            | myGroup1   |            20 | f                     |                |                           |             
         8008 | ADD_TBL     | myschema1   | mytbl2            | myGroup1   |               | f                     |                |                           |             
         8008 | ADD_TBL     | myschema1   | mytbl2b           | myGroup1   |               | f                     |                |                           |             
         8008 | ADD_TBL     | myschema1   | mytbl4            | myGroup1   |            20 | f                     |                |                           |             
         8008 | ADD_TBL     | myschema2   | myTbl3            | myGroup2   |               | f                     |                |                           |             
         8008 | ADD_TBL     | myschema2   | mytbl1            | myGroup2   |               | f                     |                |                           |             
         8008 | ADD_TBL     | myschema2   | mytbl2            | myGroup2   |               | f                     |                |                           |             
         8008 | ADD_TBL     | myschema2   | mytbl4            | myGroup2   |               | f                     |                |                           |             
         8008 | ADD_TBL     | myschema2   | mytbl5            | myGroup2   |               | f                     |                |                           |             
         8008 | ADD_TBL     | myschema2   | mytbl6            | myGroup2   |               | f                     |                |                           |             
         8008 | ADD_TBL     | myschema2   | mytbl7            | myGroup2   |               | f                     |                |                           |             
         8008 | ADD_TBL     | myschema2   | mytbl8            | myGroup2   |               | f                     |                |                           |             
         8008 | ADD_TBL     | myschema4   | mypartp1          | myGroup4   |               | f                     |                |                           |             
         8008 | ADD_TBL     | myschema4   | mypartp2          | myGroup4   |               | f                     |                |                           |             
         8008 | ADD_TBL     | myschema4   | mytblc1           | myGroup4   |               | f                     |                |                           |             
         8008 | ADD_TBL     | myschema4   | mytblc2           | myGroup4   |               | f                     |                |                           |             
         8008 | ADD_TBL     | myschema4   | mytblm            | myGroup4   |               | f                     |                |                           |             
         8008 | ADD_SEQ     | myschema1   | myTbl3_col31_seq  | myGroup1   |               | f                     |                |                           |             
         8008 | ADD_SEQ     | myschema1   | mytbl2b_col20_seq | myGroup1   |               | f                     |                |                           |             
         8008 | ADD_SEQ     | myschema2   | myTbl3_col31_seq  | myGroup2   |               | f                     |                |                           |             
         8008 | ADD_SEQ     | myschema2   | myseq1            | myGroup2   |               | f                     |                |                           |             
         8009 | REMOVE_TBL  | myschema1   | mytbl1            | myGroup1   |               | f                     |                |                           |             
         8010 | REMOVE_TBL  | myschema1   | mytbl2            | myGroup1   |               | f                     |                |                           |             
         8010 | REMOVE_TBL  | myschema1   | mytbl2b           | myGroup1   |               | f                     |                |                           |             
         8011 | REMOVE_TBL  | myschema1   | myTbl3            | myGroup1   |               | f                     |                |                           |             
         8011 | REMOVE_TBL  | myschema1   | mytbl4            | myGroup1   |               | f                     |                |                           |             
         8012 | REMOVE_SEQ  | myschema2   | myseq1            | myGroup2   |               | f                     |                |                           |             
         8013 | ADD_SEQ     | myschema2   | myseq2            | myGroup2   |               | f                     |                |                           |             
         8014 | REMOVE_SEQ  | myschema2   | myseq2            | myGroup2   |               | f                     |                |                           |             
         8015 | REMOVE_SEQ  | myschema2   | myTbl3_col31_seq  | myGroup2   |               | f                     |                |                           |             
         8016 | RESET_GROUP |             |                   | emptyGroup |               | f                     |                |                           |             
         8016 | RESET_GROUP |             |                   | myGroup1   |               | f                     |                |                           |             
         8016 | RESET_GROUP |             |                   | myGroup2   |               | f                     |                |                           |             
         8016 | RESET_GROUP |             |                   | myGroup4   |               | f                     |                |                           |             
         8016 | ADD_TBL     | myschema1   | myTbl3            | myGroup1   |            10 | f                     |                |                           |             
         8016 | ADD_TBL     | myschema1   | mytbl1            | myGroup1   |            20 | f                     |                |                           |             
         8016 | ADD_TBL     | myschema1   | mytbl2            | myGroup1   |               | f                     |                |                           |             
         8016 | ADD_TBL     | myschema1   | mytbl2b           | myGroup1   |               | f                     |                |                           |             
         8016 | ADD_TBL     | myschema1   | mytbl4            | myGroup1   |            20 | f                     |                |                           |             
         8016 | ADD_SEQ     | myschema2   | myTbl3_col31_seq  | myGroup2   |               | f                     |                |                           |             
         8016 | ADD_SEQ     | myschema2   | myseq1            | myGroup2   |               | f                     |                |                           |             
(46 rows)

select time_id, time_last_emaj_gid, time_event from emaj.emaj_time_stamp where time_id > 8000 order by time_id;
 time_id | time_last_emaj_gid | time_event 
---------+--------------------+------------
    8001 |            8000000 | D
    8002 |            8000000 | D
    8003 |            8000000 | M
    8004 |            8000000 | D
    8005 |            8000000 | D
    8006 |            8000000 | D
    8007 |            8000000 | C
    8008 |            8000000 | I
    8009 |            8000000 | A
    8010 |            8000000 | A
    8011 |            8000000 | A
    8012 |            8000000 | A
    8013 |            8000000 | A
    8014 |            8000000 | A
    8015 |            8000000 | A
    8016 |            8000000 | I
(16 rows)

select hist_function, hist_event, hist_object,
       regexp_replace(regexp_replace(regexp_replace(hist_wording,
            E'\\d\\d\.\\d\\d\\.\\d\\d\\.\\d\\d\\d\\d','%','g'),
            E'\\d\\d\\d\\d/\\d\\d\\/\\d\\d\\ \\d\\d\\:\\d\\d:\\d\\d .*?\\)','<timestamp>)','g'),
            E'\\[.+\\]','(timestamp)','g'), 
       hist_user 
  from emaj.emaj_hist where hist_id > 8000 order by hist_id;
  hist_function   |     hist_event     |               hist_object                |                       regexp_replace                       | hist_user 
------------------+--------------------+------------------------------------------+------------------------------------------------------------+-----------
 LOCK_GROUP       | BEGIN              | myGroup1                                 |                                                            | postgres
 LOCK_GROUP       | END                | myGroup1                                 | 5 tables locked, 0 deadlock(s)                             | postgres
 SET_MARK_GROUP   | BEGIN              | myGroup1                                 | STOP_%                                                     | postgres
 SET_MARK_GROUP   | END                | myGroup1                                 | STOP_%                                                     | postgres
 STOP_GROUP       | END                | myGroup1                                 | 7 tables/sequences processed                               | postgres
 RESET_GROUP      | BEGIN              | myGroup1                                 |                                                            | postgres
 RESET_GROUP      | END                | myGroup1                                 | 7 tables/sequences processed                               | postgres
 DROP_GROUP       | BEGIN              | myGroup1                                 |                                                            | postgres
 DROP_GROUP       | LOG_SCHEMA DROPPED | emaj_myschema1                           |                                                            | postgres
 DROP_GROUP       | END                | myGroup1                                 | 7 tables/sequences processed                               | postgres
 FORCE_DROP_GROUP | BEGIN              | myGroup2                                 |                                                            | postgres
 FORCE_DROP_GROUP | LOG_SCHEMA DROPPED | emaj_myschema2                           |                                                            | postgres
 FORCE_DROP_GROUP | END                | myGroup2                                 | 10 tables/sequences processed                              | postgres
 STOP_GROUP       | BEGIN              | phil's group#3",                         |                                                            | postgres
 LOCK_GROUP       | BEGIN              | phil's group#3",                         |                                                            | postgres
 LOCK_GROUP       | END                | phil's group#3",                         | 2 tables locked, 0 deadlock(s)                             | postgres
 SET_MARK_GROUP   | BEGIN              | phil's group#3",                         | Simple stop mark                                           | postgres
 SET_MARK_GROUP   | END                | phil's group#3",                         | Simple stop mark                                           | postgres
 STOP_GROUP       | END                | phil's group#3",                         | 4 tables/sequences processed                               | postgres
 DROP_GROUP       | BEGIN              | phil's group#3",                         |                                                            | postgres
 DROP_GROUP       | LOG_SCHEMA DROPPED | "emaj_phil's schema3"                    |                                                            | postgres
 DROP_GROUP       | END                | phil's group#3",                         | 4 tables/sequences processed                               | postgres
 FORCE_STOP_GROUP | BEGIN              | myGroup4                                 |                                                            | postgres
 LOCK_GROUP       | BEGIN              | myGroup4                                 |                                                            | postgres
 LOCK_GROUP       | END                | myGroup4                                 | 5 tables locked, 0 deadlock(s)                             | postgres
 FORCE_STOP_GROUP | END                | myGroup4                                 | 5 tables/sequences processed                               | postgres
 DROP_GROUP       | BEGIN              | myGroup4                                 |                                                            | postgres
 DROP_GROUP       | LOG_SCHEMA DROPPED | emaj_myschema4                           |                                                            | postgres
 DROP_GROUP       | END                | myGroup4                                 | 5 tables/sequences processed                               | postgres
 FORCE_STOP_GROUP | BEGIN              | emptyGroup                               |                                                            | postgres
 LOCK_GROUP       | BEGIN              | emptyGroup                               |                                                            | postgres
 LOCK_GROUP       | END                | emptyGroup                               | 0 tables locked, 0 deadlock(s)                             | postgres
 FORCE_STOP_GROUP | END                | emptyGroup                               | 0 tables/sequences processed                               | postgres
 DROP_GROUP       | BEGIN              | emptyGroup                               |                                                            | postgres
 DROP_GROUP       | END                | emptyGroup                               | 0 tables/sequences processed                               | postgres
 CREATE_GROUP     | BEGIN              | myGroup1                                 | rollbackable                                               | postgres
 CREATE_GROUP     | END                | myGroup1                                 |                                                            | postgres
 IMPORT_GROUPS    | BEGIN              | myGroup1, myGroup2, emptyGroup, myGroup4 | Input file: '/tmp/emaj_11/alter/../all_groups_config.json' | postgres
 IMPORT_GROUPS    | GROUP CREATED      | emptyGroup                               | rollbackable                                               | postgres
 IMPORT_GROUPS    | GROUP CREATED      | myGroup2                                 | rollbackable                                               | postgres
 IMPORT_GROUPS    | GROUP CREATED      | myGroup4                                 | rollbackable                                               | postgres
 IMPORT_GROUPS    | LOG_SCHEMA CREATED | emaj_myschema1                           |                                                            | postgres
 IMPORT_GROUPS    | LOG_SCHEMA CREATED | emaj_myschema2                           |                                                            | postgres
 IMPORT_GROUPS    | LOG_SCHEMA CREATED | emaj_myschema4                           |                                                            | postgres
 IMPORT_GROUPS    | TABLE ADDED        | myschema1."myTbl3"                       | To the idle group myGroup1                                 | postgres
 IMPORT_GROUPS    | TABLE ADDED        | myschema1.mytbl1                         | To the idle group myGroup1                                 | postgres
 IMPORT_GROUPS    | TABLE ADDED        | myschema1.mytbl4                         | To the idle group myGroup1                                 | postgres
 IMPORT_GROUPS    | TABLE ADDED        | myschema1.mytbl2                         | To the idle group myGroup1                                 | postgres
 IMPORT_GROUPS    | TABLE ADDED        | myschema1.mytbl2b                        | To the idle group myGroup1                                 | postgres
 IMPORT_GROUPS    | TABLE ADDED        | myschema2."myTbl3"                       | To the idle group myGroup2                                 | postgres
 IMPORT_GROUPS    | TABLE ADDED        | myschema2.mytbl1                         | To the idle group myGroup2                                 | postgres
 IMPORT_GROUPS    | TABLE ADDED        | myschema2.mytbl2                         | To the idle group myGroup2                                 | postgres
 IMPORT_GROUPS    | TABLE ADDED        | myschema2.mytbl4                         | To the idle group myGroup2                                 | postgres
 IMPORT_GROUPS    | TABLE ADDED        | myschema2.mytbl5                         | To the idle group myGroup2                                 | postgres
 IMPORT_GROUPS    | TABLE ADDED        | myschema2.mytbl6                         | To the idle group myGroup2                                 | postgres
 IMPORT_GROUPS    | TABLE ADDED        | myschema2.mytbl7                         | To the idle group myGroup2                                 | postgres
 IMPORT_GROUPS    | TABLE ADDED        | myschema2.mytbl8                         | To the idle group myGroup2                                 | postgres
 IMPORT_GROUPS    | TABLE ADDED        | myschema4.mypartp1                       | To the idle group myGroup4                                 | postgres
 IMPORT_GROUPS    | TABLE ADDED        | myschema4.mypartp2                       | To the idle group myGroup4                                 | postgres
 IMPORT_GROUPS    | TABLE ADDED        | myschema4.mytblc1                        | To the idle group myGroup4                                 | postgres
 IMPORT_GROUPS    | TABLE ADDED        | myschema4.mytblc2                        | To the idle group myGroup4                                 | postgres
 IMPORT_GROUPS    | TABLE ADDED        | myschema4.mytblm                         | To the idle group myGroup4                                 | postgres
 IMPORT_GROUPS    | SEQUENCE ADDED     | myschema1."myTbl3_col31_seq"             | To the idle group myGroup1                                 | postgres
 IMPORT_GROUPS    | SEQUENCE ADDED     | myschema1.mytbl2b_col20_seq              | To the idle group myGroup1                                 | postgres
 IMPORT_GROUPS    | SEQUENCE ADDED     | myschema2."myTbl3_col31_seq"             | To the idle group myGroup2                                 | postgres
 IMPORT_GROUPS    | SEQUENCE ADDED     | myschema2.myseq1                         | To the idle group myGroup2                                 | postgres
 IMPORT_GROUPS    | END                |                                          | 4 created or altered tables groups                         | postgres
 REMOVE_TABLE     | BEGIN              |                                          |                                                            | postgres
 REMOVE_TABLE     | TABLE REMOVED      | myschema1.mytbl1                         | From the idle group myGroup1                               | postgres
 REMOVE_TABLE     | END                |                                          | 1 tables removed from their groups                         | postgres
 REMOVE_TABLES    | BEGIN              |                                          |                                                            | postgres
 REMOVE_TABLES    | END                |                                          | 0 tables removed from their groups                         | postgres
 REMOVE_TABLES    | BEGIN              |                                          |                                                            | postgres
 REMOVE_TABLES    | END                |                                          | 0 tables removed from their groups                         | postgres
 REMOVE_TABLES    | BEGIN              |                                          |                                                            | postgres
 REMOVE_TABLES    | END                |                                          | 0 tables removed from their groups                         | postgres
 REMOVE_TABLES    | BEGIN              |                                          |                                                            | postgres
 REMOVE_TABLES    | TABLE REMOVED      | myschema1.mytbl2                         | From the idle group myGroup1                               | postgres
 REMOVE_TABLES    | TABLE REMOVED      | myschema1.mytbl2b                        | From the idle group myGroup1                               | postgres
 REMOVE_TABLES    | END                |                                          | 2 tables removed from their groups                         | postgres
 REMOVE_TABLES    | BEGIN              |                                          |                                                            | postgres
 REMOVE_TABLES    | END                |                                          | 0 tables removed from their groups                         | postgres
 REMOVE_TABLES    | BEGIN              |                                          |                                                            | postgres
 REMOVE_TABLES    | END                |                                          | 0 tables removed from their groups                         | postgres
 REMOVE_TABLES    | BEGIN              |                                          |                                                            | postgres
 REMOVE_TABLES    | END                |                                          | 0 tables removed from their groups                         | postgres
 REMOVE_TABLES    | BEGIN              |                                          |                                                            | postgres
 REMOVE_TABLES    | TABLE REMOVED      | myschema1."myTbl3"                       | From the idle group myGroup1                               | postgres
 REMOVE_TABLES    | TABLE REMOVED      | myschema1.mytbl4                         | From the idle group myGroup1                               | postgres
 REMOVE_TABLES    | LOG_SCHEMA DROPPED | emaj_myschema1                           |                                                            | postgres
 REMOVE_TABLES    | END                |                                          | 2 tables removed from their groups                         | postgres
 REMOVE_SEQUENCE  | BEGIN              |                                          |                                                            | postgres
 REMOVE_SEQUENCE  | SEQUENCE REMOVED   | myschema2.myseq1                         | From the idle group myGroup2                               | postgres
 REMOVE_SEQUENCE  | END                |                                          | 1 sequences removed from their groups                      | postgres
 REMOVE_SEQUENCES | BEGIN              |                                          |                                                            | postgres
 REMOVE_SEQUENCES | END                |                                          | 0 sequences removed from their groups                      | postgres
 REMOVE_SEQUENCES | BEGIN              |                                          |                                                            | postgres
 REMOVE_SEQUENCES | END                |                                          | 0 sequences removed from their groups                      | postgres
 REMOVE_SEQUENCES | BEGIN              |                                          |                                                            | postgres
 REMOVE_SEQUENCES | END                |                                          | 0 sequences removed from their groups                      | postgres
 ASSIGN_SEQUENCE  | BEGIN              |                                          |                                                            | postgres
 ASSIGN_SEQUENCE  | SEQUENCE ADDED     | myschema2.myseq2                         | To the idle group myGroup2                                 | postgres
 ASSIGN_SEQUENCE  | END                |                                          | 1 sequences assigned to the group myGroup2                 | postgres
 REMOVE_SEQUENCES | BEGIN              |                                          |                                                            | postgres
 REMOVE_SEQUENCES | SEQUENCE REMOVED   | myschema2.myseq2                         | From the idle group myGroup2                               | postgres
 REMOVE_SEQUENCES | END                |                                          | 1 sequences removed from their groups                      | postgres
 REMOVE_SEQUENCES | BEGIN              |                                          |                                                            | postgres
 REMOVE_SEQUENCES | END                |                                          | 0 sequences removed from their groups                      | postgres
 REMOVE_SEQUENCES | BEGIN              |                                          |                                                            | postgres
 REMOVE_SEQUENCES | END                |                                          | 0 sequences removed from their groups                      | postgres
 REMOVE_SEQUENCES | BEGIN              |                                          |                                                            | postgres
 REMOVE_SEQUENCES | END                |                                          | 0 sequences removed from their groups                      | postgres
 REMOVE_SEQUENCES | BEGIN              |                                          |                                                            | postgres
 REMOVE_SEQUENCES | SEQUENCE REMOVED   | myschema2."myTbl3_col31_seq"             | From the idle group myGroup2                               | postgres
 REMOVE_SEQUENCES | END                |                                          | 1 sequences removed from their groups                      | postgres
 IMPORT_GROUPS    | BEGIN              | myGroup1, myGroup2, emptyGroup, myGroup4 | Input file: '/tmp/emaj_11/alter/../all_groups_config.json' | postgres
 IMPORT_GROUPS    | LOG_SCHEMA CREATED | emaj_myschema1                           |                                                            | postgres
 IMPORT_GROUPS    | TABLE ADDED        | myschema1."myTbl3"                       | To the idle group myGroup1                                 | postgres
 IMPORT_GROUPS    | TABLE ADDED        | myschema1.mytbl1                         | To the idle group myGroup1                                 | postgres
 IMPORT_GROUPS    | TABLE ADDED        | myschema1.mytbl4                         | To the idle group myGroup1                                 | postgres
 IMPORT_GROUPS    | TABLE ADDED        | myschema1.mytbl2                         | To the idle group myGroup1                                 | postgres
 IMPORT_GROUPS    | TABLE ADDED        | myschema1.mytbl2b                        | To the idle group myGroup1                                 | postgres
 IMPORT_GROUPS    | SEQUENCE ADDED     | myschema2."myTbl3_col31_seq"             | To the idle group myGroup2                                 | postgres
 IMPORT_GROUPS    | SEQUENCE ADDED     | myschema2.myseq1                         | To the idle group myGroup2                                 | postgres
 IMPORT_GROUPS    | END                |                                          | 4 created or altered tables groups                         | postgres
(125 rows)

-- set sequence restart value
select public.handle_emaj_sequences(8200);
 handle_emaj_sequences 
-----------------------
 
(1 row)

-----------------------------------
-- emaj_move_table
-----------------------------------
-- error cases
-- table not in a group
select emaj.emaj_move_table('dummySchema','mytbl1','myGroup2');
ERROR:  _move_tables: some tables ("dummySchema".mytbl1) do not currently belong to any tables group.
CONTEXT:  PL/pgSQL function emaj._move_tables(text,text[],text,text,boolean,boolean) line 55 at RAISE
PL/pgSQL function emaj.emaj_move_table(text,text,text,text) line 6 at RETURN
select emaj.emaj_move_table('myschema1','dummyTable','myGroup2');
ERROR:  _move_tables: some tables (myschema1."dummyTable") do not currently belong to any tables group.
CONTEXT:  PL/pgSQL function emaj._move_tables(text,text[],text,text,boolean,boolean) line 55 at RAISE
PL/pgSQL function emaj.emaj_move_table(text,text,text,text) line 6 at RETURN
-- bad new group
select emaj.emaj_move_table('myschema1','mytbl1','dummyGroup');
ERROR:  _check_group_names: The group "dummyGroup" does not exist.
CONTEXT:  PL/pgSQL function emaj._check_group_names(text[],boolean,boolean,text) line 42 at RAISE
SQL statement "SELECT emaj._check_group_names(v_groupNames := ARRAY[v_newGroup], v_mayBeNull := FALSE, v_lockGroups := TRUE, v_checkList := '')"
PL/pgSQL function emaj._move_tables(text,text[],text,text,boolean,boolean) line 26 at PERFORM
PL/pgSQL function emaj.emaj_move_table(text,text,text,text) line 6 at RETURN
-- bad mark
select emaj.emaj_move_table('myschema1','mytbl1','myGroup2','EMAJ_LAST_MARK');
ERROR:  _check_new_mark: "EMAJ_LAST_MARK" is not an allowed name for a new mark.
CONTEXT:  PL/pgSQL function emaj._check_new_mark(text[],text) line 14 at RAISE
SQL statement "SELECT emaj._check_new_mark(v_loggingGroups, v_mark)"
PL/pgSQL function emaj._move_tables(text,text[],text,text,boolean,boolean) line 89 at SQL statement
PL/pgSQL function emaj.emaj_move_table(text,text,text,text) line 6 at RETURN
-- move to the same group
select emaj.emaj_move_table('myschema1','mytbl1','myGroup1');
WARNING:  _move_tables: some tables (myschema1.mytbl1) already belong to the tables group myGroup1.
 emaj_move_table 
-----------------
               0
(1 row)

-- ok
select emaj.emaj_move_table('myschema1','mytbl1','myGroup2');
 emaj_move_table 
-----------------
               1
(1 row)

-----------------------------------
-- emaj_move_tables with array
-----------------------------------
-- error cases
-- table not in a group
select emaj.emaj_move_tables('myschema1',array['dummyTable','mytbl1','mytbl2'],'myGroup1');
ERROR:  _move_tables: some tables (myschema1."dummyTable") do not currently belong to any tables group.
CONTEXT:  PL/pgSQL function emaj._move_tables(text,text[],text,text,boolean,boolean) line 55 at RAISE
PL/pgSQL function emaj.emaj_move_tables(text,text[],text,text) line 6 at RETURN
-- empty tables array
select emaj.emaj_move_tables('myschema1',array[]::text[],'myGroup1');
WARNING:  _move_tables: No table to process.
 emaj_move_tables 
------------------
                0
(1 row)

select emaj.emaj_move_tables('myschema1',null,'myGroup1');
WARNING:  _move_tables: No table to process.
 emaj_move_tables 
------------------
                0
(1 row)

select emaj.emaj_move_tables('myschema1',array[''],'myGroup1');
WARNING:  _move_tables: No table to process.
 emaj_move_tables 
------------------
                0
(1 row)

-- ok (with a duplicate table name)
select emaj.emaj_move_tables('myschema1',array['mytbl2','mytbl2b','mytbl2'],'myGroup2');
 emaj_move_tables 
------------------
                2
(1 row)

select rel_schema, rel_tblseq, rel_group from emaj.emaj_relation
  where rel_schema = 'myschema1' and rel_kind = 'r' and upper_inf(rel_time_range)
  order by 1,2,3;
 rel_schema | rel_tblseq | rel_group 
------------+------------+-----------
 myschema1  | myTbl3     | myGroup1
 myschema1  | mytbl1     | myGroup2
 myschema1  | mytbl2     | myGroup2
 myschema1  | mytbl2b    | myGroup2
 myschema1  | mytbl4     | myGroup1
(5 rows)

-----------------------------------
-- emaj_move_tables with filters
-----------------------------------
-- empty tables array
select emaj.emaj_move_tables('myschema1',null,null,'myGroup1');
WARNING:  _move_tables: No table to process.
 emaj_move_tables 
------------------
                0
(1 row)

select emaj.emaj_move_tables('myschema1','','','myGroup1');
WARNING:  _move_tables: No table to process.
 emaj_move_tables 
------------------
                0
(1 row)

select emaj.emaj_move_tables('myschema1','mytbl1','mytbl1','myGroup1');
WARNING:  _move_tables: No table to process.
 emaj_move_tables 
------------------
                0
(1 row)

-- ok and go back to myGroup1
select emaj.emaj_move_tables('myschema1','my(t|T)bl.*','mytbl2$','myGroup1');
 emaj_move_tables 
------------------
                2
(1 row)

select emaj.emaj_move_tables('myschema1','.*','','myGroup1');
 emaj_move_tables 
------------------
                1
(1 row)

select altr_time_id, altr_step, altr_schema, altr_tblseq, altr_group, altr_priority, altr_group_is_logging,
       altr_new_group, altr_new_group_is_logging from emaj.emaj_alter_plan
  order by 1 desc, 2,3,4 limit 6;
 altr_time_id | altr_step | altr_schema | altr_tblseq | altr_group | altr_priority | altr_group_is_logging | altr_new_group | altr_new_group_is_logging 
--------------+-----------+-------------+-------------+------------+---------------+-----------------------+----------------+---------------------------
         8204 | MOVE_TBL  | myschema1   | mytbl2      | myGroup2   |               | f                     | myGroup1       | f
         8203 | MOVE_TBL  | myschema1   | mytbl1      | myGroup2   |               | f                     | myGroup1       | f
         8203 | MOVE_TBL  | myschema1   | mytbl2b     | myGroup2   |               | f                     | myGroup1       | f
         8202 | MOVE_TBL  | myschema1   | mytbl2      | myGroup1   |               | f                     | myGroup2       | f
         8202 | MOVE_TBL  | myschema1   | mytbl2b     | myGroup1   |               | f                     | myGroup2       | f
         8201 | MOVE_TBL  | myschema1   | mytbl1      | myGroup1   |               | f                     | myGroup2       | f
(6 rows)

select group_last_alter_time_id, group_nb_table, group_nb_sequence from emaj.emaj_group 
  where group_name in ('myGroup1','myGroup2') order by 1 desc ,2,3;
 group_last_alter_time_id | group_nb_table | group_nb_sequence 
--------------------------+----------------+-------------------
                     8204 |              5 |                 2
                     8204 |              8 |                 2
(2 rows)

-----------------------------------
-- emaj_move_sequence
-----------------------------------
-- error cases
-- sequence not in a group
select emaj.emaj_move_sequence('dummySchema','myseq1','myGroup1');
ERROR:  _move_sequences: some sequences ("dummySchema".myseq1) do not currently belong to any tables group.
CONTEXT:  PL/pgSQL function emaj._move_sequences(text,text[],text,text,boolean,boolean) line 56 at RAISE
PL/pgSQL function emaj.emaj_move_sequence(text,text,text,text) line 6 at RETURN
select emaj.emaj_move_sequence('myschema2','dummySequence','myGroup1');
ERROR:  _move_sequences: some sequences (myschema2."dummySequence") do not currently belong to any tables group.
CONTEXT:  PL/pgSQL function emaj._move_sequences(text,text[],text,text,boolean,boolean) line 56 at RAISE
PL/pgSQL function emaj.emaj_move_sequence(text,text,text,text) line 6 at RETURN
-- bad new group
select emaj.emaj_move_sequence('myschema2','myseq1','dummyGroup');
ERROR:  _check_group_names: The group "dummyGroup" does not exist.
CONTEXT:  PL/pgSQL function emaj._check_group_names(text[],boolean,boolean,text) line 42 at RAISE
SQL statement "SELECT emaj._check_group_names(v_groupNames := ARRAY[v_newGroup], v_mayBeNull := FALSE, v_lockGroups := TRUE, v_checkList := '')"
PL/pgSQL function emaj._move_sequences(text,text[],text,text,boolean,boolean) line 26 at PERFORM
PL/pgSQL function emaj.emaj_move_sequence(text,text,text,text) line 6 at RETURN
-- bad mark
select emaj.emaj_move_sequence('myschema2','myseq1','myGroup1','EMAJ_LAST_MARK');
ERROR:  _check_new_mark: "EMAJ_LAST_MARK" is not an allowed name for a new mark.
CONTEXT:  PL/pgSQL function emaj._check_new_mark(text[],text) line 14 at RAISE
SQL statement "SELECT emaj._check_new_mark(v_loggingGroups, v_mark)"
PL/pgSQL function emaj._move_sequences(text,text[],text,text,boolean,boolean) line 92 at SQL statement
PL/pgSQL function emaj.emaj_move_sequence(text,text,text,text) line 6 at RETURN
-- move to the same group
select emaj.emaj_move_sequence('myschema2','myseq1','myGroup2');
WARNING:  _move_sequences: some sequences (myschema2.myseq1) already belong to the tables group myGroup2.
 emaj_move_sequence 
--------------------
                  0
(1 row)

-- ok
select emaj.emaj_move_sequence('myschema2','myseq1','myGroup1');
 emaj_move_sequence 
--------------------
                  1
(1 row)

-----------------------------------
-- emaj_move_sequences with array
-----------------------------------
-- error cases
-- sequence not in a group
select emaj.emaj_move_sequences('myschema2',array['dummySequence','myseq1'],'myGroup1');
ERROR:  _move_sequences: some sequences (myschema2."dummySequence") do not currently belong to any tables group.
CONTEXT:  PL/pgSQL function emaj._move_sequences(text,text[],text,text,boolean,boolean) line 56 at RAISE
PL/pgSQL function emaj.emaj_move_sequences(text,text[],text,text) line 6 at RETURN
-- empty tables array
select emaj.emaj_move_sequences('myschema2',array[]::text[],'myGroup1');
WARNING:  _move_sequences: No sequence to process.
 emaj_move_sequences 
---------------------
                   0
(1 row)

select emaj.emaj_move_sequences('myschema2',null,'myGroup1');
WARNING:  _move_sequences: No sequence to process.
 emaj_move_sequences 
---------------------
                   0
(1 row)

select emaj.emaj_move_sequences('myschema2',array[''],'myGroup1');
WARNING:  _move_sequences: No sequence to process.
 emaj_move_sequences 
---------------------
                   0
(1 row)

-- ok (with a duplicate sequence name)
select emaj.emaj_move_sequences('myschema2',array['myseq1','myseq1'],'myGroup4');
 emaj_move_sequences 
---------------------
                   1
(1 row)

select rel_schema, rel_tblseq, rel_group from emaj.emaj_relation
  where rel_schema = 'myschema2' and rel_kind = 'S' and upper_inf(rel_time_range)
  order by 1,2,3;
 rel_schema |    rel_tblseq    | rel_group 
------------+------------------+-----------
 myschema2  | myTbl3_col31_seq | myGroup2
 myschema2  | myseq1           | myGroup4
(2 rows)

-----------------------------------
-- emaj_move_sequences with filters
-----------------------------------
-- empty sequences array
select emaj.emaj_move_sequences('myschema21',null,null,'myGroup2');
WARNING:  _move_sequences: No sequence to process.
 emaj_move_sequences 
---------------------
                   0
(1 row)

select emaj.emaj_move_sequences('myschema21','','','myGroup2');
WARNING:  _move_sequences: No sequence to process.
 emaj_move_sequences 
---------------------
                   0
(1 row)

select emaj.emaj_move_sequences('myschema21','myseq1','myseq1','myGroup2');
WARNING:  _move_sequences: No sequence to process.
 emaj_move_sequences 
---------------------
                   0
(1 row)

-- ok and go back to myGroup2
select emaj.emaj_move_sequences('myschema2','.*','','myGroup2');
 emaj_move_sequences 
---------------------
                   1
(1 row)

select altr_time_id, altr_step, altr_schema, altr_tblseq, altr_group, altr_priority, altr_group_is_logging,
       altr_new_group, altr_new_group_is_logging from emaj.emaj_alter_plan
  order by 1 desc, 2,3,4 limit 3;
 altr_time_id | altr_step | altr_schema | altr_tblseq | altr_group | altr_priority | altr_group_is_logging | altr_new_group | altr_new_group_is_logging 
--------------+-----------+-------------+-------------+------------+---------------+-----------------------+----------------+---------------------------
         8208 | MOVE_SEQ  | myschema2   | myseq1      | myGroup4   |               | f                     | myGroup2       | f
         8207 | MOVE_SEQ  | myschema2   | myseq1      | myGroup1   |               | f                     | myGroup4       | f
         8206 | MOVE_SEQ  | myschema2   | myseq1      | myGroup2   |               | f                     | myGroup1       | f
(3 rows)

select group_last_alter_time_id, group_nb_table, group_nb_sequence from emaj.emaj_group 
  where group_name in ('myGroup1','myGroup2','myGroup4') order by 1 desc ,2,3;
 group_last_alter_time_id | group_nb_table | group_nb_sequence 
--------------------------+----------------+-------------------
                     8208 |              5 |                 0
                     8208 |              8 |                 2
                     8207 |              5 |                 2
(3 rows)

-- check for emaj_move_table() and emaj_move_sequence() functions family
select * from emaj.emaj_alter_plan where altr_time_id > 8200 order by 1,2,3,4,5;
 altr_time_id | altr_step | altr_schema | altr_tblseq | altr_group | altr_priority | altr_group_is_logging | altr_new_group | altr_new_group_is_logging | altr_rlbk_id 
--------------+-----------+-------------+-------------+------------+---------------+-----------------------+----------------+---------------------------+--------------
         8201 | MOVE_TBL  | myschema1   | mytbl1      | myGroup1   |               | f                     | myGroup2       | f                         |             
         8202 | MOVE_TBL  | myschema1   | mytbl2      | myGroup1   |               | f                     | myGroup2       | f                         |             
         8202 | MOVE_TBL  | myschema1   | mytbl2b     | myGroup1   |               | f                     | myGroup2       | f                         |             
         8203 | MOVE_TBL  | myschema1   | mytbl1      | myGroup2   |               | f                     | myGroup1       | f                         |             
         8203 | MOVE_TBL  | myschema1   | mytbl2b     | myGroup2   |               | f                     | myGroup1       | f                         |             
         8204 | MOVE_TBL  | myschema1   | mytbl2      | myGroup2   |               | f                     | myGroup1       | f                         |             
         8206 | MOVE_SEQ  | myschema2   | myseq1      | myGroup2   |               | f                     | myGroup1       | f                         |             
         8207 | MOVE_SEQ  | myschema2   | myseq1      | myGroup1   |               | f                     | myGroup4       | f                         |             
         8208 | MOVE_SEQ  | myschema2   | myseq1      | myGroup4   |               | f                     | myGroup2       | f                         |             
(9 rows)

select time_id, time_last_emaj_gid, time_event from emaj.emaj_time_stamp where time_id > 8200 order by time_id;
 time_id | time_last_emaj_gid | time_event 
---------+--------------------+------------
    8201 |            8200000 | A
    8202 |            8200000 | A
    8203 |            8200000 | A
    8204 |            8200000 | A
    8205 |            8200000 | A
    8206 |            8200000 | A
    8207 |            8200000 | A
    8208 |            8200000 | A
(8 rows)

select hist_function, hist_event, hist_object,
       regexp_replace(regexp_replace(regexp_replace(hist_wording,
            E'\\d\\d\.\\d\\d\\.\\d\\d\\.\\d\\d\\d\\d','%','g'),
            E'\\d\\d\\d\\d/\\d\\d\\/\\d\\d\\ \\d\\d\\:\\d\\d:\\d\\d .*?\\)','<timestamp>)','g'),
            E'\\[.+\\]','(timestamp)','g'), 
       hist_user 
  from emaj.emaj_hist where hist_id > 8200 order by hist_id;
 hist_function  |   hist_event   |    hist_object    |                     regexp_replace                      | hist_user 
----------------+----------------+-------------------+---------------------------------------------------------+-----------
 MOVE_TABLE     | BEGIN          |                   |                                                         | postgres
 MOVE_TABLE     | END            |                   | 0 tables moved to the new tables group myGroup1         | postgres
 MOVE_TABLE     | BEGIN          |                   |                                                         | postgres
 MOVE_TABLE     | TABLE MOVED    | myschema1.mytbl1  | From the idle group myGroup1 to the idle group myGroup2 | postgres
 MOVE_TABLE     | END            |                   | 1 tables moved to the new tables group myGroup2         | postgres
 MOVE_TABLES    | BEGIN          |                   |                                                         | postgres
 MOVE_TABLES    | END            |                   | 0 tables moved to the new tables group myGroup1         | postgres
 MOVE_TABLES    | BEGIN          |                   |                                                         | postgres
 MOVE_TABLES    | END            |                   | 0 tables moved to the new tables group myGroup1         | postgres
 MOVE_TABLES    | BEGIN          |                   |                                                         | postgres
 MOVE_TABLES    | END            |                   | 0 tables moved to the new tables group myGroup1         | postgres
 MOVE_TABLES    | BEGIN          |                   |                                                         | postgres
 MOVE_TABLES    | TABLE MOVED    | myschema1.mytbl2  | From the idle group myGroup1 to the idle group myGroup2 | postgres
 MOVE_TABLES    | TABLE MOVED    | myschema1.mytbl2b | From the idle group myGroup1 to the idle group myGroup2 | postgres
 MOVE_TABLES    | END            |                   | 2 tables moved to the new tables group myGroup2         | postgres
 MOVE_TABLES    | BEGIN          |                   |                                                         | postgres
 MOVE_TABLES    | END            |                   | 0 tables moved to the new tables group myGroup1         | postgres
 MOVE_TABLES    | BEGIN          |                   |                                                         | postgres
 MOVE_TABLES    | END            |                   | 0 tables moved to the new tables group myGroup1         | postgres
 MOVE_TABLES    | BEGIN          |                   |                                                         | postgres
 MOVE_TABLES    | END            |                   | 0 tables moved to the new tables group myGroup1         | postgres
 MOVE_TABLES    | BEGIN          |                   |                                                         | postgres
 MOVE_TABLES    | TABLE MOVED    | myschema1.mytbl1  | From the idle group myGroup2 to the idle group myGroup1 | postgres
 MOVE_TABLES    | TABLE MOVED    | myschema1.mytbl2b | From the idle group myGroup2 to the idle group myGroup1 | postgres
 MOVE_TABLES    | END            |                   | 2 tables moved to the new tables group myGroup1         | postgres
 MOVE_TABLES    | BEGIN          |                   |                                                         | postgres
 MOVE_TABLES    | TABLE MOVED    | myschema1.mytbl2  | From the idle group myGroup2 to the idle group myGroup1 | postgres
 MOVE_TABLES    | END            |                   | 1 tables moved to the new tables group myGroup1         | postgres
 MOVE_SEQUENCE  | BEGIN          |                   |                                                         | postgres
 MOVE_SEQUENCE  | END            |                   | 0 sequences moved to the new tables group myGroup2      | postgres
 MOVE_SEQUENCE  | BEGIN          |                   |                                                         | postgres
 MOVE_SEQUENCE  | SEQUENCE MOVED | myschema2.myseq1  | From the idle group myGroup2 to the idle group myGroup1 | postgres
 MOVE_SEQUENCE  | END            |                   | 1 sequences moved to the new tables group myGroup1      | postgres
 MOVE_SEQUENCES | BEGIN          |                   |                                                         | postgres
 MOVE_SEQUENCES | END            |                   | 0 sequences moved to the new tables group myGroup1      | postgres
 MOVE_SEQUENCES | BEGIN          |                   |                                                         | postgres
 MOVE_SEQUENCES | END            |                   | 0 sequences moved to the new tables group myGroup1      | postgres
 MOVE_SEQUENCES | BEGIN          |                   |                                                         | postgres
 MOVE_SEQUENCES | END            |                   | 0 sequences moved to the new tables group myGroup1      | postgres
 MOVE_SEQUENCES | BEGIN          |                   |                                                         | postgres
 MOVE_SEQUENCES | SEQUENCE MOVED | myschema2.myseq1  | From the idle group myGroup1 to the idle group myGroup4 | postgres
 MOVE_SEQUENCES | END            |                   | 1 sequences moved to the new tables group myGroup4      | postgres
 MOVE_SEQUENCES | BEGIN          |                   |                                                         | postgres
 MOVE_SEQUENCES | END            |                   | 0 sequences moved to the new tables group myGroup2      | postgres
 MOVE_SEQUENCES | BEGIN          |                   |                                                         | postgres
 MOVE_SEQUENCES | END            |                   | 0 sequences moved to the new tables group myGroup2      | postgres
 MOVE_SEQUENCES | BEGIN          |                   |                                                         | postgres
 MOVE_SEQUENCES | END            |                   | 0 sequences moved to the new tables group myGroup2      | postgres
 MOVE_SEQUENCES | BEGIN          |                   |                                                         | postgres
 MOVE_SEQUENCES | SEQUENCE MOVED | myschema2.myseq1  | From the idle group myGroup4 to the idle group myGroup2 | postgres
 MOVE_SEQUENCES | END            |                   | 1 sequences moved to the new tables group myGroup2      | postgres
(51 rows)

-- set sequence restart value
select public.handle_emaj_sequences(8400);
 handle_emaj_sequences 
-----------------------
 
(1 row)

-----------------------------------
-- emaj_modify_table
-----------------------------------
-- error cases
-- table not in a group
select emaj.emaj_modify_table('dummySchema','mytbl1',null);
ERROR:  _modify_tables: some tables ("dummySchema".mytbl1) do not currently belong to any tables group.
CONTEXT:  PL/pgSQL function emaj._modify_tables(text,text[],jsonb,text,boolean,boolean) line 57 at RAISE
PL/pgSQL function emaj.emaj_modify_table(text,text,jsonb,text) line 7 at RETURN
select emaj.emaj_modify_table('myschema1','dummyTable',null);
ERROR:  _modify_tables: some tables (myschema1."dummyTable") do not currently belong to any tables group.
CONTEXT:  PL/pgSQL function emaj._modify_tables(text,text[],jsonb,text,boolean,boolean) line 57 at RAISE
PL/pgSQL function emaj.emaj_modify_table(text,text,jsonb,text) line 7 at RETURN
-- invalid priority
select emaj.emaj_modify_table('myschema1','mytbl1','{"priority":"not_numeric"}'::jsonb);
ERROR:  _modify_tables: the "priority" property is not numeric.
CONTEXT:  PL/pgSQL function emaj._modify_tables(text,text[],jsonb,text,boolean,boolean) line 66 at RAISE
PL/pgSQL function emaj.emaj_modify_table(text,text,jsonb,text) line 7 at RETURN
-- invalid tablespace
select emaj.emaj_modify_table('myschema1','mytbl1','{"log_data_tablespace":"dummytsp"}'::jsonb);
ERROR:  _modify_tables: the log data tablespace "dummytsp" does not exists.
CONTEXT:  PL/pgSQL function emaj._modify_tables(text,text[],jsonb,text,boolean,boolean) line 79 at RAISE
PL/pgSQL function emaj.emaj_modify_table(text,text,jsonb,text) line 7 at RETURN
select emaj.emaj_modify_table('myschema1','mytbl1','{"log_index_tablespace":"dummytsp"}'::jsonb);
ERROR:  _modify_tables: the log index tablespace "dummytsp" does not exists.
CONTEXT:  PL/pgSQL function emaj._modify_tables(text,text[],jsonb,text,boolean,boolean) line 91 at RAISE
PL/pgSQL function emaj.emaj_modify_table(text,text,jsonb,text) line 7 at RETURN
-- unknown property
select emaj.emaj_modify_table('myschema1','mytbl1','{"unknown_property":null}'::jsonb);
ERROR:  _modify_tables: properties "{"unknown_property": null}" are unknown.
CONTEXT:  PL/pgSQL function emaj._modify_tables(text,text[],jsonb,text,boolean,boolean) line 98 at RAISE
PL/pgSQL function emaj.emaj_modify_table(text,text,jsonb,text) line 7 at RETURN
-- bad mark
select emaj.emaj_modify_table('myschema1','mytbl1',null,'EMAJ_LAST_MARK');
ERROR:  _check_new_mark: "EMAJ_LAST_MARK" is not an allowed name for a new mark.
CONTEXT:  PL/pgSQL function emaj._check_new_mark(text[],text) line 14 at RAISE
SQL statement "SELECT emaj._check_new_mark(v_loggingGroups, v_mark)"
PL/pgSQL function emaj._modify_tables(text,text[],jsonb,text,boolean,boolean) line 120 at SQL statement
PL/pgSQL function emaj.emaj_modify_table(text,text,jsonb,text) line 7 at RETURN
-- ok
-- change a priority
select emaj.emaj_modify_table('myschema1','mytbl2','{"priority":1}');
 emaj_modify_table 
-------------------
                 1
(1 row)

-- change a log data tablespace
select emaj.emaj_modify_table('myschema1','mytbl1','{"log_data_tablespace":"tsp log''2"}');
 emaj_modify_table 
-------------------
                 1
(1 row)

-- change a log index tablespace
select emaj.emaj_modify_table('myschema1','mytbl1','{"log_index_tablespace":"tsp log''2"}');
 emaj_modify_table 
-------------------
                 1
(1 row)

select rel_schema, rel_tblseq, rel_time_range, rel_priority from emaj.emaj_relation
  where rel_schema = 'myschema1' and rel_tblseq = 'mytbl2' order by 3 desc ,1,2 limit 2;
 rel_schema | rel_tblseq | rel_time_range | rel_priority 
------------+------------+----------------+--------------
 myschema1  | mytbl2     | [8204,)        |            1
 myschema1  | mytbl2     | [8202,8204)    |             
(2 rows)

select rel_schema, rel_tblseq, rel_time_range, rel_log_dat_tsp, rel_log_idx_tsp from emaj.emaj_relation
  where rel_schema = 'myschema1' and rel_tblseq = 'mytbl1' order by 3 desc ,1,2 limit 2;
 rel_schema | rel_tblseq | rel_time_range | rel_log_dat_tsp | rel_log_idx_tsp 
------------+------------+----------------+-----------------+-----------------
 myschema1  | mytbl1     | [8203,)        | tsp log'2       | tsp log'2
 myschema1  | mytbl1     | [8201,8203)    |                 | 
(2 rows)

-- revert changes
select emaj.emaj_modify_table('myschema1','mytbl2','{"priority":null}');
 emaj_modify_table 
-------------------
                 1
(1 row)

select emaj.emaj_modify_table('myschema1','mytbl1','{"log_data_tablespace":null, "log_index_tablespace":null}');
 emaj_modify_table 
-------------------
                 1
(1 row)

select rel_schema, rel_tblseq, rel_time_range, rel_priority from emaj.emaj_relation
  where rel_schema = 'myschema1' and rel_tblseq = 'mytbl2' order by 3 desc ,1,2 limit 2;
 rel_schema | rel_tblseq | rel_time_range | rel_priority 
------------+------------+----------------+--------------
 myschema1  | mytbl2     | [8204,)        |             
 myschema1  | mytbl2     | [8202,8204)    |             
(2 rows)

select rel_schema, rel_tblseq, rel_time_range, rel_log_dat_tsp, rel_log_idx_tsp from emaj.emaj_relation
  where rel_schema = 'myschema1' and rel_tblseq = 'mytbl1' order by 3 desc ,1,2 limit 2;
 rel_schema | rel_tblseq | rel_time_range | rel_log_dat_tsp | rel_log_idx_tsp 
------------+------------+----------------+-----------------+-----------------
 myschema1  | mytbl1     | [8203,)        |                 | 
 myschema1  | mytbl1     | [8201,8203)    |                 | 
(2 rows)

-------------------------------------
---- emaj_modify_tables with array
-------------------------------------
-- error cases
-- table not in a group
select emaj.emaj_modify_tables('myschema2',array['dummyTable','mytbl1','mytbl2'],null);
ERROR:  _modify_tables: some tables (myschema2."dummyTable") do not currently belong to any tables group.
CONTEXT:  PL/pgSQL function emaj._modify_tables(text,text[],jsonb,text,boolean,boolean) line 57 at RAISE
PL/pgSQL function emaj.emaj_modify_tables(text,text[],jsonb,text) line 7 at RETURN
-- empty tables array
select emaj.emaj_modify_tables('myschema2',array[]::text[],null);
WARNING:  _modified_tables: No table to process.
 emaj_modify_tables 
--------------------
                  0
(1 row)

select emaj.emaj_modify_tables('myschema2',null,null);
WARNING:  _modified_tables: No table to process.
 emaj_modify_tables 
--------------------
                  0
(1 row)

select emaj.emaj_modify_tables('myschema2',array[''],null);
WARNING:  _modified_tables: No table to process.
 emaj_modify_tables 
--------------------
                  0
(1 row)

---- ok (with a duplicate table name)
select emaj.emaj_modify_tables('myschema2',array['mytbl1','mytbl2','mytbl2'],'{"priority":10,"log_data_tablespace":"tsplog1"}');
 emaj_modify_tables 
--------------------
                  2
(1 row)

select rel_schema, rel_tblseq, rel_time_range, rel_priority, rel_log_dat_tsp from emaj.emaj_relation
  where rel_schema = 'myschema2' and rel_tblseq in ('mytbl1','mytbl2') order by 1,2,3;
 rel_schema | rel_tblseq | rel_time_range | rel_priority | rel_log_dat_tsp 
------------+------------+----------------+--------------+-----------------
 myschema2  | mytbl1     | [8008,)        |           10 | tsplog1
 myschema2  | mytbl2     | [8008,)        |           10 | tsplog1
(2 rows)

-----------------------------------
-- emaj_modify_tables with filters
-----------------------------------
-- empty tables array
select emaj.emaj_modify_tables('myschema2',null,null,null::jsonb);
WARNING:  _modified_tables: No table to process.
 emaj_modify_tables 
--------------------
                  0
(1 row)

select emaj.emaj_modify_tables('myschema2','','',null::jsonb);
WARNING:  _modified_tables: No table to process.
 emaj_modify_tables 
--------------------
                  0
(1 row)

select emaj.emaj_modify_tables('myschema2','mytbl1','mytbl1',null::jsonb);
WARNING:  _modified_tables: No table to process.
 emaj_modify_tables 
--------------------
                  0
(1 row)

-- ok and revert the previous changes
select emaj.emaj_modify_tables('myschema2','mytbl.*','','{"priority":null,"log_data_tablespace":null}'::jsonb);
 emaj_modify_tables 
--------------------
                  2
(1 row)

select rel_schema, rel_tblseq, rel_time_range, rel_priority, rel_log_dat_tsp, rel_log_idx_tsp from emaj.emaj_relation
  where rel_schema = 'myschema2' and rel_tblseq like 'mytbl%' order by 1,2,3;
 rel_schema | rel_tblseq | rel_time_range | rel_priority | rel_log_dat_tsp | rel_log_idx_tsp 
------------+------------+----------------+--------------+-----------------+-----------------
 myschema2  | mytbl1     | [8008,)        |              |                 | 
 myschema2  | mytbl2     | [8008,)        |              |                 | 
 myschema2  | mytbl4     | [8008,)        |              |                 | 
 myschema2  | mytbl5     | [8008,)        |              |                 | 
 myschema2  | mytbl6     | [8008,)        |              |                 | 
 myschema2  | mytbl7     | [8008,)        |              |                 | 
 myschema2  | mytbl8     | [8008,)        |              |                 | 
(7 rows)

select altr_time_id, altr_step, altr_schema, altr_tblseq, altr_group, altr_priority, altr_group_is_logging,
       altr_new_group, altr_new_group_is_logging from emaj.emaj_alter_plan
  order by 1 desc, 2,3,4 limit 14;
 altr_time_id |        altr_step         | altr_schema | altr_tblseq | altr_group | altr_priority | altr_group_is_logging | altr_new_group | altr_new_group_is_logging 
--------------+--------------------------+-------------+-------------+------------+---------------+-----------------------+----------------+---------------------------
         8406 | CHANGE_TBL_LOG_DATA_TSP  | myschema2   | mytbl1      | myGroup2   |               | f                     |                | 
         8406 | CHANGE_TBL_LOG_DATA_TSP  | myschema2   | mytbl2      | myGroup2   |               | f                     |                | 
         8406 | CHANGE_REL_PRIORITY      | myschema2   | mytbl1      | myGroup2   |               | f                     |                | 
         8406 | CHANGE_REL_PRIORITY      | myschema2   | mytbl2      | myGroup2   |               | f                     |                | 
         8405 | CHANGE_TBL_LOG_DATA_TSP  | myschema2   | mytbl1      | myGroup2   |               | f                     |                | 
         8405 | CHANGE_TBL_LOG_DATA_TSP  | myschema2   | mytbl2      | myGroup2   |               | f                     |                | 
         8405 | CHANGE_REL_PRIORITY      | myschema2   | mytbl1      | myGroup2   |            10 | f                     |                | 
         8405 | CHANGE_REL_PRIORITY      | myschema2   | mytbl2      | myGroup2   |            10 | f                     |                | 
         8404 | CHANGE_TBL_LOG_DATA_TSP  | myschema1   | mytbl1      | myGroup1   |               | f                     |                | 
         8404 | CHANGE_TBL_LOG_INDEX_TSP | myschema1   | mytbl1      | myGroup1   |               | f                     |                | 
         8403 | CHANGE_REL_PRIORITY      | myschema1   | mytbl2      | myGroup1   |               | f                     |                | 
         8402 | CHANGE_TBL_LOG_INDEX_TSP | myschema1   | mytbl1      | myGroup1   |               | f                     |                | 
         8401 | CHANGE_TBL_LOG_DATA_TSP  | myschema1   | mytbl1      | myGroup1   |               | f                     |                | 
         8400 | CHANGE_REL_PRIORITY      | myschema1   | mytbl2      | myGroup1   |             1 | f                     |                | 
(14 rows)

-- check for emaj_modify_table() functions family
select * from emaj.emaj_alter_plan where altr_time_id > 8400 order by 1,2,3,4,5;
 altr_time_id |        altr_step         | altr_schema | altr_tblseq | altr_group | altr_priority | altr_group_is_logging | altr_new_group | altr_new_group_is_logging | altr_rlbk_id 
--------------+--------------------------+-------------+-------------+------------+---------------+-----------------------+----------------+---------------------------+--------------
         8401 | CHANGE_TBL_LOG_DATA_TSP  | myschema1   | mytbl1      | myGroup1   |               | f                     |                |                           |             
         8402 | CHANGE_TBL_LOG_INDEX_TSP | myschema1   | mytbl1      | myGroup1   |               | f                     |                |                           |             
         8403 | CHANGE_REL_PRIORITY      | myschema1   | mytbl2      | myGroup1   |               | f                     |                |                           |             
         8404 | CHANGE_TBL_LOG_DATA_TSP  | myschema1   | mytbl1      | myGroup1   |               | f                     |                |                           |             
         8404 | CHANGE_TBL_LOG_INDEX_TSP | myschema1   | mytbl1      | myGroup1   |               | f                     |                |                           |             
         8405 | CHANGE_TBL_LOG_DATA_TSP  | myschema2   | mytbl1      | myGroup2   |               | f                     |                |                           |             
         8405 | CHANGE_TBL_LOG_DATA_TSP  | myschema2   | mytbl2      | myGroup2   |               | f                     |                |                           |             
         8405 | CHANGE_REL_PRIORITY      | myschema2   | mytbl1      | myGroup2   |            10 | f                     |                |                           |             
         8405 | CHANGE_REL_PRIORITY      | myschema2   | mytbl2      | myGroup2   |            10 | f                     |                |                           |             
         8406 | CHANGE_TBL_LOG_DATA_TSP  | myschema2   | mytbl1      | myGroup2   |               | f                     |                |                           |             
         8406 | CHANGE_TBL_LOG_DATA_TSP  | myschema2   | mytbl2      | myGroup2   |               | f                     |                |                           |             
         8406 | CHANGE_REL_PRIORITY      | myschema2   | mytbl1      | myGroup2   |               | f                     |                |                           |             
         8406 | CHANGE_REL_PRIORITY      | myschema2   | mytbl2      | myGroup2   |               | f                     |                |                           |             
(13 rows)

select time_id, time_last_emaj_gid, time_event from emaj.emaj_time_stamp where time_id > 8400 order by time_id;
 time_id | time_last_emaj_gid | time_event 
---------+--------------------+------------
    8401 |            8400000 | A
    8402 |            8400000 | A
    8403 |            8400000 | A
    8404 |            8400000 | A
    8405 |            8400000 | A
    8406 |            8400000 | A
(6 rows)

select hist_function, hist_event, hist_object,
       regexp_replace(regexp_replace(regexp_replace(hist_wording,
            E'\\d\\d\.\\d\\d\\.\\d\\d\\.\\d\\d\\d\\d','%','g'),
            E'\\d\\d\\d\\d/\\d\\d\\/\\d\\d\\ \\d\\d\\:\\d\\d:\\d\\d .*?\\)','<timestamp>)','g'),
            E'\\[.+\\]','(timestamp)','g'), 
       hist_user 
  from emaj.emaj_hist where hist_id > 8400 order by hist_id;
 hist_function |          hist_event          |   hist_object    |         regexp_replace          | hist_user 
---------------+------------------------------+------------------+---------------------------------+-----------
 MODIFY_TABLE  | BEGIN                        |                  |                                 | postgres
 MODIFY_TABLE  | PRIORITY CHANGED             | myschema1.mytbl2 | NULL => 1                       | postgres
 MODIFY_TABLE  | END                          |                  | 1 tables effectively modified   | postgres
 MODIFY_TABLE  | BEGIN                        |                  |                                 | postgres
 MODIFY_TABLE  | LOG DATA TABLESPACE CHANGED  | myschema1.mytbl1 | Default tablespace => tsp log'2 | postgres
 MODIFY_TABLE  | END                          |                  | 1 tables effectively modified   | postgres
 MODIFY_TABLE  | BEGIN                        |                  |                                 | postgres
 MODIFY_TABLE  | LOG INDEX TABLESPACE CHANGED | myschema1.mytbl1 | Default tablespace => tsp log'2 | postgres
 MODIFY_TABLE  | END                          |                  | 1 tables effectively modified   | postgres
 MODIFY_TABLE  | BEGIN                        |                  |                                 | postgres
 MODIFY_TABLE  | PRIORITY CHANGED             | myschema1.mytbl2 | 1 => NULL                       | postgres
 MODIFY_TABLE  | END                          |                  | 1 tables effectively modified   | postgres
 MODIFY_TABLE  | BEGIN                        |                  |                                 | postgres
 MODIFY_TABLE  | LOG DATA TABLESPACE CHANGED  | myschema1.mytbl1 | tsp log'2 => Default tablespace | postgres
 MODIFY_TABLE  | LOG INDEX TABLESPACE CHANGED | myschema1.mytbl1 | tsp log'2 => Default tablespace | postgres
 MODIFY_TABLE  | END                          |                  | 1 tables effectively modified   | postgres
 MODIFY_TABLES | BEGIN                        |                  |                                 | postgres
 MODIFY_TABLES | END                          |                  | 0 tables effectively modified   | postgres
 MODIFY_TABLES | BEGIN                        |                  |                                 | postgres
 MODIFY_TABLES | END                          |                  | 0 tables effectively modified   | postgres
 MODIFY_TABLES | BEGIN                        |                  |                                 | postgres
 MODIFY_TABLES | END                          |                  | 0 tables effectively modified   | postgres
 MODIFY_TABLES | BEGIN                        |                  |                                 | postgres
 MODIFY_TABLES | PRIORITY CHANGED             | myschema2.mytbl1 | NULL => 1                       | postgres
 MODIFY_TABLES | LOG DATA TABLESPACE CHANGED  | myschema2.mytbl1 | Default tablespace => tsplog1   | postgres
 MODIFY_TABLES | PRIORITY CHANGED             | myschema2.mytbl2 | NULL => 1                       | postgres
 MODIFY_TABLES | LOG DATA TABLESPACE CHANGED  | myschema2.mytbl2 | Default tablespace => tsplog1   | postgres
 MODIFY_TABLES | END                          |                  | 2 tables effectively modified   | postgres
 MODIFY_TABLES | BEGIN                        |                  |                                 | postgres
 MODIFY_TABLES | END                          |                  | 0 tables effectively modified   | postgres
 MODIFY_TABLES | BEGIN                        |                  |                                 | postgres
 MODIFY_TABLES | END                          |                  | 0 tables effectively modified   | postgres
 MODIFY_TABLES | BEGIN                        |                  |                                 | postgres
 MODIFY_TABLES | END                          |                  | 0 tables effectively modified   | postgres
 MODIFY_TABLES | BEGIN                        |                  |                                 | postgres
 MODIFY_TABLES | PRIORITY CHANGED             | myschema2.mytbl1 | 1 => NULL                       | postgres
 MODIFY_TABLES | LOG DATA TABLESPACE CHANGED  | myschema2.mytbl1 | tsplog1 => Default tablespace   | postgres
 MODIFY_TABLES | PRIORITY CHANGED             | myschema2.mytbl2 | 1 => NULL                       | postgres
 MODIFY_TABLES | LOG DATA TABLESPACE CHANGED  | myschema2.mytbl2 | tsplog1 => Default tablespace   | postgres
 MODIFY_TABLES | END                          |                  | 2 tables effectively modified   | postgres
(40 rows)

-- remove the temp directory
\! rm -R $EMAJTESTTMPDIR
