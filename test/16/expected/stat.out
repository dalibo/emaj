-- stat.sql : test statistics functions
--   emaj_log_stat_group(), emaj_log_stat_groups()
--   emaj_detailled_log_stat_group() and emaj_detailled_log_stat_groups(),
--   emaj_sequence_stat_group() and emaj_sequence_stat_groups()
--   _get_sequences_last_value()
--
-- set sequence restart value
select public.handle_emaj_sequences(5000);
 handle_emaj_sequences 
-----------------------
 
(1 row)

-----------------------------
-- log updates on myschema2 between 3 mono-group and multi-groups marks
-----------------------------
set search_path=public,myschema2;
-- set a multi-groups mark
select emaj.emaj_set_mark_groups(array['myGroup1','myGroup2'],'Multi-1');
 emaj_set_mark_groups 
----------------------
                   17
(1 row)

-- inserts/updates/deletes in myTbl1, myTbl2 and myTbl2b (via trigger) and increment myseq1
insert into myTbl1 select i, 'ABC', E'\\014'::bytea from generate_series (1,10100) as i;
update myTbl1 set col13=E'\\034'::bytea where col11 <= 500;
delete from myTbl1 where col11 > 10000;
insert into myTbl2 select i, 'DEF', current_date from generate_series (1,900) as i;
select nextval('myschema2.myseq1');
 nextval 
---------
    1000
(1 row)

select nextval('myschema2.myseq1');
 nextval 
---------
    1001
(1 row)

-- set marks
select emaj.emaj_set_mark_group('myGroup2','Mark22');
 emaj_set_mark_group 
---------------------
                  10
(1 row)

select emaj.emaj_set_mark_groups(array['myGroup1','myGroup2'],'Multi-2');
 emaj_set_mark_groups 
----------------------
                   17
(1 row)

-- inserts/updates/deletes in myTbl3 and myTbl4and increment and alter myseq1
insert into "myTbl3" (col33) select generate_series(1000,1039,4)/100;
insert into myTbl4 select i,'FK...',i,1,'ABC' from generate_series (1,100) as i;
select nextval('myschema2.myseq1');
 nextval 
---------
    1002
(1 row)

alter sequence myschema2.myseq1 MAXVALUE 10000;
-- set marks
select emaj.emaj_set_mark_group('myGroup2','Mark23');
 emaj_set_mark_group 
---------------------
                  10
(1 row)

select emaj.emaj_set_mark_groups(array['myGroup1','myGroup2'],'Multi-3');
 emaj_set_mark_groups 
----------------------
                   17
(1 row)

-- reset the sequence alter
alter sequence myschema2.myseq1 MAXVALUE 2000;
-----------------------------
-- emaj_log_stat_group(), emaj_log_stat_groups(), emaj_detailled_log_stat_group() and emaj_detailled_log_stat_groups() test
-----------------------------
-- group is unknown
select * from emaj.emaj_log_stat_group(null,null,null);
ERROR:  _check_group_names: No group to process.
CONTEXT:  PL/pgSQL function emaj._check_group_names(text[],boolean,boolean,boolean,boolean,boolean,boolean) line 27 at RAISE
SQL statement "SELECT emaj._check_group_names(p_groupNames := p_groupNames, p_mayBeNull := p_multiGroup, p_lockGroups := FALSE)"
PL/pgSQL function emaj._log_stat_groups(text[],boolean,text,text) line 19 at SQL statement
SQL statement "SELECT stat_group, stat_schema, stat_table, stat_first_mark, stat_first_mark_datetime, stat_first_time_id,
             stat_last_mark, stat_last_mark_datetime, stat_last_time_id, stat_rows
        FROM emaj._log_stat_groups(ARRAY[p_groupName], FALSE, p_firstMark, p_lastMark)"
PL/pgSQL function emaj.emaj_log_stat_group(text,text,text) line 7 at RETURN QUERY
select * from emaj.emaj_log_stat_groups(array['unknownGroup'],null,null);
ERROR:  _check_group_names: The group "unknownGroup" does not exist.
CONTEXT:  PL/pgSQL function emaj._check_group_names(text[],boolean,boolean,boolean,boolean,boolean,boolean) line 39 at RAISE
SQL statement "SELECT emaj._check_group_names(p_groupNames := p_groupNames, p_mayBeNull := p_multiGroup, p_lockGroups := FALSE)"
PL/pgSQL function emaj._log_stat_groups(text[],boolean,text,text) line 19 at SQL statement
SQL statement "SELECT stat_group, stat_schema, stat_table, stat_first_mark, stat_first_mark_datetime, stat_first_time_id,
             stat_last_mark, stat_last_mark_datetime, stat_last_time_id, stat_rows
        FROM emaj._log_stat_groups(p_groupNames, TRUE, p_firstMark, p_lastMark)"
PL/pgSQL function emaj.emaj_log_stat_groups(text[],text,text) line 7 at RETURN QUERY
select * from emaj.emaj_detailed_log_stat_group(null,null,null);
ERROR:  _check_group_names: No group to process.
CONTEXT:  PL/pgSQL function emaj._check_group_names(text[],boolean,boolean,boolean,boolean,boolean,boolean) line 27 at RAISE
SQL statement "SELECT emaj._check_group_names(p_groupNames := p_groupNames, p_mayBeNull := p_multiGroup, p_lockGroups := FALSE)"
PL/pgSQL function emaj._detailed_log_stat_groups(text[],boolean,text,text) line 31 at PERFORM
SQL statement "SELECT stat_group, stat_schema, stat_table, stat_first_mark, stat_first_mark_datetime, stat_first_time_id,
             stat_last_mark, stat_last_mark_datetime, stat_last_time_id, stat_role, stat_verb, stat_rows
        FROM emaj._detailed_log_stat_groups(ARRAY[p_groupName], FALSE, p_firstMark, p_lastMark)"
PL/pgSQL function emaj.emaj_detailed_log_stat_group(text,text,text) line 8 at RETURN QUERY
select * from emaj.emaj_detailed_log_stat_groups(array['unknownGroup'],null,null);
ERROR:  _check_group_names: The group "unknownGroup" does not exist.
CONTEXT:  PL/pgSQL function emaj._check_group_names(text[],boolean,boolean,boolean,boolean,boolean,boolean) line 39 at RAISE
SQL statement "SELECT emaj._check_group_names(p_groupNames := p_groupNames, p_mayBeNull := p_multiGroup, p_lockGroups := FALSE)"
PL/pgSQL function emaj._detailed_log_stat_groups(text[],boolean,text,text) line 31 at PERFORM
SQL statement "SELECT stat_group, stat_schema, stat_table, stat_first_mark, stat_first_mark_datetime, stat_first_time_id,
             stat_last_mark, stat_last_mark_datetime, stat_last_time_id, stat_role, stat_verb, stat_rows
        FROM emaj._detailed_log_stat_groups(p_groupNames, TRUE, p_firstMark, p_lastMark)"
PL/pgSQL function emaj.emaj_detailed_log_stat_groups(text[],text,text) line 8 at RETURN QUERY
-- invalid marks
select * from emaj.emaj_log_stat_group('myGroup2',null,null);
ERROR:  _check_marks_range: The first mark cannot be NULL or empty.
CONTEXT:  PL/pgSQL function emaj._check_marks_range(text[],text,text,boolean,boolean) line 16 at RAISE
SQL statement "SELECT checked.p_firstMark, checked.p_lastMark, p_firstMarkTimeId, p_lastMarkTimeId, p_firstMarkTs, p_lastMarkTs
                                                                                                               FROM emaj._check_marks_range(p_groupNames := p_groupNames, p_firstMark := p_firstMark, p_lastMark := p_lastMark) checked"
PL/pgSQL function emaj._log_stat_groups(text[],boolean,text,text) line 23 at SQL statement
SQL statement "SELECT stat_group, stat_schema, stat_table, stat_first_mark, stat_first_mark_datetime, stat_first_time_id,
             stat_last_mark, stat_last_mark_datetime, stat_last_time_id, stat_rows
        FROM emaj._log_stat_groups(ARRAY[p_groupName], FALSE, p_firstMark, p_lastMark)"
PL/pgSQL function emaj.emaj_log_stat_group(text,text,text) line 7 at RETURN QUERY
select * from emaj.emaj_log_stat_group('myGroup2','',null);
ERROR:  _check_marks_range: The first mark cannot be NULL or empty.
CONTEXT:  PL/pgSQL function emaj._check_marks_range(text[],text,text,boolean,boolean) line 16 at RAISE
SQL statement "SELECT checked.p_firstMark, checked.p_lastMark, p_firstMarkTimeId, p_lastMarkTimeId, p_firstMarkTs, p_lastMarkTs
                                                                                                               FROM emaj._check_marks_range(p_groupNames := p_groupNames, p_firstMark := p_firstMark, p_lastMark := p_lastMark) checked"
PL/pgSQL function emaj._log_stat_groups(text[],boolean,text,text) line 23 at SQL statement
SQL statement "SELECT stat_group, stat_schema, stat_table, stat_first_mark, stat_first_mark_datetime, stat_first_time_id,
             stat_last_mark, stat_last_mark_datetime, stat_last_time_id, stat_rows
        FROM emaj._log_stat_groups(ARRAY[p_groupName], FALSE, p_firstMark, p_lastMark)"
PL/pgSQL function emaj.emaj_log_stat_group(text,text,text) line 7 at RETURN QUERY
select * from emaj.emaj_log_stat_group('myGroup2','dummyStartMark',null);
ERROR:  _check_mark_name: The mark "dummyStartMark" does not exist for the group "myGroup2".
CONTEXT:  PL/pgSQL function emaj._check_mark_name(text[],text,boolean) line 61 at RAISE
SQL statement "SELECT emaj._check_mark_name(p_groupNames := p_groupNames, p_mark := p_firstMark)"
PL/pgSQL function emaj._check_marks_range(text[],text,text,boolean,boolean) line 19 at SQL statement
SQL statement "SELECT checked.p_firstMark, checked.p_lastMark, p_firstMarkTimeId, p_lastMarkTimeId, p_firstMarkTs, p_lastMarkTs
                                                                                                               FROM emaj._check_marks_range(p_groupNames := p_groupNames, p_firstMark := p_firstMark, p_lastMark := p_lastMark) checked"
PL/pgSQL function emaj._log_stat_groups(text[],boolean,text,text) line 23 at SQL statement
SQL statement "SELECT stat_group, stat_schema, stat_table, stat_first_mark, stat_first_mark_datetime, stat_first_time_id,
             stat_last_mark, stat_last_mark_datetime, stat_last_time_id, stat_rows
        FROM emaj._log_stat_groups(ARRAY[p_groupName], FALSE, p_firstMark, p_lastMark)"
PL/pgSQL function emaj.emaj_log_stat_group(text,text,text) line 7 at RETURN QUERY
select * from emaj.emaj_log_stat_group('myGroup2','Mark22','dummyEndMark');
ERROR:  _check_mark_name: The mark "dummyEndMark" does not exist for the group "myGroup2".
CONTEXT:  PL/pgSQL function emaj._check_mark_name(text[],text,boolean) line 61 at RAISE
SQL statement "SELECT emaj._check_mark_name(p_groupNames := p_groupNames, p_mark := p_lastMark)"
PL/pgSQL function emaj._check_marks_range(text[],text,text,boolean,boolean) line 33 at SQL statement
SQL statement "SELECT checked.p_firstMark, checked.p_lastMark, p_firstMarkTimeId, p_lastMarkTimeId, p_firstMarkTs, p_lastMarkTs
                                                                                                               FROM emaj._check_marks_range(p_groupNames := p_groupNames, p_firstMark := p_firstMark, p_lastMark := p_lastMark) checked"
PL/pgSQL function emaj._log_stat_groups(text[],boolean,text,text) line 23 at SQL statement
SQL statement "SELECT stat_group, stat_schema, stat_table, stat_first_mark, stat_first_mark_datetime, stat_first_time_id,
             stat_last_mark, stat_last_mark_datetime, stat_last_time_id, stat_rows
        FROM emaj._log_stat_groups(ARRAY[p_groupName], FALSE, p_firstMark, p_lastMark)"
PL/pgSQL function emaj.emaj_log_stat_group(text,text,text) line 7 at RETURN QUERY
select * from emaj.emaj_detailed_log_stat_group('myGroup2','dummyStartMark',null);
ERROR:  _check_mark_name: The mark "dummyStartMark" does not exist for the group "myGroup2".
CONTEXT:  PL/pgSQL function emaj._check_mark_name(text[],text,boolean) line 61 at RAISE
SQL statement "SELECT emaj._check_mark_name(p_groupNames := p_groupNames, p_mark := p_firstMark)"
PL/pgSQL function emaj._check_marks_range(text[],text,text,boolean,boolean) line 19 at SQL statement
SQL statement "SELECT *
                                                                                                                                              FROM emaj._check_marks_range(p_groupNames := p_groupNames, p_firstMark := p_firstMark, p_lastMark := p_lastMark)"
PL/pgSQL function emaj._detailed_log_stat_groups(text[],boolean,text,text) line 34 at SQL statement
SQL statement "SELECT stat_group, stat_schema, stat_table, stat_first_mark, stat_first_mark_datetime, stat_first_time_id,
             stat_last_mark, stat_last_mark_datetime, stat_last_time_id, stat_role, stat_verb, stat_rows
        FROM emaj._detailed_log_stat_groups(ARRAY[p_groupName], FALSE, p_firstMark, p_lastMark)"
PL/pgSQL function emaj.emaj_detailed_log_stat_group(text,text,text) line 8 at RETURN QUERY
select * from emaj.emaj_detailed_log_stat_group('myGroup2','Mark22','dummyEndMark');
ERROR:  _check_mark_name: The mark "dummyEndMark" does not exist for the group "myGroup2".
CONTEXT:  PL/pgSQL function emaj._check_mark_name(text[],text,boolean) line 61 at RAISE
SQL statement "SELECT emaj._check_mark_name(p_groupNames := p_groupNames, p_mark := p_lastMark)"
PL/pgSQL function emaj._check_marks_range(text[],text,text,boolean,boolean) line 33 at SQL statement
SQL statement "SELECT *
                                                                                                                                              FROM emaj._check_marks_range(p_groupNames := p_groupNames, p_firstMark := p_firstMark, p_lastMark := p_lastMark)"
PL/pgSQL function emaj._detailed_log_stat_groups(text[],boolean,text,text) line 34 at SQL statement
SQL statement "SELECT stat_group, stat_schema, stat_table, stat_first_mark, stat_first_mark_datetime, stat_first_time_id,
             stat_last_mark, stat_last_mark_datetime, stat_last_time_id, stat_role, stat_verb, stat_rows
        FROM emaj._detailed_log_stat_groups(ARRAY[p_groupName], FALSE, p_firstMark, p_lastMark)"
PL/pgSQL function emaj.emaj_detailed_log_stat_group(text,text,text) line 8 at RETURN QUERY
select * from emaj.emaj_log_stat_groups(array['myGroup1','myGroup2'],null,null);
ERROR:  _check_marks_range: The first mark cannot be NULL or empty.
CONTEXT:  PL/pgSQL function emaj._check_marks_range(text[],text,text,boolean,boolean) line 16 at RAISE
SQL statement "SELECT checked.p_firstMark, checked.p_lastMark, p_firstMarkTimeId, p_lastMarkTimeId, p_firstMarkTs, p_lastMarkTs
                                                                                                               FROM emaj._check_marks_range(p_groupNames := p_groupNames, p_firstMark := p_firstMark, p_lastMark := p_lastMark) checked"
PL/pgSQL function emaj._log_stat_groups(text[],boolean,text,text) line 23 at SQL statement
SQL statement "SELECT stat_group, stat_schema, stat_table, stat_first_mark, stat_first_mark_datetime, stat_first_time_id,
             stat_last_mark, stat_last_mark_datetime, stat_last_time_id, stat_rows
        FROM emaj._log_stat_groups(p_groupNames, TRUE, p_firstMark, p_lastMark)"
PL/pgSQL function emaj.emaj_log_stat_groups(text[],text,text) line 7 at RETURN QUERY
select * from emaj.emaj_log_stat_groups(array['myGroup1','myGroup2'],'Multi-1','dummyEndMark');
ERROR:  _check_mark_name: The mark "dummyEndMark" does not exist for the groups "myGroup1, myGroup2".
CONTEXT:  PL/pgSQL function emaj._check_mark_name(text[],text,boolean) line 63 at RAISE
SQL statement "SELECT emaj._check_mark_name(p_groupNames := p_groupNames, p_mark := p_lastMark)"
PL/pgSQL function emaj._check_marks_range(text[],text,text,boolean,boolean) line 33 at SQL statement
SQL statement "SELECT checked.p_firstMark, checked.p_lastMark, p_firstMarkTimeId, p_lastMarkTimeId, p_firstMarkTs, p_lastMarkTs
                                                                                                               FROM emaj._check_marks_range(p_groupNames := p_groupNames, p_firstMark := p_firstMark, p_lastMark := p_lastMark) checked"
PL/pgSQL function emaj._log_stat_groups(text[],boolean,text,text) line 23 at SQL statement
SQL statement "SELECT stat_group, stat_schema, stat_table, stat_first_mark, stat_first_mark_datetime, stat_first_time_id,
             stat_last_mark, stat_last_mark_datetime, stat_last_time_id, stat_rows
        FROM emaj._log_stat_groups(p_groupNames, TRUE, p_firstMark, p_lastMark)"
PL/pgSQL function emaj.emaj_log_stat_groups(text[],text,text) line 7 at RETURN QUERY
select * from emaj.emaj_detailed_log_stat_groups(array['myGroup1','myGroup2'],null,null);
ERROR:  _check_marks_range: The first mark cannot be NULL or empty.
CONTEXT:  PL/pgSQL function emaj._check_marks_range(text[],text,text,boolean,boolean) line 16 at RAISE
SQL statement "SELECT *
                                                                                                                                              FROM emaj._check_marks_range(p_groupNames := p_groupNames, p_firstMark := p_firstMark, p_lastMark := p_lastMark)"
PL/pgSQL function emaj._detailed_log_stat_groups(text[],boolean,text,text) line 34 at SQL statement
SQL statement "SELECT stat_group, stat_schema, stat_table, stat_first_mark, stat_first_mark_datetime, stat_first_time_id,
             stat_last_mark, stat_last_mark_datetime, stat_last_time_id, stat_role, stat_verb, stat_rows
        FROM emaj._detailed_log_stat_groups(p_groupNames, TRUE, p_firstMark, p_lastMark)"
PL/pgSQL function emaj.emaj_detailed_log_stat_groups(text[],text,text) line 8 at RETURN QUERY
select * from emaj.emaj_detailed_log_stat_groups(array['myGroup1','myGroup2'],'Multi-1','dummyEndMark');
ERROR:  _check_mark_name: The mark "dummyEndMark" does not exist for the groups "myGroup1, myGroup2".
CONTEXT:  PL/pgSQL function emaj._check_mark_name(text[],text,boolean) line 63 at RAISE
SQL statement "SELECT emaj._check_mark_name(p_groupNames := p_groupNames, p_mark := p_lastMark)"
PL/pgSQL function emaj._check_marks_range(text[],text,text,boolean,boolean) line 33 at SQL statement
SQL statement "SELECT *
                                                                                                                                              FROM emaj._check_marks_range(p_groupNames := p_groupNames, p_firstMark := p_firstMark, p_lastMark := p_lastMark)"
PL/pgSQL function emaj._detailed_log_stat_groups(text[],boolean,text,text) line 34 at SQL statement
SQL statement "SELECT stat_group, stat_schema, stat_table, stat_first_mark, stat_first_mark_datetime, stat_first_time_id,
             stat_last_mark, stat_last_mark_datetime, stat_last_time_id, stat_role, stat_verb, stat_rows
        FROM emaj._detailed_log_stat_groups(p_groupNames, TRUE, p_firstMark, p_lastMark)"
PL/pgSQL function emaj.emaj_detailed_log_stat_groups(text[],text,text) line 8 at RETURN QUERY
-- start mark > end mark
-- original test (uncomment for unit test)
--  select * from emaj.emaj_log_stat_group('myGroup2','Mark23','Mark22');
--  select * from emaj.emaj_detailed_log_stat_group('myGroup2','Mark23','Mark22');
-- just check the error is trapped, because the error message contains timestamps
create function test_log(v_groupName TEXT, v_firstMark TEXT, v_lastMark TEXT) returns void language plpgsql as 
$$
begin
  begin
    perform count(*) from emaj.emaj_log_stat_group(v_groupName,v_firstMark,v_lastMark);
    return;
  exception when raise_exception then
    raise notice 'Error trapped on emaj_log_stat_group() call';
  end;
  begin
    perform count(*) from emaj.emaj_detailed_log_stat_group(v_groupName,v_firstMark,v_lastMark);
    return;
  exception when raise_exception then
    raise notice 'Error trapped on emaj_detailed_log_stat_group() call';
  end;
  return;
end;
$$;
select test_log('myGroup2','Mark23','Mark22');
NOTICE:  Error trapped on emaj_log_stat_group() call
NOTICE:  Error trapped on emaj_detailed_log_stat_group() call
 test_log 
----------
 
(1 row)

select test_log('myGroup2','EMAJ_LAST_MARK','Mark22');
NOTICE:  Error trapped on emaj_log_stat_group() call
NOTICE:  Error trapped on emaj_detailed_log_stat_group() call
 test_log 
----------
 
(1 row)

drop function test_log(text,text,text);
-- should be ok
select stat_group, stat_schema, stat_table, stat_first_mark, stat_first_time_id, stat_last_mark, stat_last_time_id, stat_rows
  from emaj.emaj_log_stat_group('myGroup2','Mark21',null)
  order by stat_group, stat_schema, stat_table;
 stat_group | stat_schema | stat_table | stat_first_mark | stat_first_time_id | stat_last_mark | stat_last_time_id | stat_rows 
------------+-------------+------------+-----------------+--------------------+----------------+-------------------+-----------
 myGroup2   | myschema2   | myTbl3     | Mark21          |               4029 |                |                   |        10
 myGroup2   | myschema2   | mytbl1     | Mark21          |               4029 |                |                   |     10700
 myGroup2   | myschema2   | mytbl2     | Mark21          |               4029 |                |                   |       900
 myGroup2   | myschema2   | mytbl4     | Mark21          |               4029 |                |                   |       100
 myGroup2   | myschema2   | mytbl5     | Mark21          |               4029 |                |                   |         0
 myGroup2   | myschema2   | mytbl6     | Mark21          |               4029 |                |                   |         0
 myGroup2   | myschema2   | mytbl7     | Mark21          |               4029 |                |                   |         0
 myGroup2   | myschema2   | mytbl8     | Mark21          |               4029 |                |                   |         0
(8 rows)

select stat_group, stat_schema, stat_table, stat_first_mark, stat_first_time_id, stat_last_mark, stat_last_time_id, stat_rows
  from emaj.emaj_log_stat_group('myGroup2','Mark21','EMAJ_LAST_MARK')
  order by stat_group, stat_schema, stat_table;
 stat_group | stat_schema | stat_table | stat_first_mark | stat_first_time_id | stat_last_mark | stat_last_time_id | stat_rows 
------------+-------------+------------+-----------------+--------------------+----------------+-------------------+-----------
 myGroup2   | myschema2   | myTbl3     | Mark21          |               4029 | Multi-3        |              5004 |        10
 myGroup2   | myschema2   | mytbl1     | Mark21          |               4029 | Multi-3        |              5004 |     10700
 myGroup2   | myschema2   | mytbl2     | Mark21          |               4029 | Multi-3        |              5004 |       900
 myGroup2   | myschema2   | mytbl4     | Mark21          |               4029 | Multi-3        |              5004 |       100
 myGroup2   | myschema2   | mytbl5     | Mark21          |               4029 | Multi-3        |              5004 |         0
 myGroup2   | myschema2   | mytbl6     | Mark21          |               4029 | Multi-3        |              5004 |         0
 myGroup2   | myschema2   | mytbl7     | Mark21          |               4029 | Multi-3        |              5004 |         0
 myGroup2   | myschema2   | mytbl8     | Mark21          |               4029 | Multi-3        |              5004 |         0
(8 rows)

select stat_group, stat_schema, stat_table, stat_first_mark, stat_first_time_id, stat_last_mark, stat_last_time_id, stat_rows
  from emaj.emaj_log_stat_group('myGroup2','Mark22','Mark22')
  order by stat_group, stat_schema, stat_table;
 stat_group | stat_schema | stat_table | stat_first_mark | stat_first_time_id | stat_last_mark | stat_last_time_id | stat_rows 
------------+-------------+------------+-----------------+--------------------+----------------+-------------------+-----------
 myGroup2   | myschema2   | myTbl3     | Mark22          |               5001 | Mark22         |              5001 |         0
 myGroup2   | myschema2   | mytbl1     | Mark22          |               5001 | Mark22         |              5001 |         0
 myGroup2   | myschema2   | mytbl2     | Mark22          |               5001 | Mark22         |              5001 |         0
 myGroup2   | myschema2   | mytbl4     | Mark22          |               5001 | Mark22         |              5001 |         0
 myGroup2   | myschema2   | mytbl5     | Mark22          |               5001 | Mark22         |              5001 |         0
 myGroup2   | myschema2   | mytbl6     | Mark22          |               5001 | Mark22         |              5001 |         0
 myGroup2   | myschema2   | mytbl7     | Mark22          |               5001 | Mark22         |              5001 |         0
 myGroup2   | myschema2   | mytbl8     | Mark22          |               5001 | Mark22         |              5001 |         0
(8 rows)

select stat_group, stat_schema, stat_table, stat_first_mark, stat_first_time_id, stat_last_mark, stat_last_time_id, stat_rows
  from emaj.emaj_log_stat_group('myGroup2','Mark22','Mark23')
  order by stat_group, stat_schema, stat_table;
 stat_group | stat_schema | stat_table | stat_first_mark | stat_first_time_id | stat_last_mark | stat_last_time_id | stat_rows 
------------+-------------+------------+-----------------+--------------------+----------------+-------------------+-----------
 myGroup2   | myschema2   | myTbl3     | Mark22          |               5001 | Mark23         |              5003 |        10
 myGroup2   | myschema2   | mytbl1     | Mark22          |               5001 | Mark23         |              5003 |         0
 myGroup2   | myschema2   | mytbl2     | Mark22          |               5001 | Mark23         |              5003 |         0
 myGroup2   | myschema2   | mytbl4     | Mark22          |               5001 | Mark23         |              5003 |       100
 myGroup2   | myschema2   | mytbl5     | Mark22          |               5001 | Mark23         |              5003 |         0
 myGroup2   | myschema2   | mytbl6     | Mark22          |               5001 | Mark23         |              5003 |         0
 myGroup2   | myschema2   | mytbl7     | Mark22          |               5001 | Mark23         |              5003 |         0
 myGroup2   | myschema2   | mytbl8     | Mark22          |               5001 | Mark23         |              5003 |         0
(8 rows)

select stat_group, stat_schema, stat_table, stat_first_mark, stat_first_time_id, stat_last_mark, stat_last_time_id, stat_rows
  from emaj.emaj_log_stat_group('myGroup2','EMAJ_LAST_MARK','')
  order by stat_group, stat_schema, stat_table;
 stat_group | stat_schema | stat_table | stat_first_mark | stat_first_time_id | stat_last_mark | stat_last_time_id | stat_rows 
------------+-------------+------------+-----------------+--------------------+----------------+-------------------+-----------
 myGroup2   | myschema2   | myTbl3     | Multi-3         |               5004 |                |                   |         0
 myGroup2   | myschema2   | mytbl1     | Multi-3         |               5004 |                |                   |         0
 myGroup2   | myschema2   | mytbl2     | Multi-3         |               5004 |                |                   |         0
 myGroup2   | myschema2   | mytbl4     | Multi-3         |               5004 |                |                   |         0
 myGroup2   | myschema2   | mytbl5     | Multi-3         |               5004 |                |                   |         0
 myGroup2   | myschema2   | mytbl6     | Multi-3         |               5004 |                |                   |         0
 myGroup2   | myschema2   | mytbl7     | Multi-3         |               5004 |                |                   |         0
 myGroup2   | myschema2   | mytbl8     | Multi-3         |               5004 |                |                   |         0
(8 rows)

select stat_group, stat_schema, stat_table, stat_first_mark, stat_first_time_id, stat_last_mark, stat_last_time_id, stat_rows
  from emaj.emaj_log_stat_groups(array['myGroup1','myGroup2'],'Multi-1',null)
  order by stat_group, stat_schema, stat_table;
 stat_group | stat_schema | stat_table | stat_first_mark | stat_first_time_id | stat_last_mark | stat_last_time_id | stat_rows 
------------+-------------+------------+-----------------+--------------------+----------------+-------------------+-----------
 myGroup1   | myschema1   | myTbl3     | Multi-1         |               5000 |                |                   |         0
 myGroup1   | myschema1   | mytbl1     | Multi-1         |               5000 |                |                   |         0
 myGroup1   | myschema1   | mytbl2     | Multi-1         |               5000 |                |                   |         0
 myGroup1   | myschema1   | mytbl2b    | Multi-1         |               5000 |                |                   |         0
 myGroup1   | myschema1   | mytbl4     | Multi-1         |               5000 |                |                   |         0
 myGroup2   | myschema2   | myTbl3     | Multi-1         |               5000 |                |                   |        10
 myGroup2   | myschema2   | mytbl1     | Multi-1         |               5000 |                |                   |     10700
 myGroup2   | myschema2   | mytbl2     | Multi-1         |               5000 |                |                   |       900
 myGroup2   | myschema2   | mytbl4     | Multi-1         |               5000 |                |                   |       100
 myGroup2   | myschema2   | mytbl5     | Multi-1         |               5000 |                |                   |         0
 myGroup2   | myschema2   | mytbl6     | Multi-1         |               5000 |                |                   |         0
 myGroup2   | myschema2   | mytbl7     | Multi-1         |               5000 |                |                   |         0
 myGroup2   | myschema2   | mytbl8     | Multi-1         |               5000 |                |                   |         0
(13 rows)

select stat_group, stat_schema, stat_table, stat_first_mark, stat_first_time_id, stat_last_mark, stat_last_time_id, stat_rows
  from emaj.emaj_log_stat_groups(array['myGroup1','myGroup2'],'Multi-1','Multi-3')
  order by stat_group, stat_schema, stat_table;
 stat_group | stat_schema | stat_table | stat_first_mark | stat_first_time_id | stat_last_mark | stat_last_time_id | stat_rows 
------------+-------------+------------+-----------------+--------------------+----------------+-------------------+-----------
 myGroup1   | myschema1   | myTbl3     | Multi-1         |               5000 | Multi-3        |              5004 |         0
 myGroup1   | myschema1   | mytbl1     | Multi-1         |               5000 | Multi-3        |              5004 |         0
 myGroup1   | myschema1   | mytbl2     | Multi-1         |               5000 | Multi-3        |              5004 |         0
 myGroup1   | myschema1   | mytbl2b    | Multi-1         |               5000 | Multi-3        |              5004 |         0
 myGroup1   | myschema1   | mytbl4     | Multi-1         |               5000 | Multi-3        |              5004 |         0
 myGroup2   | myschema2   | myTbl3     | Multi-1         |               5000 | Multi-3        |              5004 |        10
 myGroup2   | myschema2   | mytbl1     | Multi-1         |               5000 | Multi-3        |              5004 |     10700
 myGroup2   | myschema2   | mytbl2     | Multi-1         |               5000 | Multi-3        |              5004 |       900
 myGroup2   | myschema2   | mytbl4     | Multi-1         |               5000 | Multi-3        |              5004 |       100
 myGroup2   | myschema2   | mytbl5     | Multi-1         |               5000 | Multi-3        |              5004 |         0
 myGroup2   | myschema2   | mytbl6     | Multi-1         |               5000 | Multi-3        |              5004 |         0
 myGroup2   | myschema2   | mytbl7     | Multi-1         |               5000 | Multi-3        |              5004 |         0
 myGroup2   | myschema2   | mytbl8     | Multi-1         |               5000 | Multi-3        |              5004 |         0
(13 rows)

select stat_group, stat_schema, stat_table, stat_first_mark, stat_first_time_id, stat_last_mark, stat_last_time_id, stat_role, stat_verb, stat_rows
  from emaj.emaj_detailed_log_stat_group('myGroup2','Mark21',null)
  order by stat_group, stat_schema, stat_table;
 stat_group | stat_schema | stat_table | stat_first_mark | stat_first_time_id | stat_last_mark | stat_last_time_id | stat_role | stat_verb | stat_rows 
------------+-------------+------------+-----------------+--------------------+----------------+-------------------+-----------+-----------+-----------
 myGroup2   | myschema2   | myTbl3     | Mark21          |               4029 |                |                   | postgres  | INSERT    |        10
 myGroup2   | myschema2   | mytbl1     | Mark21          |               4029 |                |                   | postgres  | DELETE    |       100
 myGroup2   | myschema2   | mytbl1     | Mark21          |               4029 |                |                   | postgres  | INSERT    |     10100
 myGroup2   | myschema2   | mytbl1     | Mark21          |               4029 |                |                   | postgres  | UPDATE    |       500
 myGroup2   | myschema2   | mytbl2     | Mark21          |               4029 |                |                   | postgres  | INSERT    |       900
 myGroup2   | myschema2   | mytbl4     | Mark21          |               4029 |                |                   | postgres  | INSERT    |       100
(6 rows)

select stat_group, stat_schema, stat_table, stat_first_mark, stat_first_time_id, stat_last_mark, stat_last_time_id, stat_role, stat_verb, stat_rows
  from emaj.emaj_detailed_log_stat_group('myGroup2','Mark21','EMAJ_LAST_MARK')
  order by stat_group, stat_schema, stat_table;
 stat_group | stat_schema | stat_table | stat_first_mark | stat_first_time_id | stat_last_mark | stat_last_time_id | stat_role | stat_verb | stat_rows 
------------+-------------+------------+-----------------+--------------------+----------------+-------------------+-----------+-----------+-----------
 myGroup2   | myschema2   | myTbl3     | Mark21          |               4029 | Multi-3        |              5004 | postgres  | INSERT    |        10
 myGroup2   | myschema2   | mytbl1     | Mark21          |               4029 | Multi-3        |              5004 | postgres  | DELETE    |       100
 myGroup2   | myschema2   | mytbl1     | Mark21          |               4029 | Multi-3        |              5004 | postgres  | INSERT    |     10100
 myGroup2   | myschema2   | mytbl1     | Mark21          |               4029 | Multi-3        |              5004 | postgres  | UPDATE    |       500
 myGroup2   | myschema2   | mytbl2     | Mark21          |               4029 | Multi-3        |              5004 | postgres  | INSERT    |       900
 myGroup2   | myschema2   | mytbl4     | Mark21          |               4029 | Multi-3        |              5004 | postgres  | INSERT    |       100
(6 rows)

select stat_group, stat_schema, stat_table, stat_first_mark, stat_first_time_id, stat_last_mark, stat_last_time_id, stat_role, stat_verb, stat_rows
  from emaj.emaj_detailed_log_stat_group('myGroup2','Mark22','Mark22')
  order by stat_group, stat_schema, stat_table;
 stat_group | stat_schema | stat_table | stat_first_mark | stat_first_time_id | stat_last_mark | stat_last_time_id | stat_role | stat_verb | stat_rows 
------------+-------------+------------+-----------------+--------------------+----------------+-------------------+-----------+-----------+-----------
(0 rows)

select stat_group, stat_schema, stat_table, stat_first_mark, stat_first_time_id, stat_last_mark, stat_last_time_id, stat_role, stat_verb, stat_rows
  from emaj.emaj_detailed_log_stat_group('myGroup2','Mark22','Mark23')
  order by stat_group, stat_schema, stat_table;
 stat_group | stat_schema | stat_table | stat_first_mark | stat_first_time_id | stat_last_mark | stat_last_time_id | stat_role | stat_verb | stat_rows 
------------+-------------+------------+-----------------+--------------------+----------------+-------------------+-----------+-----------+-----------
 myGroup2   | myschema2   | myTbl3     | Mark22          |               5001 | Mark23         |              5003 | postgres  | INSERT    |        10
 myGroup2   | myschema2   | mytbl4     | Mark22          |               5001 | Mark23         |              5003 | postgres  | INSERT    |       100
(2 rows)

select stat_group, stat_schema, stat_table, stat_first_mark, stat_first_time_id, stat_last_mark, stat_last_time_id, stat_role, stat_verb, stat_rows
  from emaj.emaj_detailed_log_stat_group('myGroup2','EMAJ_LAST_MARK','')
  order by stat_group, stat_schema, stat_table;
 stat_group | stat_schema | stat_table | stat_first_mark | stat_first_time_id | stat_last_mark | stat_last_time_id | stat_role | stat_verb | stat_rows 
------------+-------------+------------+-----------------+--------------------+----------------+-------------------+-----------+-----------+-----------
(0 rows)

select stat_group, stat_schema, stat_table, stat_first_mark, stat_first_time_id, stat_last_mark, stat_last_time_id, stat_role, stat_verb, stat_rows
  from emaj.emaj_detailed_log_stat_groups(array['myGroup1','myGroup2'],'Multi-1',null)
  order by stat_group, stat_schema, stat_table;
 stat_group | stat_schema | stat_table | stat_first_mark | stat_first_time_id | stat_last_mark | stat_last_time_id | stat_role | stat_verb | stat_rows 
------------+-------------+------------+-----------------+--------------------+----------------+-------------------+-----------+-----------+-----------
 myGroup2   | myschema2   | myTbl3     | Multi-1         |               5000 |                |                   | postgres  | INSERT    |        10
 myGroup2   | myschema2   | mytbl1     | Multi-1         |               5000 |                |                   | postgres  | DELETE    |       100
 myGroup2   | myschema2   | mytbl1     | Multi-1         |               5000 |                |                   | postgres  | INSERT    |     10100
 myGroup2   | myschema2   | mytbl1     | Multi-1         |               5000 |                |                   | postgres  | UPDATE    |       500
 myGroup2   | myschema2   | mytbl2     | Multi-1         |               5000 |                |                   | postgres  | INSERT    |       900
 myGroup2   | myschema2   | mytbl4     | Multi-1         |               5000 |                |                   | postgres  | INSERT    |       100
(6 rows)

select stat_group, stat_schema, stat_table, stat_first_mark, stat_first_time_id, stat_last_mark, stat_last_time_id, stat_role, stat_verb, stat_rows
  from emaj.emaj_detailed_log_stat_groups(array['myGroup1','myGroup2'],'Multi-1','Multi-3')
  order by stat_group, stat_schema, stat_table;
 stat_group | stat_schema | stat_table | stat_first_mark | stat_first_time_id | stat_last_mark | stat_last_time_id | stat_role | stat_verb | stat_rows 
------------+-------------+------------+-----------------+--------------------+----------------+-------------------+-----------+-----------+-----------
 myGroup2   | myschema2   | myTbl3     | Multi-1         |               5000 | Multi-3        |              5004 | postgres  | INSERT    |        10
 myGroup2   | myschema2   | mytbl1     | Multi-1         |               5000 | Multi-3        |              5004 | postgres  | DELETE    |       100
 myGroup2   | myschema2   | mytbl1     | Multi-1         |               5000 | Multi-3        |              5004 | postgres  | INSERT    |     10100
 myGroup2   | myschema2   | mytbl1     | Multi-1         |               5000 | Multi-3        |              5004 | postgres  | UPDATE    |       500
 myGroup2   | myschema2   | mytbl2     | Multi-1         |               5000 | Multi-3        |              5004 | postgres  | INSERT    |       900
 myGroup2   | myschema2   | mytbl4     | Multi-1         |               5000 | Multi-3        |              5004 | postgres  | INSERT    |       100
(6 rows)

-- empty group
select * from emaj.emaj_log_stat_group('emptyGroup','SM2',null);
 stat_group | stat_schema | stat_table | stat_first_mark | stat_first_mark_datetime | stat_first_time_id | stat_last_mark | stat_last_mark_datetime | stat_last_time_id | stat_rows 
------------+-------------+------------+-----------------+--------------------------+--------------------+----------------+-------------------------+-------------------+-----------
(0 rows)

select * from emaj.emaj_detailed_log_stat_group('emptyGroup','SM2',null);
 stat_group | stat_schema | stat_table | stat_first_mark | stat_first_mark_datetime | stat_first_time_id | stat_last_mark | stat_last_mark_datetime | stat_last_time_id | stat_role | stat_verb | stat_rows 
------------+-------------+------------+-----------------+--------------------------+--------------------+----------------+-------------------------+-------------------+-----------+-----------+-----------
(0 rows)

-- warning on marks range too wide to be contained by a single log session
select emaj.emaj_stop_group('myGroup4', 'myGroup4_stop');
 emaj_stop_group 
-----------------
               8
(1 row)

select emaj.emaj_start_group('myGroup4', 'myGroup4_restart', false);
 emaj_start_group 
------------------
                8
(1 row)

select stat_group, stat_schema, stat_table, stat_first_mark, stat_first_time_id, stat_last_mark, stat_last_time_id, stat_rows
  from emaj.emaj_log_stat_group('myGroup4','myGroup4_start','myGroup4_restart')
  order by stat_group, stat_schema, stat_table;
WARNING:  Between marks "myGroup4_start" and "myGroup4_restart", the tables group "myGroup4" has not been always in logging state. Some data changes may not have been recorded.
 stat_group | stat_schema | stat_table | stat_first_mark | stat_first_time_id |  stat_last_mark  | stat_last_time_id | stat_rows 
------------+-------------+------------+-----------------+--------------------+------------------+-------------------+-----------
 myGroup4   | myschema4   | mypartp1a  | myGroup4_start  |               4047 | myGroup4_restart |              5006 |         0
 myGroup4   | myschema4   | mypartp1b  | myGroup4_start  |               4047 | myGroup4_restart |              5006 |         0
 myGroup4   | myschema4   | mypartp2   | myGroup4_start  |               4047 | myGroup4_restart |              5006 |         0
 myGroup4   | myschema4   | mytblc1    | myGroup4_start  |               4047 | myGroup4_restart |              5006 |         0
 myGroup4   | myschema4   | mytblc2    | myGroup4_start  |               4047 | myGroup4_restart |              5006 |         0
 myGroup4   | myschema4   | mytblm     | myGroup4_start  |               4047 | myGroup4_restart |              5006 |         0
 myGroup4   | myschema4   | mytblr1    | Assign mytblr1  |               4065 | myGroup4_restart |              5006 |         0
 myGroup4   | myschema4   | mytblr2    | myGroup4_start  |               4047 | myGroup4_restart |              5006 |         0
(8 rows)

select stat_group, stat_schema, stat_table, stat_first_mark, stat_first_time_id, stat_last_mark, stat_last_time_id, stat_rows
  from emaj.emaj_log_stat_group('myGroup4','myGroup4_start','')
  order by stat_group, stat_schema, stat_table;
WARNING:  Since mark "myGroup4_start", the tables group "myGroup4" has not been always in logging state. Some data changes may not have been recorded.
 stat_group | stat_schema | stat_table | stat_first_mark | stat_first_time_id | stat_last_mark | stat_last_time_id | stat_rows 
------------+-------------+------------+-----------------+--------------------+----------------+-------------------+-----------
 myGroup4   | myschema4   | mypartp1a  | myGroup4_start  |               4047 |                |                   |         0
 myGroup4   | myschema4   | mypartp1b  | myGroup4_start  |               4047 |                |                   |         0
 myGroup4   | myschema4   | mypartp2   | myGroup4_start  |               4047 |                |                   |         0
 myGroup4   | myschema4   | mytblc1    | myGroup4_start  |               4047 |                |                   |         0
 myGroup4   | myschema4   | mytblc2    | myGroup4_start  |               4047 |                |                   |         0
 myGroup4   | myschema4   | mytblm     | myGroup4_start  |               4047 |                |                   |         0
 myGroup4   | myschema4   | mytblr1    | Assign mytblr1  |               4065 |                |                   |         0
 myGroup4   | myschema4   | mytblr2    | myGroup4_start  |               4047 |                |                   |         0
(8 rows)

-----------------------------
-- emaj_sequence_stat_group(), emaj_sequence_stat_groups() test
-----------------------------
-- group is unknown
select * from emaj.emaj_sequence_stat_group('dummy', null, null);
ERROR:  _check_group_names: The group "dummy" does not exist.
CONTEXT:  PL/pgSQL function emaj._check_group_names(text[],boolean,boolean,boolean,boolean,boolean,boolean) line 39 at RAISE
SQL statement "SELECT emaj._check_group_names(p_groupNames := p_groupNames, p_mayBeNull := p_multiGroup, p_lockGroups := FALSE)"
PL/pgSQL function emaj._sequence_stat_groups(text[],boolean,text,text) line 18 at SQL statement
SQL statement "SELECT stat_group, stat_schema, stat_sequence, stat_first_mark, stat_first_mark_datetime, stat_first_time_id,
             stat_last_mark, stat_last_mark_datetime, stat_last_time_id, stat_increments, stat_has_structure_changed
        FROM emaj._sequence_stat_groups(ARRAY[p_groupName], FALSE, p_firstMark, p_lastMark)"
PL/pgSQL function emaj.emaj_sequence_stat_group(text,text,text) line 7 at RETURN QUERY
-- start mark is null or unknown
select * from emaj.emaj_sequence_stat_group('myGroup1', null, null);
ERROR:  _check_marks_range: The first mark cannot be NULL or empty.
CONTEXT:  PL/pgSQL function emaj._check_marks_range(text[],text,text,boolean,boolean) line 16 at RAISE
SQL statement "SELECT checked.p_firstMark, checked.p_lastMark, p_firstMarkTimeId, p_lastMarkTimeId, p_firstMarkTs, p_lastMarkTs
                                                                                                               FROM emaj._check_marks_range(p_groupNames := p_groupNames, p_firstMark := p_firstMark, p_lastMark := p_lastMark,
                                     p_checkLogSession := FALSE) AS checked"
PL/pgSQL function emaj._sequence_stat_groups(text[],boolean,text,text) line 22 at SQL statement
SQL statement "SELECT stat_group, stat_schema, stat_sequence, stat_first_mark, stat_first_mark_datetime, stat_first_time_id,
             stat_last_mark, stat_last_mark_datetime, stat_last_time_id, stat_increments, stat_has_structure_changed
        FROM emaj._sequence_stat_groups(ARRAY[p_groupName], FALSE, p_firstMark, p_lastMark)"
PL/pgSQL function emaj.emaj_sequence_stat_group(text,text,text) line 7 at RETURN QUERY
select * from emaj.emaj_sequence_stat_groups(ARRAY['myGroup1'], 'dummy', null);
ERROR:  _check_mark_name: The mark "dummy" does not exist for the group "myGroup1".
CONTEXT:  PL/pgSQL function emaj._check_mark_name(text[],text,boolean) line 61 at RAISE
SQL statement "SELECT emaj._check_mark_name(p_groupNames := p_groupNames, p_mark := p_firstMark)"
PL/pgSQL function emaj._check_marks_range(text[],text,text,boolean,boolean) line 19 at SQL statement
SQL statement "SELECT checked.p_firstMark, checked.p_lastMark, p_firstMarkTimeId, p_lastMarkTimeId, p_firstMarkTs, p_lastMarkTs
                                                                                                               FROM emaj._check_marks_range(p_groupNames := p_groupNames, p_firstMark := p_firstMark, p_lastMark := p_lastMark,
                                     p_checkLogSession := FALSE) AS checked"
PL/pgSQL function emaj._sequence_stat_groups(text[],boolean,text,text) line 22 at SQL statement
SQL statement "SELECT stat_group, stat_schema, stat_sequence, stat_first_mark, stat_first_mark_datetime, stat_first_time_id,
             stat_last_mark, stat_last_mark_datetime, stat_last_time_id, stat_increments, stat_has_structure_changed
        FROM emaj._sequence_stat_groups(p_groupNames, TRUE, p_firstMark, p_lastMark)"
PL/pgSQL function emaj.emaj_sequence_stat_groups(text[],text,text) line 7 at RETURN QUERY
-- end mark is unknown
select * from emaj.emaj_sequence_stat_group('myGroup1', 'EMAJ_LAST_MARK', 'dummy');
ERROR:  _check_mark_name: The mark "dummy" does not exist for the group "myGroup1".
CONTEXT:  PL/pgSQL function emaj._check_mark_name(text[],text,boolean) line 61 at RAISE
SQL statement "SELECT emaj._check_mark_name(p_groupNames := p_groupNames, p_mark := p_lastMark)"
PL/pgSQL function emaj._check_marks_range(text[],text,text,boolean,boolean) line 33 at SQL statement
SQL statement "SELECT checked.p_firstMark, checked.p_lastMark, p_firstMarkTimeId, p_lastMarkTimeId, p_firstMarkTs, p_lastMarkTs
                                                                                                               FROM emaj._check_marks_range(p_groupNames := p_groupNames, p_firstMark := p_firstMark, p_lastMark := p_lastMark,
                                     p_checkLogSession := FALSE) AS checked"
PL/pgSQL function emaj._sequence_stat_groups(text[],boolean,text,text) line 22 at SQL statement
SQL statement "SELECT stat_group, stat_schema, stat_sequence, stat_first_mark, stat_first_mark_datetime, stat_first_time_id,
             stat_last_mark, stat_last_mark_datetime, stat_last_time_id, stat_increments, stat_has_structure_changed
        FROM emaj._sequence_stat_groups(ARRAY[p_groupName], FALSE, p_firstMark, p_lastMark)"
PL/pgSQL function emaj.emaj_sequence_stat_group(text,text,text) line 7 at RETURN QUERY
-- end mark is prior start mark (not tested as this is the same piece of code as for emaj_log_stat_group()
-- empty group
select * from emaj.emaj_sequence_stat_group('emptyGroup','SM2',null);
 stat_group | stat_schema | stat_sequence | stat_first_mark | stat_first_mark_datetime | stat_first_time_id | stat_last_mark | stat_last_mark_datetime | stat_last_time_id | stat_increments | stat_has_structure_changed 
------------+-------------+---------------+-----------------+--------------------------+--------------------+----------------+-------------------------+-------------------+-----------------+----------------------------
(0 rows)

-- should be ok
select stat_group, stat_schema, stat_sequence, stat_first_mark, stat_first_time_id, stat_last_mark, stat_last_time_id, stat_increments, stat_has_structure_changed
  from emaj.emaj_sequence_stat_group('myGroup2','Mark21',null)
  order by stat_group, stat_schema, stat_sequence;
 stat_group | stat_schema |  stat_sequence   | stat_first_mark | stat_first_time_id | stat_last_mark | stat_last_time_id | stat_increments | stat_has_structure_changed 
------------+-------------+------------------+-----------------+--------------------+----------------+-------------------+-----------------+----------------------------
 myGroup2   | myschema2   | myTbl3_col31_seq | Mark21          |               4029 |                |                   |              10 | f
 myGroup2   | myschema2   | myseq1           | Mark21          |               4029 |                |                   |               3 | f
(2 rows)

select stat_group, stat_schema, stat_sequence, stat_first_mark, stat_first_time_id, stat_last_mark, stat_last_time_id, stat_increments, stat_has_structure_changed
  from emaj.emaj_sequence_stat_group('myGroup2','Mark21','EMAJ_LAST_MARK')
  order by stat_group, stat_schema, stat_sequence;
 stat_group | stat_schema |  stat_sequence   | stat_first_mark | stat_first_time_id | stat_last_mark | stat_last_time_id | stat_increments | stat_has_structure_changed 
------------+-------------+------------------+-----------------+--------------------+----------------+-------------------+-----------------+----------------------------
 myGroup2   | myschema2   | myTbl3_col31_seq | Mark21          |               4029 | Multi-3        |              5004 |              10 | f
 myGroup2   | myschema2   | myseq1           | Mark21          |               4029 | Multi-3        |              5004 |               3 | t
(2 rows)

select stat_group, stat_schema, stat_sequence, stat_first_mark, stat_first_time_id, stat_last_mark, stat_last_time_id, stat_increments, stat_has_structure_changed
  from emaj.emaj_sequence_stat_group('myGroup2','Mark22','Mark22')
  order by stat_group, stat_schema, stat_sequence;
 stat_group | stat_schema |  stat_sequence   | stat_first_mark | stat_first_time_id | stat_last_mark | stat_last_time_id | stat_increments | stat_has_structure_changed 
------------+-------------+------------------+-----------------+--------------------+----------------+-------------------+-----------------+----------------------------
 myGroup2   | myschema2   | myTbl3_col31_seq | Mark22          |               5001 | Mark22         |              5001 |               0 | f
 myGroup2   | myschema2   | myseq1           | Mark22          |               5001 | Mark22         |              5001 |               0 | f
(2 rows)

select stat_group, stat_schema, stat_sequence, stat_first_mark, stat_first_time_id, stat_last_mark, stat_last_time_id, stat_increments, stat_has_structure_changed
  from emaj.emaj_sequence_stat_group('myGroup2','Mark22','Mark23')
  order by stat_group, stat_schema, stat_sequence;
 stat_group | stat_schema |  stat_sequence   | stat_first_mark | stat_first_time_id | stat_last_mark | stat_last_time_id | stat_increments | stat_has_structure_changed 
------------+-------------+------------------+-----------------+--------------------+----------------+-------------------+-----------------+----------------------------
 myGroup2   | myschema2   | myTbl3_col31_seq | Mark22          |               5001 | Mark23         |              5003 |              10 | f
 myGroup2   | myschema2   | myseq1           | Mark22          |               5001 | Mark23         |              5003 |               1 | t
(2 rows)

select stat_group, stat_schema, stat_sequence, stat_first_mark, stat_first_time_id, stat_last_mark, stat_last_time_id, stat_increments, stat_has_structure_changed
  from emaj.emaj_sequence_stat_group('myGroup2','EMAJ_LAST_MARK','')
  order by stat_group, stat_schema, stat_sequence;
 stat_group | stat_schema |  stat_sequence   | stat_first_mark | stat_first_time_id | stat_last_mark | stat_last_time_id | stat_increments | stat_has_structure_changed 
------------+-------------+------------------+-----------------+--------------------+----------------+-------------------+-----------------+----------------------------
 myGroup2   | myschema2   | myTbl3_col31_seq | Multi-3         |               5004 |                |                   |               0 | f
 myGroup2   | myschema2   | myseq1           | Multi-3         |               5004 |                |                   |               0 | t
(2 rows)

select stat_group, stat_schema, stat_sequence, stat_first_mark, stat_first_time_id, stat_last_mark, stat_last_time_id, stat_increments, stat_has_structure_changed
  from emaj.emaj_sequence_stat_groups(array['myGroup1','myGroup2'],'Multi-1',null)
  order by stat_group, stat_schema, stat_sequence;
 stat_group | stat_schema |   stat_sequence   | stat_first_mark | stat_first_time_id | stat_last_mark | stat_last_time_id | stat_increments | stat_has_structure_changed 
------------+-------------+-------------------+-----------------+--------------------+----------------+-------------------+-----------------+----------------------------
 myGroup1   | myschema1   | myTbl3_col31_seq  | Multi-1         |               5000 |                |                   |               0 | f
 myGroup1   | myschema1   | mytbl2b_col20_seq | Multi-1         |               5000 |                |                   |               0 | f
 myGroup2   | myschema2   | myTbl3_col31_seq  | Multi-1         |               5000 |                |                   |              10 | f
 myGroup2   | myschema2   | myseq1            | Multi-1         |               5000 |                |                   |               3 | f
(4 rows)

select stat_group, stat_schema, stat_sequence, stat_first_mark, stat_first_time_id, stat_last_mark, stat_last_time_id, stat_increments, stat_has_structure_changed
  from emaj.emaj_sequence_stat_groups(array['myGroup1','myGroup2'],'Multi-1','Multi-3')
  order by stat_group, stat_schema, stat_sequence;
 stat_group | stat_schema |   stat_sequence   | stat_first_mark | stat_first_time_id | stat_last_mark | stat_last_time_id | stat_increments | stat_has_structure_changed 
------------+-------------+-------------------+-----------------+--------------------+----------------+-------------------+-----------------+----------------------------
 myGroup1   | myschema1   | myTbl3_col31_seq  | Multi-1         |               5000 | Multi-3        |              5004 |               0 | f
 myGroup1   | myschema1   | mytbl2b_col20_seq | Multi-1         |               5000 | Multi-3        |              5004 |               0 | f
 myGroup2   | myschema2   | myTbl3_col31_seq  | Multi-1         |               5000 | Multi-3        |              5004 |              10 | f
 myGroup2   | myschema2   | myseq1            | Multi-1         |               5000 | Multi-3        |              5004 |               3 | t
(4 rows)

----------------------------------------------------------
-- emaj_log_stat_table() and emaj_log_stat_sequence() test
----------------------------------------------------------
select emaj.emaj_set_mark_group('myGroup2', 'before_log_stat_tblseq');
 emaj_set_mark_group 
---------------------
                  10
(1 row)

-- Test errors with input parameters
-- schema is unknown
select * from emaj.emaj_log_stat_table('dummy', 'mytbl1');
ERROR:  emaj_log_stat_table: The table dummy.mytbl1 is not known by E-Maj.
CONTEXT:  PL/pgSQL function emaj.emaj_log_stat_table(text,text,timestamp with time zone,timestamp with time zone) line 22 at RAISE
select * from emaj.emaj_log_stat_sequence('dummy', 'mytbl1');
ERROR:  emaj_log_stat_sequence: The sequence dummy.mytbl1 is not known by E-Maj.
CONTEXT:  PL/pgSQL function emaj.emaj_log_stat_sequence(text,text,timestamp with time zone,timestamp with time zone) line 23 at RAISE
-- table/sequence is unknown
select * from emaj.emaj_log_stat_table('myschema2', null);
ERROR:  emaj_log_stat_table: The table myschema2.<NULL> is not known by E-Maj.
CONTEXT:  PL/pgSQL function emaj.emaj_log_stat_table(text,text,timestamp with time zone,timestamp with time zone) line 22 at RAISE
select * from emaj.emaj_log_stat_table('myschema2', 'dummy', 'myGroup1', 'M1');
ERROR:  emaj_log_stat_table: Table myschema2.dummy is not known by E-Maj.
CONTEXT:  PL/pgSQL function emaj.emaj_log_stat_table(text,text,text,text,text,text) line 20 at RAISE
select * from emaj.emaj_log_stat_sequence('myschema2', null);
ERROR:  emaj_log_stat_sequence: The sequence myschema2.<NULL> is not known by E-Maj.
CONTEXT:  PL/pgSQL function emaj.emaj_log_stat_sequence(text,text,timestamp with time zone,timestamp with time zone) line 23 at RAISE
select * from emaj.emaj_log_stat_sequence('myschema2', 'dummy', 'myGroup1', 'M1');
ERROR:  emaj_log_stat_sequence: Sequence myschema2.dummy is not known by E-Maj.
CONTEXT:  PL/pgSQL function emaj.emaj_log_stat_sequence(text,text,text,text,text,text) line 21 at RAISE
-- bad timestamp or marks interval
select * from emaj.emaj_log_stat_table('myschema2', 'mytbl1', '2030/01/01'::TIMESTAMPTZ, '2020/01/01'::TIMESTAMPTZ);
ERROR:  emaj_log_stat_table: The start timestamp is greater than the end timestamp.
CONTEXT:  PL/pgSQL function emaj.emaj_log_stat_table(text,text,timestamp with time zone,timestamp with time zone) line 26 at RAISE
select * from emaj.emaj_log_stat_sequence('myschema2', 'myseq1', '2030/01/01'::TIMESTAMPTZ, '2020/01/01'::TIMESTAMPTZ);
ERROR:  emaj_log_stat_sequence: The start timestamp is greater than the end timestamp.
CONTEXT:  PL/pgSQL function emaj.emaj_log_stat_sequence(text,text,timestamp with time zone,timestamp with time zone) line 27 at RAISE
select * from emaj.emaj_log_stat_table('myschema2', 'mytbl1', 'myGroup2', 'Mark23', 'myGroup2', 'Mark22');
ERROR:  emaj_log_stat_table: The start mark has been set after the end mark.
CONTEXT:  PL/pgSQL function emaj.emaj_log_stat_table(text,text,text,text,text,text) line 44 at RAISE
select * from emaj.emaj_log_stat_sequence('myschema2', 'myseq1', 'myGroup2', 'Mark23', 'myGroup2', 'Mark22');
ERROR:  emaj_log_stat_sequence: The start mark has been set after the end mark.
CONTEXT:  PL/pgSQL function emaj.emaj_log_stat_sequence(text,text,text,text,text,text) line 45 at RAISE
-- bad group or mark names
select * from emaj.emaj_log_stat_table('myschema2', 'mytbl1', 'dummy_group', 'M1', 'myGroup2', 'M3');
ERROR:  _check_group_names: The group "dummy_group" does not exist.
CONTEXT:  PL/pgSQL function emaj._check_group_names(text[],boolean,boolean,boolean,boolean,boolean,boolean) line 39 at RAISE
SQL statement "SELECT emaj._check_group_names(p_groupNames := ARRAY[p_startGroup], p_mayBeNull := FALSE, p_lockGroups := FALSE)"
PL/pgSQL function emaj.emaj_log_stat_table(text,text,text,text,text,text) line 24 at PERFORM
select * from emaj.emaj_log_stat_table('myschema2', 'mytbl1', 'myGroup2', 'dummy_mark', 'myGroup2', 'M3');
ERROR:  _check_mark_name: The mark "dummy_mark" does not exist for the group "myGroup2".
CONTEXT:  PL/pgSQL function emaj._check_mark_name(text[],text,boolean) line 61 at RAISE
SQL statement "SELECT emaj._check_mark_name(p_groupNames := ARRAY[p_startGroup], p_mark := p_startMark)"
PL/pgSQL function emaj.emaj_log_stat_table(text,text,text,text,text,text) line 25 at SQL statement
select * from emaj.emaj_log_stat_table('myschema2', 'mytbl1', 'myGroup2', null);
ERROR:  _check_mark_name: The mark "<NULL>" does not exist for the group "myGroup2".
CONTEXT:  PL/pgSQL function emaj._check_mark_name(text[],text,boolean) line 61 at RAISE
SQL statement "SELECT emaj._check_mark_name(p_groupNames := ARRAY[p_startGroup], p_mark := p_startMark)"
PL/pgSQL function emaj.emaj_log_stat_table(text,text,text,text,text,text) line 25 at SQL statement
select * from emaj.emaj_log_stat_table('myschema2', 'mytbl1', 'myGroup2', 'M1', 'dummy_group', 'M3');
ERROR:  _check_mark_name: The mark "M1" does not exist for the group "myGroup2".
CONTEXT:  PL/pgSQL function emaj._check_mark_name(text[],text,boolean) line 61 at RAISE
SQL statement "SELECT emaj._check_mark_name(p_groupNames := ARRAY[p_startGroup], p_mark := p_startMark)"
PL/pgSQL function emaj.emaj_log_stat_table(text,text,text,text,text,text) line 25 at SQL statement
select * from emaj.emaj_log_stat_table('myschema2', 'mytbl1', 'myGroup2', 'M1', 'myGroup2', 'dummy_mark');
ERROR:  _check_mark_name: The mark "M1" does not exist for the group "myGroup2".
CONTEXT:  PL/pgSQL function emaj._check_mark_name(text[],text,boolean) line 61 at RAISE
SQL statement "SELECT emaj._check_mark_name(p_groupNames := ARRAY[p_startGroup], p_mark := p_startMark)"
PL/pgSQL function emaj.emaj_log_stat_table(text,text,text,text,text,text) line 25 at SQL statement
select * from emaj.emaj_log_stat_sequence('myschema2', 'myseq1', 'dummy_group', 'M1', 'myGroup2', 'M3');
ERROR:  _check_group_names: The group "dummy_group" does not exist.
CONTEXT:  PL/pgSQL function emaj._check_group_names(text[],boolean,boolean,boolean,boolean,boolean,boolean) line 39 at RAISE
SQL statement "SELECT emaj._check_group_names(p_groupNames := ARRAY[p_startGroup], p_mayBeNull := FALSE, p_lockGroups := FALSE)"
PL/pgSQL function emaj.emaj_log_stat_sequence(text,text,text,text,text,text) line 25 at PERFORM
select * from emaj.emaj_log_stat_sequence('myschema2', 'myseq1', 'myGroup2', 'dummy_mark', 'myGroup2', 'M3');
ERROR:  _check_mark_name: The mark "dummy_mark" does not exist for the group "myGroup2".
CONTEXT:  PL/pgSQL function emaj._check_mark_name(text[],text,boolean) line 61 at RAISE
SQL statement "SELECT emaj._check_mark_name(p_groupNames := ARRAY[p_startGroup], p_mark := p_startMark)"
PL/pgSQL function emaj.emaj_log_stat_sequence(text,text,text,text,text,text) line 26 at SQL statement
select * from emaj.emaj_log_stat_sequence('myschema2', 'mytbl1', 'myGroup2', null);
ERROR:  emaj_log_stat_sequence: Sequence myschema2.mytbl1 is not known by E-Maj.
CONTEXT:  PL/pgSQL function emaj.emaj_log_stat_sequence(text,text,text,text,text,text) line 21 at RAISE
select * from emaj.emaj_log_stat_sequence('myschema2', 'myseq1', 'myGroup2', 'M1', 'dummy_group', 'M3');
ERROR:  _check_mark_name: The mark "M1" does not exist for the group "myGroup2".
CONTEXT:  PL/pgSQL function emaj._check_mark_name(text[],text,boolean) line 61 at RAISE
SQL statement "SELECT emaj._check_mark_name(p_groupNames := ARRAY[p_startGroup], p_mark := p_startMark)"
PL/pgSQL function emaj.emaj_log_stat_sequence(text,text,text,text,text,text) line 26 at SQL statement
select * from emaj.emaj_log_stat_sequence('myschema2', 'myseq1', 'myGroup2', 'M1', 'myGroup2', 'dummy_mark');
ERROR:  _check_mark_name: The mark "M1" does not exist for the group "myGroup2".
CONTEXT:  PL/pgSQL function emaj._check_mark_name(text[],text,boolean) line 61 at RAISE
SQL statement "SELECT emaj._check_mark_name(p_groupNames := ARRAY[p_startGroup], p_mark := p_startMark)"
PL/pgSQL function emaj.emaj_log_stat_sequence(text,text,text,text,text,text) line 26 at SQL statement
-- Should be OK
-- no bounds
select stat_group, stat_first_mark, stat_first_time_id, stat_is_log_start, stat_last_mark, stat_last_time_id, stat_is_log_stop, stat_changes, stat_rollbacks
    from emaj.emaj_log_stat_table('myschema2', 'mytbl1');
 stat_group |    stat_first_mark     | stat_first_time_id | stat_is_log_start |     stat_last_mark     | stat_last_time_id | stat_is_log_stop | stat_changes | stat_rollbacks 
------------+------------------------+--------------------+-------------------+------------------------+-------------------+------------------+--------------+----------------
 myGroup2   | Mark21                 |               4029 | t                 | Multi-1                |              5000 | f                |            0 |              0
 myGroup2   | Multi-1                |               5000 | f                 | Mark22                 |              5001 | f                |        10700 |              0
 myGroup2   | Mark22                 |               5001 | f                 | Multi-2                |              5002 | f                |            0 |              0
 myGroup2   | Multi-2                |               5002 | f                 | Mark23                 |              5003 | f                |            0 |              0
 myGroup2   | Mark23                 |               5003 | f                 | Multi-3                |              5004 | f                |            0 |              0
 myGroup2   | Multi-3                |               5004 | f                 | before_log_stat_tblseq |              5007 | f                |            0 |              0
 myGroup2   | before_log_stat_tblseq |               5007 | f                 | [current state]        |                   | f                |            0 |              0
(7 rows)

select stat_group, stat_first_mark, stat_first_time_id, stat_is_log_start, stat_last_mark, stat_last_time_id, stat_is_log_stop, stat_increments, stat_has_structure_changed, stat_rollbacks
    from emaj.emaj_log_stat_sequence('myschema2', 'myseq1');
 stat_group |    stat_first_mark     | stat_first_time_id | stat_is_log_start |     stat_last_mark     | stat_last_time_id | stat_is_log_stop | stat_increments | stat_has_structure_changed | stat_rollbacks 
------------+------------------------+--------------------+-------------------+------------------------+-------------------+------------------+-----------------+----------------------------+----------------
 myGroup2   | Mark21                 |               4029 | t                 | Multi-1                |              5000 | f                |               0 | f                          |              0
 myGroup2   | Multi-1                |               5000 | f                 | Mark22                 |              5001 | f                |               2 | f                          |              0
 myGroup2   | Mark22                 |               5001 | f                 | Multi-2                |              5002 | f                |               0 | f                          |              0
 myGroup2   | Multi-2                |               5002 | f                 | Mark23                 |              5003 | f                |               1 | t                          |              0
 myGroup2   | Mark23                 |               5003 | f                 | Multi-3                |              5004 | f                |               0 | f                          |              0
 myGroup2   | Multi-3                |               5004 | f                 | before_log_stat_tblseq |              5007 | f                |               0 | t                          |              0
 myGroup2   | before_log_stat_tblseq |               5007 | f                 | [current state]        |                   | f                |               0 | f                          |              0
(7 rows)

-- limit the timeframe with marks range
select stat_group, stat_first_mark, stat_first_time_id, stat_is_log_start, stat_last_mark, stat_last_time_id, stat_is_log_stop, stat_changes, stat_rollbacks
    from emaj.emaj_log_stat_table('myschema2', 'mytbl1', 'myGroup2', 'Mark23');
 stat_group |    stat_first_mark     | stat_first_time_id | stat_is_log_start |     stat_last_mark     | stat_last_time_id | stat_is_log_stop | stat_changes | stat_rollbacks 
------------+------------------------+--------------------+-------------------+------------------------+-------------------+------------------+--------------+----------------
 myGroup2   | Mark23                 |               5003 | f                 | Multi-3                |              5004 | f                |            0 |              0
 myGroup2   | Multi-3                |               5004 | f                 | before_log_stat_tblseq |              5007 | f                |            0 |              0
 myGroup2   | before_log_stat_tblseq |               5007 | f                 | [current state]        |                   | f                |            0 |              0
(3 rows)

select stat_group, stat_first_mark, stat_first_time_id, stat_is_log_start, stat_last_mark, stat_last_time_id, stat_is_log_stop, stat_increments, stat_has_structure_changed, stat_rollbacks
    from emaj.emaj_log_stat_sequence('myschema2', 'myseq1', 'myGroup2', 'Mark23');
 stat_group |    stat_first_mark     | stat_first_time_id | stat_is_log_start |     stat_last_mark     | stat_last_time_id | stat_is_log_stop | stat_increments | stat_has_structure_changed | stat_rollbacks 
------------+------------------------+--------------------+-------------------+------------------------+-------------------+------------------+-----------------+----------------------------+----------------
 myGroup2   | Mark23                 |               5003 | f                 | Multi-3                |              5004 | f                |               0 | f                          |              0
 myGroup2   | Multi-3                |               5004 | f                 | before_log_stat_tblseq |              5007 | f                |               0 | t                          |              0
 myGroup2   | before_log_stat_tblseq |               5007 | f                 | [current state]        |                   | f                |               0 | f                          |              0
(3 rows)

select stat_group, stat_first_mark, stat_first_time_id, stat_is_log_start, stat_last_mark, stat_last_time_id, stat_is_log_stop, stat_changes, stat_rollbacks
    from emaj.emaj_log_stat_table('myschema2', 'mytbl1', null, null, 'myGroup2', 'Mark22');
 stat_group | stat_first_mark | stat_first_time_id | stat_is_log_start | stat_last_mark | stat_last_time_id | stat_is_log_stop | stat_changes | stat_rollbacks 
------------+-----------------+--------------------+-------------------+----------------+-------------------+------------------+--------------+----------------
 myGroup2   | Mark21          |               4029 | t                 | Multi-1        |              5000 | f                |            0 |              0
 myGroup2   | Multi-1         |               5000 | f                 | Mark22         |              5001 | f                |        10700 |              0
(2 rows)

select stat_group, stat_first_mark, stat_first_time_id, stat_is_log_start, stat_last_mark, stat_last_time_id, stat_is_log_stop, stat_increments, stat_has_structure_changed, stat_rollbacks
    from emaj.emaj_log_stat_sequence('myschema2', 'myseq1', null, null, 'myGroup2', 'Mark22');
 stat_group | stat_first_mark | stat_first_time_id | stat_is_log_start | stat_last_mark | stat_last_time_id | stat_is_log_stop | stat_increments | stat_has_structure_changed | stat_rollbacks 
------------+-----------------+--------------------+-------------------+----------------+-------------------+------------------+-----------------+----------------------------+----------------
 myGroup2   | Mark21          |               4029 | t                 | Multi-1        |              5000 | f                |               0 | f                          |              0
 myGroup2   | Multi-1         |               5000 | f                 | Mark22         |              5001 | f                |               2 | f                          |              0
(2 rows)

select stat_group, stat_first_mark, stat_first_time_id, stat_is_log_start, stat_last_mark, stat_last_time_id, stat_is_log_stop, stat_changes, stat_rollbacks
    from emaj.emaj_log_stat_table('myschema2', 'mytbl1', 'myGroup2', 'Mark22', 'myGroup2', 'Mark23');
 stat_group | stat_first_mark | stat_first_time_id | stat_is_log_start | stat_last_mark | stat_last_time_id | stat_is_log_stop | stat_changes | stat_rollbacks 
------------+-----------------+--------------------+-------------------+----------------+-------------------+------------------+--------------+----------------
 myGroup2   | Mark22          |               5001 | f                 | Multi-2        |              5002 | f                |            0 |              0
 myGroup2   | Multi-2         |               5002 | f                 | Mark23         |              5003 | f                |            0 |              0
(2 rows)

select stat_group, stat_first_mark, stat_first_time_id, stat_is_log_start, stat_last_mark, stat_last_time_id, stat_is_log_stop, stat_increments, stat_has_structure_changed, stat_rollbacks
    from emaj.emaj_log_stat_sequence('myschema2', 'myseq1', 'myGroup2', 'Mark22', 'myGroup2', 'Mark23');
 stat_group | stat_first_mark | stat_first_time_id | stat_is_log_start | stat_last_mark | stat_last_time_id | stat_is_log_stop | stat_increments | stat_has_structure_changed | stat_rollbacks 
------------+-----------------+--------------------+-------------------+----------------+-------------------+------------------+-----------------+----------------------------+----------------
 myGroup2   | Mark22          |               5001 | f                 | Multi-2        |              5002 | f                |               0 | f                          |              0
 myGroup2   | Multi-2         |               5002 | f                 | Mark23         |              5003 | f                |               1 | t                          |              0
(2 rows)

-- marks range from another group
select emaj.emaj_set_mark_group('emptyGroup', 'log_stat_1');
 emaj_set_mark_group 
---------------------
                   0
(1 row)

select stat_group, stat_first_mark, stat_first_time_id, stat_is_log_start, stat_last_mark, stat_last_time_id, stat_is_log_stop, stat_changes, stat_rollbacks
    from emaj.emaj_log_stat_table('myschema2', 'mytbl1', 'emptyGroup', 'log_stat_1');
 stat_group |    stat_first_mark     | stat_first_time_id | stat_is_log_start | stat_last_mark  | stat_last_time_id | stat_is_log_stop | stat_changes | stat_rollbacks 
------------+------------------------+--------------------+-------------------+-----------------+-------------------+------------------+--------------+----------------
 myGroup2   | before_log_stat_tblseq |               5007 | f                 | [current state] |                   | f                |            0 |              0
(1 row)

select stat_group, stat_first_mark, stat_first_time_id, stat_is_log_start, stat_last_mark, stat_last_time_id, stat_is_log_stop, stat_changes, stat_rollbacks
    from emaj.emaj_log_stat_table('myschema2', 'mytbl1', 'myGroup2', 'Mark22', 'emptyGroup', 'log_stat_1');
 stat_group |    stat_first_mark     | stat_first_time_id | stat_is_log_start |     stat_last_mark     | stat_last_time_id | stat_is_log_stop | stat_changes | stat_rollbacks 
------------+------------------------+--------------------+-------------------+------------------------+-------------------+------------------+--------------+----------------
 myGroup2   | Mark22                 |               5001 | f                 | Multi-2                |              5002 | f                |            0 |              0
 myGroup2   | Multi-2                |               5002 | f                 | Mark23                 |              5003 | f                |            0 |              0
 myGroup2   | Mark23                 |               5003 | f                 | Multi-3                |              5004 | f                |            0 |              0
 myGroup2   | Multi-3                |               5004 | f                 | before_log_stat_tblseq |              5007 | f                |            0 |              0
 myGroup2   | before_log_stat_tblseq |               5007 | f                 | [current state]        |                   | f                |            0 |              0
(5 rows)

select stat_group, stat_first_mark, stat_first_time_id, stat_is_log_start, stat_last_mark, stat_last_time_id, stat_is_log_stop, stat_increments, stat_has_structure_changed, stat_rollbacks
    from emaj.emaj_log_stat_sequence('myschema2', 'myseq1', 'emptyGroup', 'log_stat_1');
 stat_group |    stat_first_mark     | stat_first_time_id | stat_is_log_start | stat_last_mark  | stat_last_time_id | stat_is_log_stop | stat_increments | stat_has_structure_changed | stat_rollbacks 
------------+------------------------+--------------------+-------------------+-----------------+-------------------+------------------+-----------------+----------------------------+----------------
 myGroup2   | before_log_stat_tblseq |               5007 | f                 | [current state] |                   | f                |               0 | f                          |              0
(1 row)

select stat_group, stat_first_mark, stat_first_time_id, stat_is_log_start, stat_last_mark, stat_last_time_id, stat_is_log_stop, stat_increments, stat_has_structure_changed, stat_rollbacks
    from emaj.emaj_log_stat_sequence('myschema2', 'myseq1', 'myGroup2', 'Mark22', 'emptyGroup', 'log_stat_1');
 stat_group |    stat_first_mark     | stat_first_time_id | stat_is_log_start |     stat_last_mark     | stat_last_time_id | stat_is_log_stop | stat_increments | stat_has_structure_changed | stat_rollbacks 
------------+------------------------+--------------------+-------------------+------------------------+-------------------+------------------+-----------------+----------------------------+----------------
 myGroup2   | Mark22                 |               5001 | f                 | Multi-2                |              5002 | f                |               0 | f                          |              0
 myGroup2   | Multi-2                |               5002 | f                 | Mark23                 |              5003 | f                |               1 | t                          |              0
 myGroup2   | Mark23                 |               5003 | f                 | Multi-3                |              5004 | f                |               0 | f                          |              0
 myGroup2   | Multi-3                |               5004 | f                 | before_log_stat_tblseq |              5007 | f                |               0 | t                          |              0
 myGroup2   | before_log_stat_tblseq |               5007 | f                 | [current state]        |                   | f                |               0 | f                          |              0
(5 rows)

-- Same mark as lower and upper bounds
select stat_group, stat_first_mark, stat_first_time_id, stat_is_log_start, stat_last_mark, stat_last_time_id, stat_is_log_stop, stat_changes, stat_rollbacks
    from emaj.emaj_log_stat_table('myschema2', 'mytbl1', 'myGroup2', 'Mark22', 'myGroup2', 'Mark22');
 stat_group | stat_first_mark | stat_first_time_id | stat_is_log_start | stat_last_mark | stat_last_time_id | stat_is_log_stop | stat_changes | stat_rollbacks 
------------+-----------------+--------------------+-------------------+----------------+-------------------+------------------+--------------+----------------
(0 rows)

select stat_group, stat_first_mark, stat_first_time_id, stat_is_log_start, stat_last_mark, stat_last_time_id, stat_is_log_stop, stat_increments, stat_has_structure_changed, stat_rollbacks
    from emaj.emaj_log_stat_sequence('myschema2', 'myseq1', 'myGroup2', 'Mark22', 'myGroup2', 'Mark22');
 stat_group | stat_first_mark | stat_first_time_id | stat_is_log_start | stat_last_mark | stat_last_time_id | stat_is_log_stop | stat_increments | stat_has_structure_changed | stat_rollbacks 
------------+-----------------+--------------------+-------------------+----------------+-------------------+------------------+-----------------+----------------------------+----------------
(0 rows)

-- No data on the requested time or marks interval
select * from emaj.emaj_log_stat_table('myschema2', 'mytbl1', '2020/01/01'::TIMESTAMPTZ, '2020/01/02'::TIMESTAMPTZ);
 stat_group | stat_first_mark | stat_first_mark_datetime | stat_first_time_id | stat_is_log_start | stat_last_mark | stat_last_mark_datetime | stat_last_time_id | stat_is_log_stop | stat_changes | stat_rollbacks 
------------+-----------------+--------------------------+--------------------+-------------------+----------------+-------------------------+-------------------+------------------+--------------+----------------
(0 rows)

select * from emaj.emaj_log_stat_sequence('myschema2', 'myseq1', '2020/01/01'::TIMESTAMPTZ, '2020/01/02'::TIMESTAMPTZ);
 stat_group | stat_first_mark | stat_first_mark_datetime | stat_first_time_id | stat_is_log_start | stat_last_mark | stat_last_mark_datetime | stat_last_time_id | stat_is_log_stop | stat_increments | stat_has_structure_changed | stat_rollbacks 
------------+-----------------+--------------------------+--------------------+-------------------+----------------+-------------------------+-------------------+------------------+-----------------+----------------------------+----------------
(0 rows)

select * from emaj.emaj_log_stat_table('myschema2', 'mytbl1', null, null, 'emptyGroup', 'SM2');    -- very old upper bound mark
 stat_group | stat_first_mark | stat_first_mark_datetime | stat_first_time_id | stat_is_log_start | stat_last_mark | stat_last_mark_datetime | stat_last_time_id | stat_is_log_stop | stat_changes | stat_rollbacks 
------------+-----------------+--------------------------+--------------------+-------------------+----------------+-------------------------+-------------------+------------------+--------------+----------------
(0 rows)

select * from emaj.emaj_log_stat_sequence('myschema2', 'myseq1', null, null, 'emptyGroup', 'SM2');
 stat_group | stat_first_mark | stat_first_mark_datetime | stat_first_time_id | stat_is_log_start | stat_last_mark | stat_last_mark_datetime | stat_last_time_id | stat_is_log_stop | stat_increments | stat_has_structure_changed | stat_rollbacks 
------------+-----------------+--------------------------+--------------------+-------------------+----------------+-------------------------+-------------------+------------------+-----------------+----------------------------+----------------
(0 rows)

-- limit the timeframe with timestamps
begin transaction;
  select emaj.emaj_set_mark_group('myGroup2', 'tmp_mark');
 emaj_set_mark_group 
---------------------
                  10
(1 row)

  insert into myTbl1 select i, 'TMP', 'TMP' from generate_series (100000,100005) AS i;
  select nextval('myschema2.myseq1');
 nextval 
---------
    1003
(1 row)

  select stat_group, stat_first_mark, stat_first_time_id, stat_is_log_start, stat_last_mark, stat_last_time_id, stat_is_log_stop, stat_changes, stat_rollbacks
      from emaj.emaj_log_stat_table('myschema2', 'mytbl1', transaction_timestamp(), null);
 stat_group |    stat_first_mark     | stat_first_time_id | stat_is_log_start | stat_last_mark  | stat_last_time_id | stat_is_log_stop | stat_changes | stat_rollbacks 
------------+------------------------+--------------------+-------------------+-----------------+-------------------+------------------+--------------+----------------
 myGroup2   | before_log_stat_tblseq |               5007 | f                 | tmp_mark        |              5009 | f                |            0 |              0
 myGroup2   | tmp_mark               |               5009 | f                 | [current state] |                   | f                |            6 |              0
(2 rows)

  select stat_group, stat_first_mark, stat_first_time_id, stat_is_log_start, stat_last_mark, stat_last_time_id, stat_is_log_stop, stat_increments, stat_has_structure_changed, stat_rollbacks
      from emaj.emaj_log_stat_sequence('myschema2', 'myseq1', transaction_timestamp(), null);
 stat_group |    stat_first_mark     | stat_first_time_id | stat_is_log_start | stat_last_mark  | stat_last_time_id | stat_is_log_stop | stat_increments | stat_has_structure_changed | stat_rollbacks 
------------+------------------------+--------------------+-------------------+-----------------+-------------------+------------------+-----------------+----------------------------+----------------
 myGroup2   | before_log_stat_tblseq |               5007 | f                 | tmp_mark        |              5009 | f                |               0 | f                          |              0
 myGroup2   | tmp_mark               |               5009 | f                 | [current state] |                   | f                |               1 | f                          |              0
(2 rows)

-- Same timestamp as lower and upper bounds
  select stat_group, stat_first_mark, stat_first_time_id, stat_is_log_start, stat_last_mark, stat_last_time_id, stat_is_log_stop, stat_changes, stat_rollbacks
      from emaj.emaj_log_stat_table('myschema2', 'mytbl1', transaction_timestamp(), transaction_timestamp());
 stat_group |    stat_first_mark     | stat_first_time_id | stat_is_log_start | stat_last_mark | stat_last_time_id | stat_is_log_stop | stat_changes | stat_rollbacks 
------------+------------------------+--------------------+-------------------+----------------+-------------------+------------------+--------------+----------------
 myGroup2   | before_log_stat_tblseq |               5007 | f                 | tmp_mark       |              5009 | f                |            0 |              0
(1 row)

  select stat_group, stat_first_mark, stat_first_time_id, stat_is_log_start, stat_last_mark, stat_last_time_id, stat_is_log_stop, stat_increments, stat_has_structure_changed, stat_rollbacks
      from emaj.emaj_log_stat_sequence('myschema2', 'myseq1', transaction_timestamp(), transaction_timestamp());
 stat_group |    stat_first_mark     | stat_first_time_id | stat_is_log_start | stat_last_mark | stat_last_time_id | stat_is_log_stop | stat_increments | stat_has_structure_changed | stat_rollbacks 
------------+------------------------+--------------------+-------------------+----------------+-------------------+------------------+-----------------+----------------------------+----------------
 myGroup2   | before_log_stat_tblseq |               5007 | f                 | tmp_mark       |              5009 | f                |               0 | f                          |              0
(1 row)

commit;
-- perform rollbacks
--   a logged rollback ...
select * from emaj.emaj_logged_rollback_group('myGroup2', 'Multi-1');
 rlbk_severity |              rlbk_message              
---------------+----------------------------------------
 Notice        | Rollback id = 5000.
 Notice        | 4 / 8 tables effectively processed.
 Notice        | 2 / 2 sequences effectively processed.
(3 rows)

select emaj.emaj_rename_mark_group('myGroup2', emaj.emaj_get_previous_mark_group('myGroup2', 'EMAJ_LAST_MARK'), 'RLBK_START');
 emaj_rename_mark_group 
------------------------
 
(1 row)

select emaj.emaj_rename_mark_group('myGroup2', 'EMAJ_LAST_MARK', 'RLBK_DONE');
 emaj_rename_mark_group 
------------------------
 
(1 row)

select stat_group, stat_first_mark, stat_first_time_id, stat_is_log_start, stat_last_mark, stat_last_time_id, stat_is_log_stop, stat_changes, stat_rollbacks
    from emaj.emaj_log_stat_table('myschema2', 'mytbl1');
 stat_group |    stat_first_mark     | stat_first_time_id | stat_is_log_start |     stat_last_mark     | stat_last_time_id | stat_is_log_stop | stat_changes | stat_rollbacks 
------------+------------------------+--------------------+-------------------+------------------------+-------------------+------------------+--------------+----------------
 myGroup2   | Mark21                 |               4029 | t                 | Multi-1                |              5000 | f                |            0 |              0
 myGroup2   | Multi-1                |               5000 | f                 | Mark22                 |              5001 | f                |        10700 |              0
 myGroup2   | Mark22                 |               5001 | f                 | Multi-2                |              5002 | f                |            0 |              0
 myGroup2   | Multi-2                |               5002 | f                 | Mark23                 |              5003 | f                |            0 |              0
 myGroup2   | Mark23                 |               5003 | f                 | Multi-3                |              5004 | f                |            0 |              0
 myGroup2   | Multi-3                |               5004 | f                 | before_log_stat_tblseq |              5007 | f                |            0 |              0
 myGroup2   | before_log_stat_tblseq |               5007 | f                 | tmp_mark               |              5009 | f                |            0 |              0
 myGroup2   | tmp_mark               |               5009 | f                 | RLBK_START             |              5010 | f                |            6 |              0
 myGroup2   | RLBK_START             |               5010 | f                 | RLBK_DONE              |              5011 | f                |        10006 |              1
 myGroup2   | RLBK_DONE              |               5011 | f                 | [current state]        |                   | f                |            0 |              0
(10 rows)

select stat_group, stat_first_mark, stat_first_time_id, stat_is_log_start, stat_last_mark, stat_last_time_id, stat_is_log_stop, stat_increments, stat_has_structure_changed, stat_rollbacks
    from emaj.emaj_log_stat_sequence('myschema2', 'myseq1');
 stat_group |    stat_first_mark     | stat_first_time_id | stat_is_log_start |     stat_last_mark     | stat_last_time_id | stat_is_log_stop | stat_increments | stat_has_structure_changed | stat_rollbacks 
------------+------------------------+--------------------+-------------------+------------------------+-------------------+------------------+-----------------+----------------------------+----------------
 myGroup2   | Mark21                 |               4029 | t                 | Multi-1                |              5000 | f                |               0 | f                          |              0
 myGroup2   | Multi-1                |               5000 | f                 | Mark22                 |              5001 | f                |               2 | f                          |              0
 myGroup2   | Mark22                 |               5001 | f                 | Multi-2                |              5002 | f                |               0 | f                          |              0
 myGroup2   | Multi-2                |               5002 | f                 | Mark23                 |              5003 | f                |               1 | t                          |              0
 myGroup2   | Mark23                 |               5003 | f                 | Multi-3                |              5004 | f                |               0 | f                          |              0
 myGroup2   | Multi-3                |               5004 | f                 | before_log_stat_tblseq |              5007 | f                |               0 | t                          |              0
 myGroup2   | before_log_stat_tblseq |               5007 | f                 | tmp_mark               |              5009 | f                |               0 | f                          |              0
 myGroup2   | tmp_mark               |               5009 | f                 | RLBK_START             |              5010 | f                |               1 | f                          |              0
 myGroup2   | RLBK_START             |               5010 | f                 | RLBK_DONE              |              5011 | f                |              -4 | f                          |              1
 myGroup2   | RLBK_DONE              |               5011 | f                 | [current state]        |                   | f                |               0 | f                          |              0
(10 rows)

--    ... to consolidate
begin transaction;
  select * from emaj.emaj_consolidate_rollback_group('myGroup2', 'RLBK_DONE');
 emaj_consolidate_rollback_group 
---------------------------------
                               6
(1 row)

  select stat_group, stat_first_mark, stat_first_time_id, stat_is_log_start, stat_last_mark, stat_last_time_id, stat_is_log_stop, stat_changes, stat_rollbacks
      from emaj.emaj_log_stat_table('myschema2', 'mytbl1');
 stat_group | stat_first_mark | stat_first_time_id | stat_is_log_start | stat_last_mark  | stat_last_time_id | stat_is_log_stop | stat_changes | stat_rollbacks 
------------+-----------------+--------------------+-------------------+-----------------+-------------------+------------------+--------------+----------------
 myGroup2   | Mark21          |               4029 | t                 | Multi-1         |              5000 | f                |            0 |              0
 myGroup2   | Multi-1         |               5000 | f                 | RLBK_DONE       |              5011 | f                |            0 |              1
 myGroup2   | RLBK_DONE       |               5011 | f                 | [current state] |                   | f                |            0 |              0
(3 rows)

  select stat_group, stat_first_mark, stat_first_time_id, stat_is_log_start, stat_last_mark, stat_last_time_id, stat_is_log_stop, stat_increments, stat_has_structure_changed, stat_rollbacks
      from emaj.emaj_log_stat_sequence('myschema2', 'myseq1');
 stat_group | stat_first_mark | stat_first_time_id | stat_is_log_start | stat_last_mark  | stat_last_time_id | stat_is_log_stop | stat_increments | stat_has_structure_changed | stat_rollbacks 
------------+-----------------+--------------------+-------------------+-----------------+-------------------+------------------+-----------------+----------------------------+----------------
 myGroup2   | Mark21          |               4029 | t                 | Multi-1         |              5000 | f                |               0 | f                          |              0
 myGroup2   | Multi-1         |               5000 | f                 | RLBK_DONE       |              5011 | f                |               0 | f                          |              1
 myGroup2   | RLBK_DONE       |               5011 | f                 | [current state] |                   | f                |               0 | f                          |              0
(3 rows)

rollback;
--   an unlogged rollback
select * from emaj.emaj_rollback_group('myGroup2', 'RLBK_DONE');
 rlbk_severity |              rlbk_message              
---------------+----------------------------------------
 Notice        | Rollback id = 5001.
 Notice        | 0 / 8 tables effectively processed.
 Notice        | 0 / 2 sequences effectively processed.
(3 rows)

select stat_group, stat_first_mark, stat_first_time_id, stat_is_log_start, stat_last_mark, stat_last_time_id, stat_is_log_stop, stat_changes, stat_rollbacks
    from emaj.emaj_log_stat_table('myschema2', 'mytbl1', 'myGroup2', 'Mark23');
 stat_group |    stat_first_mark     | stat_first_time_id | stat_is_log_start |     stat_last_mark     | stat_last_time_id | stat_is_log_stop | stat_changes | stat_rollbacks 
------------+------------------------+--------------------+-------------------+------------------------+-------------------+------------------+--------------+----------------
 myGroup2   | Mark23                 |               5003 | f                 | Multi-3                |              5004 | f                |            0 |              0
 myGroup2   | Multi-3                |               5004 | f                 | before_log_stat_tblseq |              5007 | f                |            0 |              0
 myGroup2   | before_log_stat_tblseq |               5007 | f                 | tmp_mark               |              5009 | f                |            0 |              0
 myGroup2   | tmp_mark               |               5009 | f                 | RLBK_START             |              5010 | f                |            6 |              0
 myGroup2   | RLBK_START             |               5010 | f                 | RLBK_DONE              |              5011 | f                |        10006 |              1
 myGroup2   | RLBK_DONE              |               5011 | f                 | [current state]        |                   | f                |            0 |              1
(6 rows)

select stat_group, stat_first_mark, stat_first_time_id, stat_is_log_start, stat_last_mark, stat_last_time_id, stat_is_log_stop, stat_increments, stat_has_structure_changed, stat_rollbacks
    from emaj.emaj_log_stat_sequence('myschema2', 'myseq1', 'myGroup2', 'Mark23');
 stat_group |    stat_first_mark     | stat_first_time_id | stat_is_log_start |     stat_last_mark     | stat_last_time_id | stat_is_log_stop | stat_increments | stat_has_structure_changed | stat_rollbacks 
------------+------------------------+--------------------+-------------------+------------------------+-------------------+------------------+-----------------+----------------------------+----------------
 myGroup2   | Mark23                 |               5003 | f                 | Multi-3                |              5004 | f                |               0 | f                          |              0
 myGroup2   | Multi-3                |               5004 | f                 | before_log_stat_tblseq |              5007 | f                |               0 | t                          |              0
 myGroup2   | before_log_stat_tblseq |               5007 | f                 | tmp_mark               |              5009 | f                |               0 | f                          |              0
 myGroup2   | tmp_mark               |               5009 | f                 | RLBK_START             |              5010 | f                |               1 | f                          |              0
 myGroup2   | RLBK_START             |               5010 | f                 | RLBK_DONE              |              5011 | f                |              -4 | f                          |              1
 myGroup2   | RLBK_DONE              |               5011 | f                 | [current state]        |                   | f                |               0 | f                          |              1
(6 rows)

-- delete an intermediate mark (the mark and table/sequence state are deleted)
select emaj.emaj_delete_mark_group('myGroup2', 'tmp_mark');
 emaj_delete_mark_group 
------------------------
                      1
(1 row)

select stat_group, stat_first_mark, stat_first_time_id, stat_is_log_start, stat_last_mark, stat_last_time_id, stat_is_log_stop, stat_changes, stat_rollbacks
    from emaj.emaj_log_stat_table('myschema2', 'mytbl1', 'myGroup2', 'before_log_stat_tblseq', 'myGroup2', 'RLBK_START');
 stat_group |    stat_first_mark     | stat_first_time_id | stat_is_log_start | stat_last_mark | stat_last_time_id | stat_is_log_stop | stat_changes | stat_rollbacks 
------------+------------------------+--------------------+-------------------+----------------+-------------------+------------------+--------------+----------------
 myGroup2   | before_log_stat_tblseq |               5007 | f                 | RLBK_START     |              5010 | f                |            6 |              0
(1 row)

select stat_group, stat_first_mark, stat_first_time_id, stat_is_log_start, stat_last_mark, stat_last_time_id, stat_is_log_stop, stat_increments, stat_has_structure_changed, stat_rollbacks
    from emaj.emaj_log_stat_sequence('myschema2', 'myseq1', 'myGroup2', 'before_log_stat_tblseq', 'myGroup2', 'RLBK_START');
 stat_group |    stat_first_mark     | stat_first_time_id | stat_is_log_start | stat_last_mark | stat_last_time_id | stat_is_log_stop | stat_increments | stat_has_structure_changed | stat_rollbacks 
------------+------------------------+--------------------+-------------------+----------------+-------------------+------------------+-----------------+----------------------------+----------------
 myGroup2   | before_log_stat_tblseq |               5007 | f                 | RLBK_START     |              5010 | f                |               1 | f                          |              0
(1 row)

-- perform group stop and restart
begin transaction;
  select emaj.emaj_stop_group('myGroup2', 'stop');
 emaj_stop_group 
-----------------
              10
(1 row)

  select emaj.emaj_start_group('myGroup2', 'restart', false);
 emaj_start_group 
------------------
               10
(1 row)

  select stat_group, stat_first_mark, stat_first_time_id, stat_is_log_start, stat_last_mark, stat_last_time_id, stat_is_log_stop, stat_changes, stat_rollbacks
      from emaj.emaj_log_stat_table('myschema2', 'mytbl1', 'myGroup2', 'Multi-3');
 stat_group |    stat_first_mark     | stat_first_time_id | stat_is_log_start |     stat_last_mark     | stat_last_time_id | stat_is_log_stop | stat_changes | stat_rollbacks 
------------+------------------------+--------------------+-------------------+------------------------+-------------------+------------------+--------------+----------------
 myGroup2   | Multi-3                |               5004 | f                 | before_log_stat_tblseq |              5007 | f                |            0 |              0
 myGroup2   | before_log_stat_tblseq |               5007 | f                 | RLBK_START             |              5010 | f                |            6 |              0
 myGroup2   | RLBK_START             |               5010 | f                 | RLBK_DONE              |              5011 | f                |        10006 |              1
 myGroup2   | RLBK_DONE              |               5011 | f                 | stop                   |              5013 | t                |            0 |              1
 myGroup2   | restart                |               5014 | t                 | [current state]        |                   | f                |            0 |              0
(5 rows)

  select stat_group, stat_first_mark, stat_first_time_id, stat_is_log_start, stat_last_mark, stat_last_time_id, stat_is_log_stop, stat_increments, stat_has_structure_changed, stat_rollbacks
      from emaj.emaj_log_stat_sequence('myschema2', 'myseq1', 'myGroup2', 'Multi-3');
 stat_group |    stat_first_mark     | stat_first_time_id | stat_is_log_start |     stat_last_mark     | stat_last_time_id | stat_is_log_stop | stat_increments | stat_has_structure_changed | stat_rollbacks 
------------+------------------------+--------------------+-------------------+------------------------+-------------------+------------------+-----------------+----------------------------+----------------
 myGroup2   | Multi-3                |               5004 | f                 | before_log_stat_tblseq |              5007 | f                |               0 | t                          |              0
 myGroup2   | before_log_stat_tblseq |               5007 | f                 | RLBK_START             |              5010 | f                |               1 | f                          |              0
 myGroup2   | RLBK_START             |               5010 | f                 | RLBK_DONE              |              5011 | f                |              -4 | f                          |              1
 myGroup2   | RLBK_DONE              |               5011 | f                 | stop                   |              5013 | t                |               0 | f                          |              1
 myGroup2   | restart                |               5014 | t                 | [current state]        |                   | f                |               0 | f                          |              0
(5 rows)

-- delete oldest marks and marks at log session boundaries
  select emaj.emaj_set_mark_group('myGroup2', '1 after start');
 emaj_set_mark_group 
---------------------
                  10
(1 row)

  select emaj.emaj_delete_before_mark_group('myGroup2', 'before_log_stat_tblseq');
 emaj_delete_before_mark_group 
-------------------------------
                             6
(1 row)

  select emaj.emaj_delete_mark_group('myGroup2', 'stop');
 emaj_delete_mark_group 
------------------------
                      1
(1 row)

  select emaj.emaj_delete_mark_group('myGroup2', 'restart');
 emaj_delete_mark_group 
------------------------
                      1
(1 row)

  select stat_group, stat_first_mark, stat_first_time_id, stat_is_log_start, stat_last_mark, stat_last_time_id, stat_is_log_stop, stat_changes, stat_rollbacks
      from emaj.emaj_log_stat_table('myschema2', 'mytbl1');
 stat_group |    stat_first_mark     | stat_first_time_id | stat_is_log_start | stat_last_mark  | stat_last_time_id | stat_is_log_stop | stat_changes | stat_rollbacks 
------------+------------------------+--------------------+-------------------+-----------------+-------------------+------------------+--------------+----------------
 myGroup2   | before_log_stat_tblseq |               5007 | f                 | RLBK_START      |              5010 | f                |            6 |              0
 myGroup2   | RLBK_START             |               5010 | f                 | RLBK_DONE       |              5011 | f                |        10006 |              1
 myGroup2   | RLBK_DONE              |               5011 | f                 | [deleted mark]  |              5013 | t                |            0 |              1
 myGroup2   | [deleted mark]         |               5014 | t                 | 1 after start   |              5015 | f                |            0 |              0
 myGroup2   | 1 after start          |               5015 | f                 | [current state] |                   | f                |            0 |              0
(5 rows)

  select stat_group, stat_first_mark, stat_first_time_id, stat_is_log_start, stat_last_mark, stat_last_time_id, stat_is_log_stop, stat_increments, stat_has_structure_changed, stat_rollbacks
      from emaj.emaj_log_stat_sequence('myschema2', 'myseq1');
 stat_group |    stat_first_mark     | stat_first_time_id | stat_is_log_start | stat_last_mark  | stat_last_time_id | stat_is_log_stop | stat_increments | stat_has_structure_changed | stat_rollbacks 
------------+------------------------+--------------------+-------------------+-----------------+-------------------+------------------+-----------------+----------------------------+----------------
 myGroup2   | before_log_stat_tblseq |               5007 | f                 | RLBK_START      |              5010 | f                |               1 | f                          |              0
 myGroup2   | RLBK_START             |               5010 | f                 | RLBK_DONE       |              5011 | f                |              -4 | f                          |              1
 myGroup2   | RLBK_DONE              |               5011 | f                 | [deleted mark]  |              5013 | t                |               0 | f                          |              1
 myGroup2   | [deleted mark]         |               5014 | t                 | 1 after start   |              5015 | f                |               0 | f                          |              0
 myGroup2   | 1 after start          |               5015 | f                 | [current state] |                   | f                |               0 | f                          |              0
(5 rows)

rollback;
select * from emaj.emaj_rollback_group('myGroup2', 'before_log_stat_tblseq');
 rlbk_severity |              rlbk_message              
---------------+----------------------------------------
 Notice        | Rollback id = 5002.
 Notice        | 4 / 8 tables effectively processed.
 Notice        | 2 / 2 sequences effectively processed.
(3 rows)

select * from emaj.emaj_delete_mark_group('myGroup2', 'before_log_stat_tblseq');
 emaj_delete_mark_group 
------------------------
                      1
(1 row)

-----------------------------
-- _get_sequences_last_value() test
-----------------------------
-- get all groups, tables and sequences
select * from emaj._get_sequences_last_value(null, null, null, null, null, null)
  where p_key <> 'current_epoch' order by 1;
               p_key               | p_value 
-----------------------------------+---------
 emaj.emaj_global_seq              | 5022732
 emaj.emaj_time_stamp_time_id_seq  | 5016
 myschema1.myTbl3                  | 30
 myschema1.myTbl3_col31_seq        | 10
 myschema1.mytbl1                  | 64
 myschema1.mytbl2                  | 14
 myschema1.mytbl2b                 | 15
 myschema1.mytbl2b_col20_seq       | 2
 myschema1.mytbl4                  | 4
 myschema2.myTbl3                  | 20
 myschema2.myTbl3_col31_seq        | 10
 myschema2.myseq1                  | 1002
 myschema2.mytbl1                  | 20712
 myschema2.mytbl2                  | 1800
 myschema2.mytbl4                  | 200
 myschema2.mytbl5                  | 0
 myschema2.mytbl6                  | 0
 myschema2.mytbl7                  | 0
 myschema2.mytbl8                  | 0
 myschema4.mypartp1a               | 1
 myschema4.mypartp1b               | 3
 myschema4.mypartp2                | 8
 myschema4.mytblc1                 | 3
 myschema4.mytblc2                 | 3
 myschema4.mytblm                  | 3
 myschema4.mytblr1                 | 0
 myschema4.mytblr2                 | 2
 phil's schema"3.myTbl2\           | 0
 phil's schema"3.myTbl2\_col21_seq | 0
 phil's schema"3.phil's tbl1       | 0
 phil's schema"3.phil's"seq\1      | 999
(31 rows)

-- filter on groups
select p_key from emaj._get_sequences_last_value('Group', null, null, null, null, null) order by 1;
              p_key               
----------------------------------
 current_epoch
 emaj.emaj_global_seq
 emaj.emaj_time_stamp_time_id_seq
 myschema1.myTbl3
 myschema1.myTbl3_col31_seq
 myschema1.mytbl1
 myschema1.mytbl2
 myschema1.mytbl2b
 myschema1.mytbl2b_col20_seq
 myschema1.mytbl4
 myschema2.myTbl3
 myschema2.myTbl3_col31_seq
 myschema2.myseq1
 myschema2.mytbl1
 myschema2.mytbl2
 myschema2.mytbl4
 myschema2.mytbl5
 myschema2.mytbl6
 myschema2.mytbl7
 myschema2.mytbl8
 myschema4.mypartp1a
 myschema4.mypartp1b
 myschema4.mypartp2
 myschema4.mytblc1
 myschema4.mytblc2
 myschema4.mytblm
 myschema4.mytblr1
 myschema4.mytblr2
(28 rows)

select p_key from emaj._get_sequences_last_value(null, 'Group', null, null, null, null) order by 1;
               p_key               
-----------------------------------
 current_epoch
 emaj.emaj_global_seq
 emaj.emaj_time_stamp_time_id_seq
 phil's schema"3.myTbl2\
 phil's schema"3.myTbl2\_col21_seq
 phil's schema"3.phil's tbl1
 phil's schema"3.phil's"seq\1
(7 rows)

-- filter on tables and sequences
select p_key from emaj._get_sequences_last_value(null, null, 'tbl2|tbl4', '2b', 'col', 'myschema2') order by 1;
               p_key               
-----------------------------------
 current_epoch
 emaj.emaj_global_seq
 emaj.emaj_time_stamp_time_id_seq
 myschema1.myTbl3_col31_seq
 myschema1.mytbl2
 myschema1.mytbl2b_col20_seq
 myschema1.mytbl4
 myschema2.mytbl2
 myschema2.mytbl4
 phil's schema"3.myTbl2\_col21_seq
(10 rows)

-- check for statistics functions family
select hist_id, hist_function, hist_event, hist_object, 
       regexp_replace(regexp_replace(hist_wording,E'\\d\\d\.\\d\\d\\.\\d\\d\\.\\d\\d\\d\\d','%','g'),E'\\[.+\\]','(timestamp)','g'), hist_user
  from (select * from emaj.emaj_hist where hist_id >= 5000 order by hist_id) as t;
 hist_id |   hist_function   |   hist_event   |         hist_object          |                                          regexp_replace                                          | hist_user 
---------+-------------------+----------------+------------------------------+--------------------------------------------------------------------------------------------------+-----------
    5000 | SET_MARK_GROUPS   | BEGIN          | myGroup1,myGroup2            | Multi-1                                                                                          | postgres
    5001 | LOCK_GROUPS       | BEGIN          | myGroup1,myGroup2            |                                                                                                  | postgres
    5002 | LOCK_GROUPS       | END            | myGroup1,myGroup2            | 13 tables locked, 0 deadlock(s)                                                                  | postgres
    5003 | SET_MARK_GROUPS   | TIME STAMP SET | 5000                         |                                                                                                  | postgres
    5004 | SET_MARK_GROUPS   | END            | myGroup1,myGroup2            | Multi-1                                                                                          | postgres
    5005 | SET_MARK_GROUP    | BEGIN          | myGroup2                     |                                                                                                  | postgres
    5006 | LOCK_GROUP        | BEGIN          | myGroup2                     |                                                                                                  | postgres
    5007 | LOCK_GROUP        | END            | myGroup2                     | 8 tables locked, 0 deadlock(s)                                                                   | postgres
    5008 | SET_MARK_GROUP    | TIME STAMP SET | 5001                         |                                                                                                  | postgres
    5009 | SET_MARK_GROUP    | END            | myGroup2                     | Mark22                                                                                           | postgres
    5010 | SET_MARK_GROUPS   | BEGIN          | myGroup1,myGroup2            | Multi-2                                                                                          | postgres
    5011 | LOCK_GROUPS       | BEGIN          | myGroup1,myGroup2            |                                                                                                  | postgres
    5012 | LOCK_GROUPS       | END            | myGroup1,myGroup2            | 13 tables locked, 0 deadlock(s)                                                                  | postgres
    5013 | SET_MARK_GROUPS   | TIME STAMP SET | 5002                         |                                                                                                  | postgres
    5014 | SET_MARK_GROUPS   | END            | myGroup1,myGroup2            | Multi-2                                                                                          | postgres
    5015 | SET_MARK_GROUP    | BEGIN          | myGroup2                     |                                                                                                  | postgres
    5016 | LOCK_GROUP        | BEGIN          | myGroup2                     |                                                                                                  | postgres
    5017 | LOCK_GROUP        | END            | myGroup2                     | 8 tables locked, 0 deadlock(s)                                                                   | postgres
    5018 | SET_MARK_GROUP    | TIME STAMP SET | 5003                         |                                                                                                  | postgres
    5019 | SET_MARK_GROUP    | END            | myGroup2                     | Mark23                                                                                           | postgres
    5020 | SET_MARK_GROUPS   | BEGIN          | myGroup1,myGroup2            | Multi-3                                                                                          | postgres
    5021 | LOCK_GROUPS       | BEGIN          | myGroup1,myGroup2            |                                                                                                  | postgres
    5022 | LOCK_GROUPS       | END            | myGroup1,myGroup2            | 13 tables locked, 0 deadlock(s)                                                                  | postgres
    5023 | SET_MARK_GROUPS   | TIME STAMP SET | 5004                         |                                                                                                  | postgres
    5024 | SET_MARK_GROUPS   | END            | myGroup1,myGroup2            | Multi-3                                                                                          | postgres
    5025 | STOP_GROUP        | BEGIN          | myGroup4                     |                                                                                                  | postgres
    5026 | STOP_GROUP        | TIME STAMP SET | 5005                         |                                                                                                  | postgres
    5027 | LOCK_GROUP        | BEGIN          | myGroup4                     |                                                                                                  | postgres
    5028 | LOCK_GROUP        | END            | myGroup4                     | 8 tables locked, 0 deadlock(s)                                                                   | postgres
    5029 | SET_MARK_GROUP    | BEGIN          | myGroup4                     | myGroup4_stop                                                                                    | postgres
    5030 | SET_MARK_GROUP    | END            | myGroup4                     | myGroup4_stop                                                                                    | postgres
    5031 | STOP_GROUP        | END            | myGroup4                     | 8 tables/sequences processed                                                                     | postgres
    5032 | START_GROUP       | BEGIN          | myGroup4                     | Without log reset                                                                                | postgres
    5033 | START_GROUP       | TIME STAMP SET | 5006                         |                                                                                                  | postgres
    5034 | LOCK_GROUP        | BEGIN          | myGroup4                     |                                                                                                  | postgres
    5035 | LOCK_GROUP        | END            | myGroup4                     | 8 tables locked, 0 deadlock(s)                                                                   | postgres
    5036 | SET_MARK_GROUP    | BEGIN          | myGroup4                     | myGroup4_restart                                                                                 | postgres
    5037 | SET_MARK_GROUP    | END            | myGroup4                     | myGroup4_restart                                                                                 | postgres
    5038 | START_GROUP       | END            | myGroup4                     | 8 tables/sequences processed                                                                     | postgres
    5039 | SET_MARK_GROUP    | BEGIN          | myGroup2                     |                                                                                                  | postgres
    5040 | LOCK_GROUP        | BEGIN          | myGroup2                     |                                                                                                  | postgres
    5041 | LOCK_GROUP        | END            | myGroup2                     | 8 tables locked, 0 deadlock(s)                                                                   | postgres
    5042 | SET_MARK_GROUP    | TIME STAMP SET | 5007                         |                                                                                                  | postgres
    5043 | SET_MARK_GROUP    | END            | myGroup2                     | before_log_stat_tblseq                                                                           | postgres
    5044 | SET_MARK_GROUP    | BEGIN          | emptyGroup                   |                                                                                                  | postgres
    5045 | LOCK_GROUP        | BEGIN          | emptyGroup                   |                                                                                                  | postgres
    5046 | LOCK_GROUP        | END            | emptyGroup                   | 0 tables locked, 0 deadlock(s)                                                                   | postgres
    5047 | SET_MARK_GROUP    | TIME STAMP SET | 5008                         |                                                                                                  | postgres
    5048 | SET_MARK_GROUP    | END            | emptyGroup                   | log_stat_1                                                                                       | postgres
    5049 | SET_MARK_GROUP    | BEGIN          | myGroup2                     |                                                                                                  | postgres
    5050 | LOCK_GROUP        | BEGIN          | myGroup2                     |                                                                                                  | postgres
    5051 | LOCK_GROUP        | END            | myGroup2                     | 8 tables locked, 0 deadlock(s)                                                                   | postgres
    5052 | SET_MARK_GROUP    | TIME STAMP SET | 5009                         |                                                                                                  | postgres
    5053 | SET_MARK_GROUP    | END            | myGroup2                     | tmp_mark                                                                                         | postgres
    5054 | ROLLBACK_GROUP    | BEGIN          | myGroup2                     | Logged rollback to mark Multi-1 (timestamp)                                                      | postgres
    5055 | DBLINK_OPEN_CNX   |                | rlbk#1                       | Status = 1                                                                                       | postgres
    5056 | LOCK_GROUP        | BEGIN          | myGroup2                     | Rollback session #1                                                                              | postgres
    5057 | LOCK_GROUP        | END            | myGroup2                     | Rollback session #1: 8 tables locked, 0 deadlock(s)                                              | postgres
    5058 | ROLLBACK_GROUP    | TIME STAMP SET | 5010                         |                                                                                                  | postgres
    5059 | SET_MARK_GROUP    | BEGIN          | myGroup2                     | RLBK_5000_START                                                                                  | postgres
    5060 | SET_MARK_GROUP    | END            | myGroup2                     | RLBK_5000_START                                                                                  | postgres
    5061 | ROLLBACK_SEQUENCE |                | myschema2."myTbl3_col31_seq" | RESTART 1                                                                                        | postgres
    5062 | ROLLBACK_SEQUENCE |                | myschema2.myseq1             | RESTART 1000                                                                                     | postgres
    5063 | ROLLBACK_TABLE    | BEGIN          | myschema2.mytbl1             | All log rows where emaj_gid > 5000000 and <= 5011716, in session_replication_role = replica mode | postgres
    5064 | ROLLBACK_TABLE    | END            | myschema2.mytbl1             | 10106 rolled back primary keys                                                                   | postgres
    5065 | ROLLBACK_TABLE    | BEGIN          | myschema2.mytbl2             | All log rows where emaj_gid > 5000000 and <= 5011716, in session_replication_role = replica mode | postgres
    5066 | ROLLBACK_TABLE    | END            | myschema2.mytbl2             | 900 rolled back primary keys                                                                     | postgres
    5067 | ROLLBACK_TABLE    | BEGIN          | myschema2.mytbl4             | All log rows where emaj_gid > 5000000 and <= 5011716, in session_replication_role = replica mode | postgres
    5068 | ROLLBACK_TABLE    | END            | myschema2.mytbl4             | 100 rolled back primary keys                                                                     | postgres
    5069 | ROLLBACK_TABLE    | BEGIN          | myschema2."myTbl3"           | All log rows where emaj_gid > 5000000 and <= 5011716                                             | postgres
    5070 | ROLLBACK_TABLE    | END            | myschema2."myTbl3"           | 10 rolled back primary keys                                                                      | postgres
    5071 | ROLLBACK_GROUP    | TIME STAMP SET | 5011                         |                                                                                                  | postgres
    5072 | SET_MARK_GROUP    | BEGIN          | myGroup2                     | RLBK_5000_DONE                                                                                   | postgres
    5073 | SET_MARK_GROUP    | END            | myGroup2                     | RLBK_5000_DONE                                                                                   | postgres
    5074 | ROLLBACK_GROUP    | NOTICE         | Rollback id 5000             | Rollback id = 5000.                                                                              | postgres
    5075 | ROLLBACK_GROUP    | NOTICE         | Rollback id 5000             | 4 / 8 tables effectively processed.                                                              | postgres
    5076 | ROLLBACK_GROUP    | NOTICE         | Rollback id 5000             | 2 / 2 sequences effectively processed.                                                           | postgres
    5077 | DBLINK_CLOSE_CNX  |                | rlbk#1                       |                                                                                                  | postgres
    5078 | ROLLBACK_GROUP    | END            | myGroup2                     | Rollback_id 5000                                                                                 | postgres
    5079 | RENAME_MARK_GROUP | BEGIN          | myGroup2                     | RLBK_5000_START                                                                                  | postgres
    5080 | RENAME_MARK_GROUP | END            | myGroup2                     | RLBK_5000_START renamed RLBK_START                                                               | postgres
    5081 | RENAME_MARK_GROUP | BEGIN          | myGroup2                     | EMAJ_LAST_MARK                                                                                   | postgres
    5082 | RENAME_MARK_GROUP | END            | myGroup2                     | RLBK_5000_DONE renamed RLBK_DONE                                                                 | postgres
    5085 | ROLLBACK_GROUP    | BEGIN          | myGroup2                     | Unlogged rollback to mark RLBK_DONE (timestamp)                                                  | postgres
    5086 | DBLINK_OPEN_CNX   |                | rlbk#1                       | Status = 1                                                                                       | postgres
    5087 | LOCK_GROUP        | BEGIN          | myGroup2                     | Rollback session #1                                                                              | postgres
    5088 | LOCK_GROUP        | END            | myGroup2                     | Rollback session #1: 8 tables locked, 0 deadlock(s)                                              | postgres
    5089 | ROLLBACK_GROUP    | TIME STAMP SET | 5012                         |                                                                                                  | postgres
    5090 | ROLLBACK_GROUP    | NOTICE         | Rollback id 5001             | Rollback id = 5001.                                                                              | postgres
    5091 | ROLLBACK_GROUP    | NOTICE         | Rollback id 5001             | 0 / 8 tables effectively processed.                                                              | postgres
    5092 | ROLLBACK_GROUP    | NOTICE         | Rollback id 5001             | 0 / 2 sequences effectively processed.                                                           | postgres
    5093 | DBLINK_CLOSE_CNX  |                | rlbk#1                       |                                                                                                  | postgres
    5094 | ROLLBACK_GROUP    | END            | myGroup2                     | Rollback_id 5001                                                                                 | postgres
    5095 | DELETE_MARK_GROUP | BEGIN          | myGroup2                     | tmp_mark                                                                                         | postgres
    5096 | DELETE_MARK_GROUP | END            | myGroup2                     | tmp_mark                                                                                         | postgres
    5124 | ROLLBACK_GROUP    | BEGIN          | myGroup2                     | Unlogged rollback to mark before_log_stat_tblseq (timestamp)                                     | postgres
    5125 | DBLINK_OPEN_CNX   |                | rlbk#1                       | Status = 1                                                                                       | postgres
    5126 | LOCK_GROUP        | BEGIN          | myGroup2                     | Rollback session #1                                                                              | postgres
    5127 | LOCK_GROUP        | END            | myGroup2                     | Rollback session #1: 8 tables locked, 0 deadlock(s)                                              | postgres
    5128 | ROLLBACK_GROUP    | TIME STAMP SET | 5016                         |                                                                                                  | postgres
    5129 | ROLLBACK_SEQUENCE |                | myschema2."myTbl3_col31_seq" | RESTART 11                                                                                       | postgres
    5130 | ROLLBACK_SEQUENCE |                | myschema2.myseq1             | RESTART 1003                                                                                     | postgres
    5131 | ROLLBACK_TABLE    | BEGIN          | myschema2.mytbl1             | All log rows where emaj_gid > 5011710 and <= 5022732, in session_replication_role = replica mode | postgres
    5132 | ROLLBACK_TABLE    | END            | myschema2.mytbl1             | 10006 rolled back primary keys                                                                   | postgres
    5133 | ROLLBACK_TABLE    | BEGIN          | myschema2.mytbl2             | All log rows where emaj_gid > 5011710 and <= 5022732, in session_replication_role = replica mode | postgres
    5134 | ROLLBACK_TABLE    | END            | myschema2.mytbl2             | 900 rolled back primary keys                                                                     | postgres
    5135 | ROLLBACK_TABLE    | BEGIN          | myschema2.mytbl4             | All log rows where emaj_gid > 5011710 and <= 5022732, in session_replication_role = replica mode | postgres
    5136 | ROLLBACK_TABLE    | END            | myschema2.mytbl4             | 100 rolled back primary keys                                                                     | postgres
    5137 | ROLLBACK_TABLE    | BEGIN          | myschema2."myTbl3"           | All log rows where emaj_gid > 5011710 and <= 5022732                                             | postgres
    5138 | ROLLBACK_TABLE    | END            | myschema2."myTbl3"           | 10 rolled back primary keys                                                                      | postgres
    5139 | ROLLBACK_GROUP    | MARK DELETED   | myGroup2                     | mark RLBK_START is deleted                                                                       | postgres
    5140 | ROLLBACK_GROUP    | MARK DELETED   | myGroup2                     | mark RLBK_DONE is deleted                                                                        | postgres
    5141 | ROLLBACK_GROUP    | NOTICE         | Rollback id 5002             | Rollback id = 5002.                                                                              | postgres
    5142 | ROLLBACK_GROUP    | NOTICE         | Rollback id 5002             | 4 / 8 tables effectively processed.                                                              | postgres
    5143 | ROLLBACK_GROUP    | NOTICE         | Rollback id 5002             | 2 / 2 sequences effectively processed.                                                           | postgres
    5144 | DBLINK_CLOSE_CNX  |                | rlbk#1                       |                                                                                                  | postgres
    5145 | ROLLBACK_GROUP    | END            | myGroup2                     | Rollback_id 5002                                                                                 | postgres
    5146 | DELETE_MARK_GROUP | BEGIN          | myGroup2                     | before_log_stat_tblseq                                                                           | postgres
    5147 | DELETE_MARK_GROUP | END            | myGroup2                     | before_log_stat_tblseq                                                                           | postgres
(119 rows)

